<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Performance Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&family=IBM+Plex+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        :root {
            /* Color Palette - White Background with Red/Blue/Orange/Teal */
            --bg-primary: #ffffff;
            --bg-secondary: #f8f9fa;
            --bg-tertiary: #f0f2f5;
            --bg-card: #ffffff;
            
            /* Primary Brand Colors */
            --primary-red: #FF3008;
            --primary-red-dark: #EB1700;
            
            /* Secondary Colors */
            --secondary-blue: rgb(0, 155, 213);      /* #009BD5 */
            --secondary-orange: rgb(248, 106, 52);   /* #F86A34 */
            --secondary-teal: rgb(0, 131, 138);      /* #00838A */
            
            /* Text Colors */
            --text-primary: #191919;
            --text-secondary: #4a5568;
            --text-muted: #718096;
            
            /* Border Colors */
            --border-color: #e2e8f0;
            --border-accent: #cbd5e0;
            
            /* Gradient accents */
            --gradient-red: linear-gradient(135deg, #FF3008, #EB1700);
            --gradient-multi: linear-gradient(135deg, #FF3008, rgb(0, 155, 213), rgb(0, 131, 138));
            --gradient-warm: linear-gradient(135deg, #FF3008, rgb(248, 106, 52));
            
            /* Typography */
            --font-mono: 'JetBrains Mono', monospace;
            --font-sans: 'IBM Plex Sans', system-ui, sans-serif;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: var(--bg-primary);
            background-image: linear-gradient(to bottom right, #ffffff, #f8f9fa);
            color: var(--text-primary);
            font-family: var(--font-sans);
            line-height: 1.6;
            overflow-x: hidden;
        }
        
        /* Animated Background Grid */
        .background-grid {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(90deg, var(--border-color) 1px, transparent 1px),
                linear-gradient(var(--border-color) 1px, transparent 1px);
            background-size: 50px 50px;
            opacity: 0.5;
            z-index: 0;
            pointer-events: none;
        }
        
        .container {
            position: relative;
            z-index: 1;
            max-width: 1600px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        /* Header */
        header {
            margin-bottom: 3rem;
            padding-bottom: 2rem;
            border-bottom: 2px solid var(--border-color);
        }
        
        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            letter-spacing: -0.02em;
            background: var(--gradient-multi);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 2rem;
        }
        
        /* Key Metrics Grid */
        .key-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .key-metric {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            position: relative;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }
        
        .key-metric::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: var(--gradient-warm);
        }
        
        .key-metric-label {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--text-muted);
            font-family: var(--font-mono);
            margin-bottom: 0.5rem;
        }
        
        .key-metric-value {
            font-size: 2rem;
            font-weight: 700;
            font-family: var(--font-mono);
            color: var(--primary-red);
        }
        
        /* Charts Section */
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }
        
        .chart-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            transition: all 0.3s ease;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }
        
        .chart-card:hover {
            border-color: var(--secondary-blue);
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1), 0 4px 8px rgba(0, 155, 213, 0.15);
        }
        
        .chart-title {
            font-size: 1rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        .chart-container {
            position: relative;
            height: 300px;
        }
        
        /* Region Filter */
        .filter-section {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem 1.5rem;
            background: var(--bg-secondary);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--border-accent);
            border-radius: 8px;
        }
        
        .filter-label {
            font-size: 0.875rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-secondary);
        }
        
        select {
            background: var(--bg-card);
            color: var(--text-primary);
            border: 2px solid var(--border-color);
            padding: 0.75rem 1rem;
            border-radius: 6px;
            font-family: var(--font-sans);
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s;
            min-width: 200px;
        }
        
        select:hover {
            border-color: var(--accent-white);
            background: var(--bg-card);
        }
        
        select:focus {
            outline: none;
            border-color: var(--primary-red);
            box-shadow: 0 0 0 3px rgba(255, 48, 8, 0.1);
        }
        
        .filter-status {
            font-size: 0.875rem;
            color: var(--text-muted);
            font-family: var(--font-mono);
            margin-left: auto;
        }
        
        /* Grid Layout */
        .dashboard-grid {
            display: grid;
            gap: 2rem;
            margin-bottom: 2rem;
        }
        
        /* Card Styles */
        .card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }
        
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: var(--gradient-red);
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .card:hover {
            border-color: var(--border-accent);
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
        }
        
        .card:hover::before {
            opacity: 1;
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        .card-title {
            font-size: 1rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-secondary);
        }
        
        .card-badge {
            font-size: 0.75rem;
            font-family: var(--font-mono);
            padding: 0.25rem 0.75rem;
            border-radius: 4px;
            background: var(--bg-tertiary);
            color: var(--accent-red);
            border: 1px solid var(--border-accent);
        }
        
        /* Metric Display */
        .metric-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
        }
        
        .metric {
            padding: 1rem;
            background: var(--bg-secondary);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }
        
        .metric-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.5rem;
        }
        
        .metric-value {
            font-size: 1.75rem;
            font-weight: 700;
            font-family: var(--font-mono);
            color: var(--primary-red);
        }
        
        .metric-diff {
            font-size: 0.875rem;
            font-family: var(--font-mono);
            margin-top: 0.25rem;
        }
        
        .metric-diff.positive {
            color: var(--accent-white);
        }
        
        .metric-diff.negative {
            color: var(--accent-red-bright);
        }
        
        /* Table Styles */
        .table-container {
            overflow-x: auto;
            max-height: 500px;
            overflow-y: auto;
            margin-top: 1rem;
            border: 1px solid var(--border-color);
            border-radius: 8px;
        }
        
        .table-container::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        .table-container::-webkit-scrollbar-track {
            background: var(--bg-secondary);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }
        
        .table-container::-webkit-scrollbar-thumb {
            background: var(--secondary-blue);
            border-radius: 4px;
        }
        
        .table-container::-webkit-scrollbar-thumb:hover {
            background: var(--primary-red);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }
        
        thead {
            background: var(--bg-secondary);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }
        
        th {
            text-align: left;
            padding: 0.75rem 1rem;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            font-size: 0.75rem;
            letter-spacing: 0.05em;
            border-bottom: 2px solid var(--border-accent);
        }
        
        td {
            padding: 0.75rem 1rem;
            border-bottom: 1px solid var(--border-color);
            font-family: var(--font-mono);
            font-size: 0.875rem;
        }
        
        tr:hover td {
            background: var(--bg-secondary);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }
        
        /* Progress Bars */
        .progress-bar {
            height: 6px;
            background: var(--bg-tertiary);
            border-radius: 3px;
            overflow: hidden;
            margin-top: 0.5rem;
        }
        
        .progress-fill {
            height: 100%;
            background: var(--gradient-red);
            transition: width 0.3s ease;
        }
        
        /* Flags and Warnings */
        .flag-item {
            padding: 1rem;
            background: var(--bg-secondary);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            border-left: 3px solid var(--accent-red-bright);
            border-radius: 6px;
            margin-bottom: 0.75rem;
        }
        
        .flag-item.error {
            border-left-color: var(--accent-red-bright);
        }
        
        .flag-item.warning {
            border-left-color: var(--accent-red-bright);
        }
        
        .flag-item.info {
            border-left-color: var(--accent-red-bright);
        }
        
        .flag-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
            color: var(--text-primary);
        }
        
        .flag-value {
            font-family: var(--font-mono);
            font-size: 0.875rem;
            color: var(--text-secondary);
        }
        
        /* Section Dividers */
        .section-divider {
            margin: 3rem 0 2rem;
            text-align: left;
        }
        
        .section-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }
        
        .section-subtitle {
            font-size: 0.875rem;
            color: var(--text-muted);
        }
        

        
        th.sortable {
            cursor: pointer;
            user-select: none;
            position: relative;
            padding-right: 1.5rem;
        }
        
        th.sortable:hover {
            color: var(--primary-red);
        }
        
        th.sortable::after {
            content: '⇅';
            position: absolute;
            right: 0.5rem;
            opacity: 0.3;
            font-size: 0.875rem;
        }
        
        th.sortable.asc::after {
            content: '↑';
            opacity: 1;
            color: var(--secondary-teal);
        }
        
        th.sortable.desc::after {
            content: '↓';
            opacity: 1;
            color: var(--accent-red);
        }
        
        
        /* Three-fold metrics layout */
        .metrics-three-col {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 2rem;
            margin-bottom: 2rem;
        }
        
        @media (max-width: 1200px) {
            .metrics-three-col {
                grid-template-columns: 1fr;
            }
        }
        
        /* Pie chart container */
        .pie-chart-container {
            position: relative;
            height: 350px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
                /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }
            
            h1 {
                font-size: 1.75rem;
            }
            
            .key-metrics {
                grid-template-columns: 1fr;
            }
            
            .charts-grid {
                grid-template-columns: 1fr;
            }
            
            .metric-grid {
                grid-template-columns: 1fr;
            }
        }
    
        
        /* Enhanced visual effects */
        .key-metric {
            transition: all 0.3s ease;
        }
        
        .key-metric:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 48, 8, 0.15), 0 2px 6px rgba(0, 155, 213, 0.1);
        }
        
        .chart-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: var(--gradient-red);
            opacity: 0.5;
        }
        
        /* Progress bar enhancement */
        .progress-fill {
            background: var(--gradient-warm);
        }
        
        /* Glow effect on hover for cards */
        .card:hover {
            box-shadow: 0 8px 24px rgba(255, 48, 8, 0.15), 0 4px 8px rgba(0, 155, 213, 0.1);
        }
    
        
        .region-link:hover {
            text-decoration: underline !important;
            color: var(--primary-red-dark) !important;
        }
    </style>
</head>
<body>
    <div class="background-grid"></div>
    
    <div class="container">
        <!-- Header -->
        <header>
            <h1>Performance Dashboard</h1>
            <p style="color: var(--text-muted); font-size: 0.875rem; margin-top: -1rem; margin-bottom: 1.5rem; font-family: var(--font-mono);">
                Time Period: September 1, 2024 - October 1, 2024
            </p>
            
            <!-- Key Metrics -->
            <div class="key-metrics">
                <div class="key-metric">
                    <div class="key-metric-label">Total GMV</div>
                    <div class="key-metric-value" id="header-gmv">$0</div>
                </div>
                <div class="key-metric">
                    <div class="key-metric-label">Total Orders</div>
                    <div class="key-metric-value" id="header-orders">0</div>
                </div>
                <div class="key-metric">
                    <div class="key-metric-label">Average Order Value</div>
                    <div class="key-metric-value" id="header-aov">$0</div>
                </div>
            </div>
            
            <!-- Charts -->
            <div class="charts-grid">
                <div class="chart-card">
                    <h3 class="chart-title">Orders by Weekday</h3>
                    <div class="chart-container">
                        <canvas id="weekdayChart"></canvas>
                    </div>
                </div>
                <div class="chart-card">
                    <h3 class="chart-title">Orders by Hour of Day</h3>
                    <div class="chart-container">
                        <canvas id="hourlyChart"></canvas>
                    </div>
                </div>
            </div>
            

        </header>
        
                <!-- Regions Overview Section -->
        <section>
            <div class="section-divider">
                <h2 class="section-title">Regions Overview</h2>
                <p class="section-subtitle">All 50 regions - Top 10 highlighted in blue - Click region names to filter or sort by columns</p>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">All Regions (Top 10 Highlighted)</h3>
                    <span class="card-badge">GLOBAL</span>
                </div>
                <div class="table-container">
                    <table id="top-regions-table">
                        <thead>
                            <tr>
                                <th>Rank</th>
                                <th class="sortable" data-column="region">Region</th>
                                <th class="sortable" data-column="gmv">GMV</th>
                                <th class="sortable" data-column="orders">Orders</th>
                                <th class="sortable" data-column="delivery">Avg Delivery</th>
                                <th class="sortable" data-column="retention">Retention</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </section>
        
                <!-- Market Performance Section -->
        <section>
            <div class="section-divider">
                <h2 class="section-title">Market Performance</h2>
                <p class="section-subtitle">Select a region to view detailed metrics</p>
            </div>
            
            <!-- Filter Section -->
            <div class="filter-section">
                <span class="filter-label">Filter by Region:</span>
                <select id="region-filter">
                    <option value="all">All Markets (Total)</option>
                </select>
                <span class="filter-status" id="filter-status">Showing: Total Market</span>
            </div>
        </section>
        
        <!-- Performance Metrics Section -->
        <section>
            <div class="section-divider">
                <h2 class="section-title">Performance Metrics</h2>
                <p class="section-subtitle">Revenue, operational, and satisfaction metrics</p>
            </div>
            
            <div class="metrics-three-col">
                <!-- Column 1: Revenue Performance -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Revenue Performance</h3>
                    </div>
                    <div class="metric-grid">
                        <div class="metric">
                            <div class="metric-label">Total GMV</div>
                            <div class="metric-value" id="revenue-gmv">-</div>
                        </div>
                        <div class="metric">
                            <div class="metric-label">AOV</div>
                            <div class="metric-value" id="aov">-</div>
                        </div>
                        <div class="metric">
                            <div class="metric-label">Avg Tip %</div>
                            <div class="metric-value" id="avg-tip">-</div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 2rem;">
                        <div class="card-header" style="margin-bottom: 1rem; padding-bottom: 0.5rem;">
                            <h3 class="card-title" style="font-size: 0.875rem;">Order Size Distribution</h3>
                        </div>
                        <div class="pie-chart-container">
                            <canvas id="orderSizePieChart"></canvas>
                        </div>
                    </div>
                </div>
                
                <!-- Column 2: Operational Metrics -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Operational Performance</h3>
                    </div>
                    
                    <!-- Total Fulfillment Time (Full Width) -->
                    <div class="metric" style="margin-bottom: 1.5rem;">
                        <div class="metric-label">Total Fulfillment Time</div>
                        <div class="metric-value" id="total-fulfillment">-</div>
                        <div class="metric-diff" id="total-fulfillment-diff"></div>
                    </div>
                    
                    <!-- Prep Time and Delivery Time (Side by Side) -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem;">
                        <div class="metric">
                            <div class="metric-label">Restaurant Prep Time</div>
                            <div class="metric-value" id="prep-time">-</div>
                        </div>
                        <div class="metric">
                            <div class="metric-label">Delivery Time</div>
                            <div class="metric-value" id="delivery-time">-</div>
                        </div>
                    </div>
                    
                    <!-- Driver/Order Ratio -->
                    <div class="metric" style="margin-bottom: 1.5rem;">
                        <div class="metric-label">Driver/Order Ratio</div>
                        <div class="metric-value" id="driver-ratio">-</div>
                    </div>
                    
                    <!-- Speed Categories -->
                    <div style="margin-top: 1.5rem;">
                        <div style="margin-bottom: 1rem;">
                            <div class="metric-label">Speed Categories</div>
                        </div>
                        <div class="metric" style="margin-bottom: 0.75rem;">
                            <div class="metric-label">Fast (<20min)</div>
                            <div class="metric-value" id="fast-pct" style="font-size: 1.25rem;">-</div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="fast-bar"></div>
                            </div>
                        </div>
                        <div class="metric" style="margin-bottom: 0.75rem;">
                            <div class="metric-label">Normal (20-35min)</div>
                            <div class="metric-value" id="normal-pct" style="font-size: 1.25rem;">-</div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="normal-bar"></div>
                            </div>
                        </div>
                        <div class="metric">
                            <div class="metric-label">Slow (>35min)</div>
                            <div class="metric-value" id="slow-pct" style="font-size: 1.25rem;">-</div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="slow-bar"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Column 3: Satisfaction & Quality -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Satisfaction & Quality</h3>
                    </div>
                    <div class="metric-grid" style="grid-template-columns: 1fr;">
                        <div class="metric">
                            <div class="metric-label">Refund Rate</div>
                            <div class="metric-value" id="refund-rate">-</div>
                        </div>
                        <div class="metric">
                            <div class="metric-label">Incomplete Rate</div>
                            <div class="metric-value" id="incomplete-rate">-</div>
                        </div>
                        <div class="metric">
                            <div class="metric-label">Lunch Rush Failure</div>
                            <div class="metric-value" id="lunch-failure">-</div>
                        </div>
                        <div class="metric">
                            <div class="metric-label">Dinner Rush Failure</div>
                            <div class="metric-value" id="dinner-failure">-</div>
                        </div>
                        <div class="metric">
                            <div class="metric-label">Peak Refund Hour</div>
                            <div class="metric-value" id="refund-hour">-</div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 1.5rem;">
                        <div style="margin-bottom: 1rem;">
                            <div class="metric-label">Problem Spots</div>
                        </div>
                        <div id="problem-spots">
                            <!-- Dynamically populated -->
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Flags and Errors Section -->
        <section>
            <div class="section-divider">
                <h2 class="section-title">Flags & Errors</h2>
                <p class="section-subtitle">Data quality and operational anomalies</p>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Data Quality Issues</h3>
                </div>
                <div id="flags-container">
                    <!-- Dynamically populated -->
                </div>
            </div>
        </section>
    </div>
    
    <script>
        // Dashboard data will be embedded here
        
        // Embedded dashboard data
        const dashboardData = {
        "market_performance": {
                "total_gmv": 703095.9100000001,
                "peak_day": "Sunday",
                "peak_day_count": 3256,
                "peak_hour": 18,
                "peak_hour_count": 1944,
                "top_10_regions": [
                        {
                                "rank": 1,
                                "region": "San Francisco",
                                "gmv": 112394.18,
                                "gmv_pct": 15.985611408264338,
                                "orders": 3077,
                                "order_pct": 15.530207439559884,
                                "avg_delivery_time": 29.623246941995866,
                                "retention": 22.611905860636824
                        },
                        {
                                "rank": 2,
                                "region": "Scranton",
                                "gmv": 91475.11,
                                "gmv_pct": 13.010331691447327,
                                "orders": 3220,
                                "order_pct": 16.251955786604753,
                                "avg_delivery_time": 23.712076835710512,
                                "retention": 38.80597014925373
                        },
                        {
                                "rank": 3,
                                "region": "Orange County",
                                "gmv": 48432.71000000001,
                                "gmv_pct": 6.888492638223425,
                                "orders": 1263,
                                "order_pct": 6.374602533690002,
                                "avg_delivery_time": 22.477412945113787,
                                "retention": 22.488584474885844
                        },
                        {
                                "rank": 4,
                                "region": "Dallas",
                                "gmv": 37136.17,
                                "gmv_pct": 5.281807143494832,
                                "orders": 794,
                                "order_pct": 4.007469843032353,
                                "avg_delivery_time": 41.16809782512206,
                                "retention": 18.93687707641196
                        },
                        {
                                "rank": 5,
                                "region": "San Antonio",
                                "gmv": 32234.619999999995,
                                "gmv_pct": 4.584668967851056,
                                "orders": 774,
                                "order_pct": 3.9065260182708323,
                                "avg_delivery_time": 44.46100036892361,
                                "retention": 17.647058823529413
                        },
                        {
                                "rank": 6,
                                "region": "Traverse City, MI",
                                "gmv": 32196.730000000003,
                                "gmv_pct": 4.579279944894004,
                                "orders": 643,
                                "order_pct": 3.2453439660828747,
                                "avg_delivery_time": 37.02179194139194,
                                "retention": 20.168067226890756
                        },
                        {
                                "rank": 7,
                                "region": "Bellevue",
                                "gmv": 29737.83,
                                "gmv_pct": 4.229555253706425,
                                "orders": 767,
                                "order_pct": 3.8711956796043,
                                "avg_delivery_time": 45.15177740937224,
                                "retention": 28.274428274428274
                        },
                        {
                                "rank": 8,
                                "region": "Central Jersey",
                                "gmv": 29672.32,
                                "gmv_pct": 4.220237890446553,
                                "orders": 1000,
                                "order_pct": 5.04719123807601,
                                "avg_delivery_time": 25.440114393939396,
                                "retention": 25.513196480938415
                        },
                        {
                                "rank": 9,
                                "region": "Muncie, IN",
                                "gmv": 22551.120000000003,
                                "gmv_pct": 3.207403098106487,
                                "orders": 641,
                                "order_pct": 3.235249583606723,
                                "avg_delivery_time": 31.034086150234742,
                                "retention": 18.235294117647058
                        },
                        {
                                "rank": 10,
                                "region": "Minneapolis",
                                "gmv": 20728.629999999997,
                                "gmv_pct": 2.948193796206266,
                                "orders": 711,
                                "order_pct": 3.5885529702720436,
                                "avg_delivery_time": 25.976507520037718,
                                "retention": 21.637426900584796
                        }
                ],
                "total_orders": 19813,
                "total_aov": 35.4865951647908,
                "weekday_stats": [
                        {
                                "day": "Monday",
                                "orders": 2782,
                                "gmv": 97893.25,
                                "aov": 35.18808411214953
                        },
                        {
                                "day": "Tuesday",
                                "orders": 2502,
                                "gmv": 83793.76,
                                "aov": 33.49071143085531
                        },
                        {
                                "day": "Wednesday",
                                "orders": 2392,
                                "gmv": 83237.01000000001,
                                "aov": 34.79808110367893
                        },
                        {
                                "day": "Thursday",
                                "orders": 2500,
                                "gmv": 90166.91,
                                "aov": 36.066764
                        },
                        {
                                "day": "Friday",
                                "orders": 2862,
                                "gmv": 105965.41,
                                "aov": 37.02495108315863
                        },
                        {
                                "day": "Saturday",
                                "orders": 3249,
                                "gmv": 122888.83,
                                "aov": 37.82358571868267
                        },
                        {
                                "day": "Sunday",
                                "orders": 3256,
                                "gmv": 119150.73999999999,
                                "aov": 36.594207616707614
                        }
                ],
                "hourly_stats": [
                        {
                                "hour": 0,
                                "orders": 439,
                                "gmv": 14165.369999999999,
                                "aov": 32.2673576309795
                        },
                        {
                                "hour": 1,
                                "orders": 248,
                                "gmv": 7710.76,
                                "aov": 31.09177419354839
                        },
                        {
                                "hour": 2,
                                "orders": 164,
                                "gmv": 4646.869999999999,
                                "aov": 28.3345731707317
                        },
                        {
                                "hour": 3,
                                "orders": 35,
                                "gmv": 917.7800000000001,
                                "aov": 26.222285714285718
                        },
                        {
                                "hour": 4,
                                "orders": 38,
                                "gmv": 968.66,
                                "aov": 25.491052631578945
                        },
                        {
                                "hour": 5,
                                "orders": 57,
                                "gmv": 1674.6799999999998,
                                "aov": 29.38035087719298
                        },
                        {
                                "hour": 6,
                                "orders": 114,
                                "gmv": 2878.33,
                                "aov": 25.248508771929824
                        },
                        {
                                "hour": 7,
                                "orders": 241,
                                "gmv": 6677.72,
                                "aov": 27.70838174273859
                        },
                        {
                                "hour": 8,
                                "orders": 470,
                                "gmv": 12423.7,
                                "aov": 26.43340425531915
                        },
                        {
                                "hour": 9,
                                "orders": 702,
                                "gmv": 18741.96,
                                "aov": 26.697948717948716
                        },
                        {
                                "hour": 10,
                                "orders": 877,
                                "gmv": 24951.560000000005,
                                "aov": 28.451037628278225
                        },
                        {
                                "hour": 11,
                                "orders": 1061,
                                "gmv": 33369.53,
                                "aov": 31.451017907634306
                        },
                        {
                                "hour": 12,
                                "orders": 1384,
                                "gmv": 45447.54,
                                "aov": 32.83781791907514
                        },
                        {
                                "hour": 13,
                                "orders": 1165,
                                "gmv": 39058.869999999995,
                                "aov": 33.5269270386266
                        },
                        {
                                "hour": 14,
                                "orders": 931,
                                "gmv": 31612.260000000002,
                                "aov": 33.955166487647695
                        },
                        {
                                "hour": 15,
                                "orders": 954,
                                "gmv": 32225.199999999997,
                                "aov": 33.779035639412996
                        },
                        {
                                "hour": 16,
                                "orders": 1119,
                                "gmv": 41591.369999999995,
                                "aov": 37.16833780160857
                        },
                        {
                                "hour": 17,
                                "orders": 1603,
                                "gmv": 70489.84,
                                "aov": 43.973699313786646
                        },
                        {
                                "hour": 18,
                                "orders": 1944,
                                "gmv": 85032.23000000001,
                                "aov": 43.74085905349795
                        },
                        {
                                "hour": 19,
                                "orders": 1853,
                                "gmv": 78567.73000000001,
                                "aov": 42.40028602266595
                        },
                        {
                                "hour": 20,
                                "orders": 1596,
                                "gmv": 64353.84,
                                "aov": 40.32195488721804
                        },
                        {
                                "hour": 21,
                                "orders": 1142,
                                "gmv": 40563.13,
                                "aov": 35.51937828371278
                        },
                        {
                                "hour": 22,
                                "orders": 817,
                                "gmv": 26598.97,
                                "aov": 32.5568788249694
                        },
                        {
                                "hour": 23,
                                "orders": 589,
                                "gmv": 18428.010000000002,
                                "aov": 31.286943972835317
                        }
                ],
                "order_sizes": {
                        "small_pct": 17.877151365265227,
                        "regular_pct": 44.339575026497755,
                        "large_pct": 36.067228587291176,
                        "xlarge_pct": 1.7160450209458438
                }
        },
        "regions": {
                "San Francisco": {
                        "operational": {
                                "total_fulfillment_time": 29.623246941995866,
                                "prep_time": 11.846744678419848,
                                "delivery_time": 16.43967500272064,
                                "driver_active_time": 16.43967500272064,
                                "prep_time_pct": 39.99137806067141,
                                "delivery_time_pct": 55.49585781366415,
                                "fast_pct": 20.701982450438738,
                                "normal_pct": 56.22359441013975,
                                "slow_pct": 22.619434514137147,
                                "incomplete_rate": 1.0399740006499838,
                                "driver_to_order_ratio": 0.36789080272993174,
                                "lunch_rush_failure_rate": 1.3618677042801557,
                                "dinner_rush_failure_rate": 0.8383233532934131
                        },
                        "revenue": {
                                "total_gmv": 112394.18,
                                "avg_net_order": 35.871130971725705,
                                "avg_tip_pct": 11.517210338215458,
                                "aov": 36.527195320116995,
                                "small_pct": 8.547286317842055,
                                "regular_pct": 49.43126421839454,
                                "large_pct": 41.208969775755605,
                                "xlarge_pct": 0.8124796880077998
                        },
                        "satisfaction": {
                                "avg_tip_pct": 11.517210338215458,
                                "refund_rate": 1.0399740006499838,
                                "highest_refund_restaurant": 11000,
                                "highest_refund_restaurant_count": 32,
                                "highest_refund_hour": 15,
                                "highest_refund_hour_count": 6
                        },
                        "flags": {
                                "very_long_count": 9,
                                "very_long_pct": 0.29249268768280795,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": 23267655,
                                "driver_outlier_rate": 100.0
                        }
                },
                "Dallas": {
                        "operational": {
                                "total_fulfillment_time": 41.16809782512206,
                                "prep_time": 20.540224323124722,
                                "delivery_time": 20.588580004438526,
                                "driver_active_time": 20.588580004438523,
                                "prep_time_pct": 49.893547208271634,
                                "delivery_time_pct": 50.011006318282526,
                                "fast_pct": 1.1335012594458438,
                                "normal_pct": 34.63476070528967,
                                "slow_pct": 58.816120906801004,
                                "incomplete_rate": 1.7632241813602016,
                                "driver_to_order_ratio": 0.663727959697733,
                                "lunch_rush_failure_rate": 1.7094017094017095,
                                "dinner_rush_failure_rate": 2.2277227722772275
                        },
                        "revenue": {
                                "total_gmv": 37136.17,
                                "avg_net_order": 46.24049118387909,
                                "avg_tip_pct": 11.428423555408306,
                                "aov": 46.77099496221662,
                                "small_pct": 9.319899244332493,
                                "regular_pct": 31.863979848866496,
                                "large_pct": 53.14861460957179,
                                "xlarge_pct": 5.6675062972292185
                        },
                        "satisfaction": {
                                "avg_tip_pct": 11.428423555408306,
                                "refund_rate": 1.7632241813602016,
                                "highest_refund_restaurant": 2434035,
                                "highest_refund_restaurant_count": 6,
                                "highest_refund_hour": 18,
                                "highest_refund_hour_count": 6
                        },
                        "flags": {
                                "very_long_count": 2,
                                "very_long_pct": 0.2518891687657431,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": 7086663,
                                "driver_outlier_rate": 100.0
                        }
                },
                "Florence, SC": {
                        "operational": {
                                "total_fulfillment_time": 37.98415897435898,
                                "prep_time": 17.144591025641027,
                                "delivery_time": 20.833284615384613,
                                "driver_active_time": 20.833284615384613,
                                "prep_time_pct": 45.13616067480763,
                                "delivery_time_pct": 54.84729734163134,
                                "fast_pct": 0.0,
                                "normal_pct": 30.76923076923077,
                                "slow_pct": 69.23076923076923,
                                "incomplete_rate": 0.0,
                                "driver_to_order_ratio": 0.9230769230769231,
                                "lunch_rush_failure_rate": 0.0,
                                "dinner_rush_failure_rate": 0.0
                        },
                        "revenue": {
                                "total_gmv": 455.28000000000003,
                                "avg_net_order": 34.62076923076923,
                                "avg_tip_pct": 9.305068217070035,
                                "aov": 35.02153846153846,
                                "small_pct": 0.0,
                                "regular_pct": 69.23076923076923,
                                "large_pct": 30.76923076923077,
                                "xlarge_pct": 0.0
                        },
                        "satisfaction": {
                                "avg_tip_pct": 9.305068217070035,
                                "refund_rate": 0.0,
                                "highest_refund_restaurant": null,
                                "highest_refund_restaurant_count": 0,
                                "highest_refund_hour": null,
                                "highest_refund_hour_count": 0
                        },
                        "flags": {
                                "very_long_count": 0,
                                "very_long_pct": 0.0,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Scranton": {
                        "operational": {
                                "total_fulfillment_time": 23.712076835710512,
                                "prep_time": 8.716270702588485,
                                "delivery_time": 14.06124496038035,
                                "driver_active_time": 14.06124496038035,
                                "prep_time_pct": 36.758782298907434,
                                "delivery_time_pct": 59.29992998000091,
                                "fast_pct": 43.19875776397515,
                                "normal_pct": 44.87577639751553,
                                "slow_pct": 9.906832298136646,
                                "incomplete_rate": 2.28328173374613,
                                "driver_to_order_ratio": 0.184472049689441,
                                "lunch_rush_failure_rate": 1.0101010101010102,
                                "dinner_rush_failure_rate": 3.7953795379537953
                        },
                        "revenue": {
                                "total_gmv": 91475.11,
                                "avg_net_order": 27.880322981366458,
                                "avg_tip_pct": 8.779701379375815,
                                "aov": 28.408419254658384,
                                "small_pct": 25.43478260869565,
                                "regular_pct": 49.93788819875776,
                                "large_pct": 24.627329192546586,
                                "xlarge_pct": 0.0
                        },
                        "satisfaction": {
                                "avg_tip_pct": 8.779701379375815,
                                "refund_rate": 2.360248447204969,
                                "highest_refund_restaurant": 690495,
                                "highest_refund_restaurant_count": 76,
                                "highest_refund_hour": 19,
                                "highest_refund_hour_count": 9
                        },
                        "flags": {
                                "very_long_count": 8,
                                "very_long_pct": 0.2484472049689441,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": 5749938,
                                "driver_outlier_rate": 100.0
                        }
                },
                "Chicago": {
                        "operational": {
                                "total_fulfillment_time": 35.97186869158879,
                                "prep_time": 12.714819470404986,
                                "delivery_time": 21.834104205607474,
                                "driver_active_time": 21.834104205607474,
                                "prep_time_pct": 35.34656367012165,
                                "delivery_time_pct": 60.6977201902021,
                                "fast_pct": 13.023255813953488,
                                "normal_pct": 42.7906976744186,
                                "slow_pct": 43.72093023255814,
                                "incomplete_rate": 1.3953488372093024,
                                "driver_to_order_ratio": 0.7069767441860465,
                                "lunch_rush_failure_rate": 5.88235294117647,
                                "dinner_rush_failure_rate": 0.0
                        },
                        "revenue": {
                                "total_gmv": 12298.09,
                                "avg_net_order": 55.65306976744186,
                                "avg_tip_pct": 10.28565303209105,
                                "aov": 57.20041860465116,
                                "small_pct": 2.7906976744186047,
                                "regular_pct": 15.348837209302326,
                                "large_pct": 74.88372093023256,
                                "xlarge_pct": 6.976744186046512
                        },
                        "satisfaction": {
                                "avg_tip_pct": 10.28565303209105,
                                "refund_rate": 1.3953488372093024,
                                "highest_refund_restaurant": 179164,
                                "highest_refund_restaurant_count": 3,
                                "highest_refund_hour": 12,
                                "highest_refund_hour_count": 1
                        },
                        "flags": {
                                "very_long_count": 1,
                                "very_long_pct": 0.46511627906976744,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": 3796382,
                                "driver_outlier_rate": 100.0
                        }
                },
                "Traverse City, MI": {
                        "operational": {
                                "total_fulfillment_time": 37.02179194139194,
                                "prep_time": 16.294603192046047,
                                "delivery_time": 18.45584908424908,
                                "driver_active_time": 18.45584908424908,
                                "prep_time_pct": 44.013545367662196,
                                "delivery_time_pct": 49.85131220408231,
                                "fast_pct": 3.421461897356143,
                                "normal_pct": 52.56609642301711,
                                "slow_pct": 43.07931570762053,
                                "incomplete_rate": 0.9331259720062209,
                                "driver_to_order_ratio": 0.432348367029549,
                                "lunch_rush_failure_rate": 1.639344262295082,
                                "dinner_rush_failure_rate": 1.1173184357541899
                        },
                        "revenue": {
                                "total_gmv": 32196.730000000003,
                                "avg_net_order": 49.540590979782266,
                                "avg_tip_pct": 12.871117033350357,
                                "aov": 50.07267496111976,
                                "small_pct": 3.265940902021773,
                                "regular_pct": 28.92690513219285,
                                "large_pct": 64.23017107309487,
                                "xlarge_pct": 3.576982892690513
                        },
                        "satisfaction": {
                                "avg_tip_pct": 12.871117033350357,
                                "refund_rate": 0.9331259720062209,
                                "highest_refund_restaurant": 22917173,
                                "highest_refund_restaurant_count": 6,
                                "highest_refund_hour": 20,
                                "highest_refund_hour_count": 3
                        },
                        "flags": {
                                "very_long_count": 6,
                                "very_long_pct": 0.9331259720062209,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": 31998041,
                                "driver_outlier_rate": 100.0
                        }
                },
                "Calgary": {
                        "operational": {
                                "total_fulfillment_time": 41.326925,
                                "prep_time": 21.665713333333336,
                                "delivery_time": 19.658988333333333,
                                "driver_active_time": 19.658988333333333,
                                "prep_time_pct": 52.425176403357696,
                                "delivery_time_pct": 47.56944373028802,
                                "fast_pct": 0.0,
                                "normal_pct": 30.0,
                                "slow_pct": 70.0,
                                "incomplete_rate": 10.0,
                                "driver_to_order_ratio": 1.0,
                                "lunch_rush_failure_rate": 0.0,
                                "dinner_rush_failure_rate": 11.11111111111111
                        },
                        "revenue": {
                                "total_gmv": 420.11,
                                "avg_net_order": 39.979,
                                "avg_tip_pct": 11.595043719163339,
                                "aov": 42.011,
                                "small_pct": 20.0,
                                "regular_pct": 10.0,
                                "large_pct": 70.0,
                                "xlarge_pct": 0.0
                        },
                        "satisfaction": {
                                "avg_tip_pct": 11.595043719163339,
                                "refund_rate": 10.0,
                                "highest_refund_restaurant": 537034,
                                "highest_refund_restaurant_count": 1,
                                "highest_refund_hour": 17,
                                "highest_refund_hour_count": 1
                        },
                        "flags": {
                                "very_long_count": 0,
                                "very_long_pct": 0.0,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": 33395814,
                                "driver_outlier_rate": 100.0
                        }
                },
                "Oak Harbor, WA": {
                        "operational": {
                                "total_fulfillment_time": 25.781705777777777,
                                "prep_time": 9.960011111111111,
                                "delivery_time": 15.50934588888889,
                                "driver_active_time": 15.50934588888889,
                                "prep_time_pct": 38.63208740709476,
                                "delivery_time_pct": 60.15639935762892,
                                "fast_pct": 29.13907284768212,
                                "normal_pct": 57.615894039735096,
                                "slow_pct": 12.582781456953644,
                                "incomplete_rate": 0.0,
                                "driver_to_order_ratio": 0.609271523178808,
                                "lunch_rush_failure_rate": 0.0,
                                "dinner_rush_failure_rate": 0.0
                        },
                        "revenue": {
                                "total_gmv": 5291.06,
                                "avg_net_order": 34.92794701986755,
                                "avg_tip_pct": 11.80793012597658,
                                "aov": 35.04013245033113,
                                "small_pct": 5.960264900662252,
                                "regular_pct": 60.264900662251655,
                                "large_pct": 33.11258278145696,
                                "xlarge_pct": 0.6622516556291391
                        },
                        "satisfaction": {
                                "avg_tip_pct": 11.80793012597658,
                                "refund_rate": 0.0,
                                "highest_refund_restaurant": null,
                                "highest_refund_restaurant_count": 0,
                                "highest_refund_hour": null,
                                "highest_refund_hour_count": 0
                        },
                        "flags": {
                                "very_long_count": 0,
                                "very_long_pct": 0.0,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Lufkin, TX": {
                        "operational": {
                                "total_fulfillment_time": 24.54859119496855,
                                "prep_time": 10.436419871794872,
                                "delivery_time": 14.003213141025638,
                                "driver_active_time": 14.003213141025638,
                                "prep_time_pct": 42.5133148737835,
                                "delivery_time_pct": 57.04283814011991,
                                "fast_pct": 39.62264150943396,
                                "normal_pct": 52.83018867924528,
                                "slow_pct": 7.547169811320755,
                                "incomplete_rate": 0.0,
                                "driver_to_order_ratio": 0.8490566037735849,
                                "lunch_rush_failure_rate": 0.0,
                                "dinner_rush_failure_rate": 0.0
                        },
                        "revenue": {
                                "total_gmv": 1634.3499999999997,
                                "avg_net_order": 30.66735849056603,
                                "avg_tip_pct": 9.246444610206051,
                                "aov": 30.83679245283018,
                                "small_pct": 16.9811320754717,
                                "regular_pct": 52.83018867924528,
                                "large_pct": 30.18867924528302,
                                "xlarge_pct": 0.0
                        },
                        "satisfaction": {
                                "avg_tip_pct": 9.246444610206051,
                                "refund_rate": 0.0,
                                "highest_refund_restaurant": null,
                                "highest_refund_restaurant_count": 0,
                                "highest_refund_hour": null,
                                "highest_refund_hour_count": 0
                        },
                        "flags": {
                                "very_long_count": 0,
                                "very_long_pct": 0.0,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Sacramento": {
                        "operational": {
                                "total_fulfillment_time": 41.45480066934404,
                                "prep_time": 25.44494203480589,
                                "delivery_time": 16.006688821954487,
                                "driver_active_time": 16.006688821954487,
                                "prep_time_pct": 61.37996474223192,
                                "delivery_time_pct": 38.612388827119574,
                                "fast_pct": 3.614457831325301,
                                "normal_pct": 44.97991967871486,
                                "slow_pct": 51.40562248995983,
                                "incomplete_rate": 1.2048192771084338,
                                "driver_to_order_ratio": 0.6184738955823293,
                                "lunch_rush_failure_rate": 0.0,
                                "dinner_rush_failure_rate": 1.7543859649122806
                        },
                        "revenue": {
                                "total_gmv": 17219.190000000002,
                                "avg_net_order": 68.84678714859437,
                                "avg_tip_pct": 10.336435969711884,
                                "aov": 69.15337349397592,
                                "small_pct": 1.6064257028112447,
                                "regular_pct": 18.072289156626507,
                                "large_pct": 61.84738955823293,
                                "xlarge_pct": 18.473895582329316
                        },
                        "satisfaction": {
                                "avg_tip_pct": 10.336435969711884,
                                "refund_rate": 1.2048192771084338,
                                "highest_refund_restaurant": 1837054,
                                "highest_refund_restaurant_count": 3,
                                "highest_refund_hour": 18,
                                "highest_refund_hour_count": 1
                        },
                        "flags": {
                                "very_long_count": 4,
                                "very_long_pct": 1.6064257028112447,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": 14404481,
                                "driver_outlier_rate": 100.0
                        }
                },
                "Hamilton": {
                        "operational": {
                                "total_fulfillment_time": 26.67922008281574,
                                "prep_time": 11.300011283643892,
                                "delivery_time": 12.301165113871633,
                                "driver_active_time": 12.301165113871633,
                                "prep_time_pct": 42.355103517146304,
                                "delivery_time_pct": 46.107663851069226,
                                "fast_pct": 43.47826086956522,
                                "normal_pct": 45.962732919254655,
                                "slow_pct": 10.559006211180124,
                                "incomplete_rate": 3.9473684210526314,
                                "driver_to_order_ratio": 0.6583850931677019,
                                "lunch_rush_failure_rate": 0.0,
                                "dinner_rush_failure_rate": 11.11111111111111
                        },
                        "revenue": {
                                "total_gmv": 3613.9700000000003,
                                "avg_net_order": 21.26608695652174,
                                "avg_tip_pct": 5.621251609156686,
                                "aov": 22.447018633540374,
                                "small_pct": 49.06832298136646,
                                "regular_pct": 43.47826086956522,
                                "large_pct": 7.453416149068323,
                                "xlarge_pct": 0.0
                        },
                        "satisfaction": {
                                "avg_tip_pct": 5.621251609156686,
                                "refund_rate": 1.8633540372670807,
                                "highest_refund_restaurant": 455137,
                                "highest_refund_restaurant_count": 3,
                                "highest_refund_hour": 14,
                                "highest_refund_hour_count": 1
                        },
                        "flags": {
                                "very_long_count": 1,
                                "very_long_pct": 0.6211180124223602,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": 21644698,
                                "driver_outlier_rate": 100.0
                        }
                },
                "South Bay": {
                        "operational": {
                                "total_fulfillment_time": 48.268025776397515,
                                "prep_time": 29.362166149068322,
                                "delivery_time": 18.90271894409938,
                                "driver_active_time": 18.90271894409938,
                                "prep_time_pct": 60.831504244837106,
                                "delivery_time_pct": 39.16198899798919,
                                "fast_pct": 0.0,
                                "normal_pct": 24.074074074074073,
                                "slow_pct": 75.30864197530865,
                                "incomplete_rate": 0.0,
                                "driver_to_order_ratio": 0.7962962962962963,
                                "lunch_rush_failure_rate": 0.0,
                                "dinner_rush_failure_rate": 0.0
                        },
                        "revenue": {
                                "total_gmv": 10690.07,
                                "avg_net_order": 65.60277777777777,
                                "avg_tip_pct": 8.458585801215442,
                                "aov": 65.98808641975309,
                                "small_pct": 0.6172839506172839,
                                "regular_pct": 10.493827160493826,
                                "large_pct": 74.07407407407408,
                                "xlarge_pct": 14.814814814814813
                        },
                        "satisfaction": {
                                "avg_tip_pct": 8.458585801215442,
                                "refund_rate": 0.0,
                                "highest_refund_restaurant": null,
                                "highest_refund_restaurant_count": 0,
                                "highest_refund_hour": null,
                                "highest_refund_hour_count": 0
                        },
                        "flags": {
                                "very_long_count": 3,
                                "very_long_pct": 1.8518518518518516,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Lake Tahoe, CA": {
                        "operational": {
                                "total_fulfillment_time": 30.350713608562685,
                                "prep_time": 10.763303058103975,
                                "delivery_time": 19.58383677370031,
                                "driver_active_time": 19.58383677370031,
                                "prep_time_pct": 35.4630971677298,
                                "delivery_time_pct": 64.52512789740543,
                                "fast_pct": 15.137614678899084,
                                "normal_pct": 61.00917431192661,
                                "slow_pct": 23.853211009174313,
                                "incomplete_rate": 0.45871559633027525,
                                "driver_to_order_ratio": 0.481651376146789,
                                "lunch_rush_failure_rate": 0.0,
                                "dinner_rush_failure_rate": 0.6578947368421052
                        },
                        "revenue": {
                                "total_gmv": 12266.119999999999,
                                "avg_net_order": 56.141009174311925,
                                "avg_tip_pct": 12.116468702814482,
                                "aov": 56.266605504587154,
                                "small_pct": 0.9174311926605505,
                                "regular_pct": 27.06422018348624,
                                "large_pct": 65.13761467889908,
                                "xlarge_pct": 6.8807339449541285
                        },
                        "satisfaction": {
                                "avg_tip_pct": 12.116468702814482,
                                "refund_rate": 0.45871559633027525,
                                "highest_refund_restaurant": 24575094,
                                "highest_refund_restaurant_count": 1,
                                "highest_refund_hour": 17,
                                "highest_refund_hour_count": 1
                        },
                        "flags": {
                                "very_long_count": 1,
                                "very_long_pct": 0.45871559633027525,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": 20039426,
                                "driver_outlier_rate": 100.0
                        }
                },
                "Bellevue": {
                        "operational": {
                                "total_fulfillment_time": 45.15177740937224,
                                "prep_time": 22.387887687886824,
                                "delivery_time": 20.59022183908046,
                                "driver_active_time": 20.590221839080456,
                                "prep_time_pct": 49.583624327576814,
                                "delivery_time_pct": 45.60223986842766,
                                "fast_pct": 1.564537157757497,
                                "normal_pct": 26.205997392438068,
                                "slow_pct": 70.53455019556715,
                                "incomplete_rate": 1.0484927916120577,
                                "driver_to_order_ratio": 0.6897001303780965,
                                "lunch_rush_failure_rate": 1.8604651162790697,
                                "dinner_rush_failure_rate": 0.9345794392523363
                        },
                        "revenue": {
                                "total_gmv": 29737.83,
                                "avg_net_order": 38.15349413298566,
                                "avg_tip_pct": 10.680630979989656,
                                "aov": 38.77161668839635,
                                "small_pct": 10.29986962190352,
                                "regular_pct": 42.11212516297262,
                                "large_pct": 46.28422425032595,
                                "xlarge_pct": 1.303780964797914
                        },
                        "satisfaction": {
                                "avg_tip_pct": 10.680630979989656,
                                "refund_rate": 1.0430247718383312,
                                "highest_refund_restaurant": 24907356,
                                "highest_refund_restaurant_count": 8,
                                "highest_refund_hour": 11,
                                "highest_refund_hour_count": 2
                        },
                        "flags": {
                                "very_long_count": 5,
                                "very_long_pct": 0.651890482398957,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": 3411343,
                                "driver_outlier_rate": 100.0
                        }
                },
                "Rochester": {
                        "operational": {
                                "total_fulfillment_time": 32.48981166666667,
                                "prep_time": 14.493532083333331,
                                "delivery_time": 17.988221666666668,
                                "driver_active_time": 17.988221666666668,
                                "prep_time_pct": 44.60946782958165,
                                "delivery_time_pct": 55.3657308057649,
                                "fast_pct": 4.878048780487805,
                                "normal_pct": 56.09756097560976,
                                "slow_pct": 36.58536585365854,
                                "incomplete_rate": 0.0,
                                "driver_to_order_ratio": 0.9024390243902439,
                                "lunch_rush_failure_rate": 0.0,
                                "dinner_rush_failure_rate": 0.0
                        },
                        "revenue": {
                                "total_gmv": 1997.1,
                                "avg_net_order": 48.46634146341464,
                                "avg_tip_pct": 12.682063321482357,
                                "aov": 48.70975609756098,
                                "small_pct": 7.317073170731707,
                                "regular_pct": 19.51219512195122,
                                "large_pct": 70.73170731707317,
                                "xlarge_pct": 2.4390243902439024
                        },
                        "satisfaction": {
                                "avg_tip_pct": 12.682063321482357,
                                "refund_rate": 0.0,
                                "highest_refund_restaurant": null,
                                "highest_refund_restaurant_count": 0,
                                "highest_refund_hour": null,
                                "highest_refund_hour_count": 0
                        },
                        "flags": {
                                "very_long_count": 0,
                                "very_long_pct": 0.0,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Baltimore": {
                        "operational": {
                                "total_fulfillment_time": 35.876103846153846,
                                "prep_time": 19.6602641025641,
                                "delivery_time": 16.211801282051283,
                                "driver_active_time": 16.211801282051283,
                                "prep_time_pct": 54.80044373511815,
                                "delivery_time_pct": 45.18829957559423,
                                "fast_pct": 7.6923076923076925,
                                "normal_pct": 38.46153846153847,
                                "slow_pct": 53.84615384615385,
                                "incomplete_rate": 7.6923076923076925,
                                "driver_to_order_ratio": 0.8461538461538461,
                                "lunch_rush_failure_rate": 0.0,
                                "dinner_rush_failure_rate": 9.090909090909092
                        },
                        "revenue": {
                                "total_gmv": 586.49,
                                "avg_net_order": 44.09615384615385,
                                "avg_tip_pct": 15.988457356414024,
                                "aov": 45.114615384615384,
                                "small_pct": 0.0,
                                "regular_pct": 30.76923076923077,
                                "large_pct": 61.53846153846154,
                                "xlarge_pct": 7.6923076923076925
                        },
                        "satisfaction": {
                                "avg_tip_pct": 15.988457356414024,
                                "refund_rate": 7.6923076923076925,
                                "highest_refund_restaurant": 27971896,
                                "highest_refund_restaurant_count": 1,
                                "highest_refund_hour": 17,
                                "highest_refund_hour_count": 1
                        },
                        "flags": {
                                "very_long_count": 0,
                                "very_long_pct": 0.0,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": 16207941,
                                "driver_outlier_rate": 100.0
                        }
                },
                "Lubbock": {
                        "operational": {
                                "total_fulfillment_time": 19.909853703703703,
                                "prep_time": 9.52503549382716,
                                "delivery_time": 10.132562511870844,
                                "driver_active_time": 10.132562511870844,
                                "prep_time_pct": 47.840811065604555,
                                "delivery_time_pct": 50.892199725133835,
                                "fast_pct": 60.9308885754584,
                                "normal_pct": 32.86318758815233,
                                "slow_pct": 5.218617771509168,
                                "incomplete_rate": 1.4577259475218658,
                                "driver_to_order_ratio": 0.5966149506346967,
                                "lunch_rush_failure_rate": 1.5267175572519083,
                                "dinner_rush_failure_rate": 0.591715976331361
                        },
                        "revenue": {
                                "total_gmv": 17237.980000000003,
                                "avg_net_order": 23.717954866008462,
                                "avg_tip_pct": 8.887636552843427,
                                "aov": 24.313088857545843,
                                "small_pct": 41.18476727785614,
                                "regular_pct": 44.851904090267986,
                                "large_pct": 13.963328631875882,
                                "xlarge_pct": 0.0
                        },
                        "satisfaction": {
                                "avg_tip_pct": 8.887636552843427,
                                "refund_rate": 1.4104372355430184,
                                "highest_refund_restaurant": 2498402,
                                "highest_refund_restaurant_count": 10,
                                "highest_refund_hour": 23,
                                "highest_refund_hour_count": 3
                        },
                        "flags": {
                                "very_long_count": 0,
                                "very_long_pct": 0.0,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": 34441047,
                                "driver_outlier_rate": 100.0
                        }
                },
                "Port St. Lucie": {
                        "operational": {
                                "total_fulfillment_time": 28.003987878787882,
                                "prep_time": 11.055771212121211,
                                "delivery_time": 16.945225757575756,
                                "driver_active_time": 16.94522575757576,
                                "prep_time_pct": 39.47927438040209,
                                "delivery_time_pct": 60.51004532254929,
                                "fast_pct": 36.36363636363637,
                                "normal_pct": 36.36363636363637,
                                "slow_pct": 27.27272727272727,
                                "incomplete_rate": 0.0,
                                "driver_to_order_ratio": 1.0,
                                "lunch_rush_failure_rate": 0,
                                "dinner_rush_failure_rate": 0.0
                        },
                        "revenue": {
                                "total_gmv": 319.36,
                                "avg_net_order": 28.922727272727272,
                                "avg_tip_pct": 13.166111902097061,
                                "aov": 29.032727272727275,
                                "small_pct": 9.090909090909092,
                                "regular_pct": 72.72727272727273,
                                "large_pct": 18.181818181818183,
                                "xlarge_pct": 0.0
                        },
                        "satisfaction": {
                                "avg_tip_pct": 13.166111902097061,
                                "refund_rate": 0.0,
                                "highest_refund_restaurant": null,
                                "highest_refund_restaurant_count": 0,
                                "highest_refund_hour": null,
                                "highest_refund_hour_count": 0
                        },
                        "flags": {
                                "very_long_count": 0,
                                "very_long_pct": 0.0,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Buffalo": {
                        "operational": {
                                "total_fulfillment_time": 20.210664258188825,
                                "prep_time": 8.03635366088632,
                                "delivery_time": 12.165771001926782,
                                "driver_active_time": 12.165771001926782,
                                "prep_time_pct": 39.76293682494974,
                                "delivery_time_pct": 60.19481025715191,
                                "fast_pct": 54.7486033519553,
                                "normal_pct": 37.988826815642454,
                                "slow_pct": 3.910614525139665,
                                "incomplete_rate": 3.35195530726257,
                                "driver_to_order_ratio": 0.553072625698324,
                                "lunch_rush_failure_rate": 5.0,
                                "dinner_rush_failure_rate": 4.615384615384616
                        },
                        "revenue": {
                                "total_gmv": 4682.68,
                                "avg_net_order": 25.573575418994412,
                                "avg_tip_pct": 11.335616742888067,
                                "aov": 26.160223463687153,
                                "small_pct": 35.754189944134076,
                                "regular_pct": 46.927374301675975,
                                "large_pct": 17.318435754189945,
                                "xlarge_pct": 0.0
                        },
                        "satisfaction": {
                                "avg_tip_pct": 11.335616742888067,
                                "refund_rate": 3.35195530726257,
                                "highest_refund_restaurant": 1302779,
                                "highest_refund_restaurant_count": 6,
                                "highest_refund_hour": 8,
                                "highest_refund_hour_count": 1
                        },
                        "flags": {
                                "very_long_count": 0,
                                "very_long_pct": 0.0,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": 2812968,
                                "driver_outlier_rate": 100.0
                        }
                },
                "Lakeland": {
                        "operational": {
                                "total_fulfillment_time": 31.86410781746032,
                                "prep_time": 14.254786944444445,
                                "delivery_time": 17.253750396825396,
                                "driver_active_time": 17.253750396825396,
                                "prep_time_pct": 44.73618726783671,
                                "delivery_time_pct": 54.14791619356434,
                                "fast_pct": 9.601873536299765,
                                "normal_pct": 55.97189695550351,
                                "slow_pct": 32.78688524590164,
                                "incomplete_rate": 0.936768149882904,
                                "driver_to_order_ratio": 0.5807962529274004,
                                "lunch_rush_failure_rate": 0.0,
                                "dinner_rush_failure_rate": 1.9138755980861244
                        },
                        "revenue": {
                                "total_gmv": 11300.33,
                                "avg_net_order": 25.990140515222485,
                                "avg_tip_pct": 9.658734130702571,
                                "aov": 26.46447306791569,
                                "small_pct": 33.957845433255265,
                                "regular_pct": 46.604215456674474,
                                "large_pct": 19.437939110070257,
                                "xlarge_pct": 0.0
                        },
                        "satisfaction": {
                                "avg_tip_pct": 9.658734130702571,
                                "refund_rate": 0.936768149882904,
                                "highest_refund_restaurant": 1160958,
                                "highest_refund_restaurant_count": 4,
                                "highest_refund_hour": 20,
                                "highest_refund_hour_count": 2
                        },
                        "flags": {
                                "very_long_count": 0,
                                "very_long_pct": 0.0,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": 5502468,
                                "driver_outlier_rate": 100.0
                        }
                },
                "Hartford": {
                        "operational": {
                                "total_fulfillment_time": 38.85672483443709,
                                "prep_time": 15.56246567328918,
                                "delivery_time": 20.136600662251656,
                                "driver_active_time": 20.136600662251656,
                                "prep_time_pct": 40.05089399479397,
                                "delivery_time_pct": 51.82269156253084,
                                "fast_pct": 3.9735099337748347,
                                "normal_pct": 46.35761589403973,
                                "slow_pct": 49.668874172185426,
                                "incomplete_rate": 0.0,
                                "driver_to_order_ratio": 0.8013245033112583,
                                "lunch_rush_failure_rate": 0.0,
                                "dinner_rush_failure_rate": 0.0
                        },
                        "revenue": {
                                "total_gmv": 7981.000000000001,
                                "avg_net_order": 52.16701986754967,
                                "avg_tip_pct": 13.779211686787615,
                                "aov": 52.85430463576159,
                                "small_pct": 2.6490066225165565,
                                "regular_pct": 23.841059602649008,
                                "large_pct": 68.21192052980133,
                                "xlarge_pct": 5.298013245033113
                        },
                        "satisfaction": {
                                "avg_tip_pct": 13.779211686787615,
                                "refund_rate": 0.0,
                                "highest_refund_restaurant": null,
                                "highest_refund_restaurant_count": 0,
                                "highest_refund_hour": null,
                                "highest_refund_hour_count": 0
                        },
                        "flags": {
                                "very_long_count": 2,
                                "very_long_pct": 1.3245033112582782,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Bakersfield": {
                        "operational": {
                                "total_fulfillment_time": 114.80402608695651,
                                "prep_time": 13.137173429951693,
                                "delivery_time": 23.355147342995167,
                                "driver_active_time": 23.355147342995167,
                                "prep_time_pct": 11.44312954669477,
                                "delivery_time_pct": 20.343491547330558,
                                "fast_pct": 2.898550724637681,
                                "normal_pct": 44.927536231884055,
                                "slow_pct": 52.17391304347826,
                                "incomplete_rate": 0.0,
                                "driver_to_order_ratio": 0.8695652173913043,
                                "lunch_rush_failure_rate": 0.0,
                                "dinner_rush_failure_rate": 0.0
                        },
                        "revenue": {
                                "total_gmv": 3650.5999999999995,
                                "avg_net_order": 52.12753623188406,
                                "avg_tip_pct": 8.652725128392534,
                                "aov": 52.907246376811585,
                                "small_pct": 8.695652173913043,
                                "regular_pct": 30.434782608695656,
                                "large_pct": 53.62318840579711,
                                "xlarge_pct": 7.246376811594203
                        },
                        "satisfaction": {
                                "avg_tip_pct": 8.652725128392534,
                                "refund_rate": 0.0,
                                "highest_refund_restaurant": null,
                                "highest_refund_restaurant_count": 0,
                                "highest_refund_hour": null,
                                "highest_refund_hour_count": 0
                        },
                        "flags": {
                                "very_long_count": 9,
                                "very_long_pct": 13.043478260869565,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Windsor": {
                        "operational": {
                                "total_fulfillment_time": 31.586316309523806,
                                "prep_time": 13.062019404761905,
                                "delivery_time": 18.521496071428572,
                                "driver_active_time": 18.52149607142857,
                                "prep_time_pct": 41.35341163801202,
                                "delivery_time_pct": 58.637721125600294,
                                "fast_pct": 7.042253521126761,
                                "normal_pct": 64.7887323943662,
                                "slow_pct": 26.76056338028169,
                                "incomplete_rate": 1.4084507042253522,
                                "driver_to_order_ratio": 0.5422535211267606,
                                "lunch_rush_failure_rate": 0.0,
                                "dinner_rush_failure_rate": 3.4482758620689653
                        },
                        "revenue": {
                                "total_gmv": 4172.19,
                                "avg_net_order": 28.847816901408454,
                                "avg_tip_pct": 9.509829590513679,
                                "aov": 29.381619718309857,
                                "small_pct": 27.464788732394368,
                                "regular_pct": 45.07042253521127,
                                "large_pct": 27.464788732394368,
                                "xlarge_pct": 0.0
                        },
                        "satisfaction": {
                                "avg_tip_pct": 9.509829590513679,
                                "refund_rate": 1.4084507042253522,
                                "highest_refund_restaurant": 300405,
                                "highest_refund_restaurant_count": 2,
                                "highest_refund_hour": 17,
                                "highest_refund_hour_count": 1
                        },
                        "flags": {
                                "very_long_count": 1,
                                "very_long_pct": 0.7042253521126761,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": 21910356,
                                "driver_outlier_rate": 20.0
                        }
                },
                "LA Valley": {
                        "operational": {
                                "total_fulfillment_time": 38.0651625,
                                "prep_time": 24.96366190476191,
                                "delivery_time": 13.098909523809525,
                                "driver_active_time": 13.098909523809525,
                                "prep_time_pct": 65.5813879811019,
                                "delivery_time_pct": 34.411805082428124,
                                "fast_pct": 64.28571428571429,
                                "normal_pct": 21.428571428571427,
                                "slow_pct": 14.285714285714285,
                                "incomplete_rate": 3.571428571428571,
                                "driver_to_order_ratio": 0.8214285714285714,
                                "lunch_rush_failure_rate": 0.0,
                                "dinner_rush_failure_rate": 0.0
                        },
                        "revenue": {
                                "total_gmv": 658.9100000000001,
                                "avg_net_order": 23.282857142857146,
                                "avg_tip_pct": 12.629851151320885,
                                "aov": 23.532500000000002,
                                "small_pct": 50.0,
                                "regular_pct": 32.142857142857146,
                                "large_pct": 17.857142857142858,
                                "xlarge_pct": 0.0
                        },
                        "satisfaction": {
                                "avg_tip_pct": 12.629851151320885,
                                "refund_rate": 3.571428571428571,
                                "highest_refund_restaurant": 25006256,
                                "highest_refund_restaurant_count": 1,
                                "highest_refund_hour": 16,
                                "highest_refund_hour_count": 1
                        },
                        "flags": {
                                "very_long_count": 1,
                                "very_long_pct": 3.571428571428571,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": 36826190,
                                "driver_outlier_rate": 100.0
                        }
                },
                "Auckland": {
                        "operational": {
                                "total_fulfillment_time": 33.39032412280702,
                                "prep_time": 14.04457061403509,
                                "delivery_time": 19.34255657894737,
                                "driver_active_time": 19.34255657894737,
                                "prep_time_pct": 42.06179779022284,
                                "delivery_time_pct": 57.928627789915865,
                                "fast_pct": 10.526315789473683,
                                "normal_pct": 63.1578947368421,
                                "slow_pct": 26.31578947368421,
                                "incomplete_rate": 0.0,
                                "driver_to_order_ratio": 0.8421052631578947,
                                "lunch_rush_failure_rate": 0.0,
                                "dinner_rush_failure_rate": 0.0
                        },
                        "revenue": {
                                "total_gmv": 1030.47,
                                "avg_net_order": 25.90973684210526,
                                "avg_tip_pct": 0.0,
                                "aov": 27.117631578947368,
                                "small_pct": 44.73684210526316,
                                "regular_pct": 26.31578947368421,
                                "large_pct": 28.947368421052634,
                                "xlarge_pct": 0.0
                        },
                        "satisfaction": {
                                "avg_tip_pct": 0.0,
                                "refund_rate": 0.0,
                                "highest_refund_restaurant": null,
                                "highest_refund_restaurant_count": 0,
                                "highest_refund_hour": null,
                                "highest_refund_hour_count": 0
                        },
                        "flags": {
                                "very_long_count": 1,
                                "very_long_pct": 2.631578947368421,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Vernon, BC": {
                        "operational": {
                                "total_fulfillment_time": 27.86962329059829,
                                "prep_time": 12.05834594017094,
                                "delivery_time": 15.436688034188036,
                                "driver_active_time": 15.436688034188036,
                                "prep_time_pct": 43.26698575878769,
                                "delivery_time_pct": 55.38893681205782,
                                "fast_pct": 18.75,
                                "normal_pct": 61.25000000000001,
                                "slow_pct": 17.5,
                                "incomplete_rate": 2.5316455696202533,
                                "driver_to_order_ratio": 0.475,
                                "lunch_rush_failure_rate": 0.0,
                                "dinner_rush_failure_rate": 0.0
                        },
                        "revenue": {
                                "total_gmv": 2590.8900000000003,
                                "avg_net_order": 30.85425,
                                "avg_tip_pct": 6.071556517980686,
                                "aov": 32.38612500000001,
                                "small_pct": 26.25,
                                "regular_pct": 42.5,
                                "large_pct": 28.749999999999996,
                                "xlarge_pct": 2.5
                        },
                        "satisfaction": {
                                "avg_tip_pct": 6.071556517980686,
                                "refund_rate": 2.5,
                                "highest_refund_restaurant": 24730971,
                                "highest_refund_restaurant_count": 2,
                                "highest_refund_hour": 21,
                                "highest_refund_hour_count": 1
                        },
                        "flags": {
                                "very_long_count": 0,
                                "very_long_pct": 0.0,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": 18661764,
                                "driver_outlier_rate": 50.0
                        }
                },
                "Brooklyn": {
                        "operational": {
                                "total_fulfillment_time": 37.690339889889884,
                                "prep_time": 16.51412032032032,
                                "delivery_time": 21.17258848848849,
                                "driver_active_time": 21.17258848848849,
                                "prep_time_pct": 43.81525974179419,
                                "delivery_time_pct": 56.17510627482524,
                                "fast_pct": 12.759643916913946,
                                "normal_pct": 39.46587537091988,
                                "slow_pct": 46.58753709198813,
                                "incomplete_rate": 2.0,
                                "driver_to_order_ratio": 0.857566765578635,
                                "lunch_rush_failure_rate": 0.0,
                                "dinner_rush_failure_rate": 1.910828025477707
                        },
                        "revenue": {
                                "total_gmv": 13408.099999999999,
                                "avg_net_order": 39.08623145400593,
                                "avg_tip_pct": 1.5628528571012485,
                                "aov": 39.78664688427299,
                                "small_pct": 4.154302670623145,
                                "regular_pct": 46.29080118694362,
                                "large_pct": 47.774480712166174,
                                "xlarge_pct": 1.7804154302670623
                        },
                        "satisfaction": {
                                "avg_tip_pct": 1.5628528571012485,
                                "refund_rate": 2.0771513353115725,
                                "highest_refund_restaurant": 133393,
                                "highest_refund_restaurant_count": 4,
                                "highest_refund_hour": 18,
                                "highest_refund_hour_count": 2
                        },
                        "flags": {
                                "very_long_count": 2,
                                "very_long_pct": 0.5934718100890208,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": 3906427,
                                "driver_outlier_rate": 100.0
                        }
                },
                "Denver/Boulder": {
                        "operational": {
                                "total_fulfillment_time": 29.842199622437967,
                                "prep_time": 10.600955717367851,
                                "delivery_time": 19.235731067961165,
                                "driver_active_time": 19.235731067961165,
                                "prep_time_pct": 35.5233724440243,
                                "delivery_time_pct": 64.45815426252315,
                                "fast_pct": 17.684887459807076,
                                "normal_pct": 62.057877813504824,
                                "slow_pct": 19.614147909967848,
                                "incomplete_rate": 0.6430868167202572,
                                "driver_to_order_ratio": 0.797427652733119,
                                "lunch_rush_failure_rate": 2.2222222222222223,
                                "dinner_rush_failure_rate": 0.7751937984496124
                        },
                        "revenue": {
                                "total_gmv": 14001.93,
                                "avg_net_order": 44.17077170418007,
                                "avg_tip_pct": 13.6991370833453,
                                "aov": 45.022282958199355,
                                "small_pct": 6.109324758842444,
                                "regular_pct": 33.762057877813504,
                                "large_pct": 57.556270096463024,
                                "xlarge_pct": 2.572347266881029
                        },
                        "satisfaction": {
                                "avg_tip_pct": 13.6991370833453,
                                "refund_rate": 0.6430868167202572,
                                "highest_refund_restaurant": 48932,
                                "highest_refund_restaurant_count": 1,
                                "highest_refund_hour": 11,
                                "highest_refund_hour_count": 1
                        },
                        "flags": {
                                "very_long_count": 3,
                                "very_long_pct": 0.964630225080386,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": 32164318,
                                "driver_outlier_rate": 100.0
                        }
                },
                "Winnipeg": {
                        "operational": {
                                "total_fulfillment_time": 21.17378844797178,
                                "prep_time": 7.5862572310405625,
                                "delivery_time": 13.547434126984129,
                                "driver_active_time": 13.547434126984129,
                                "prep_time_pct": 35.82853040060124,
                                "delivery_time_pct": 63.982098245067846,
                                "fast_pct": 51.30890052356021,
                                "normal_pct": 43.97905759162304,
                                "slow_pct": 3.664921465968586,
                                "incomplete_rate": 2.094240837696335,
                                "driver_to_order_ratio": 0.7068062827225131,
                                "lunch_rush_failure_rate": 2.380952380952381,
                                "dinner_rush_failure_rate": 1.5625
                        },
                        "revenue": {
                                "total_gmv": 5220.5599999999995,
                                "avg_net_order": 26.595863874345547,
                                "avg_tip_pct": 6.625367403477797,
                                "aov": 27.332774869109944,
                                "small_pct": 40.31413612565445,
                                "regular_pct": 35.07853403141361,
                                "large_pct": 24.083769633507853,
                                "xlarge_pct": 0.5235602094240838
                        },
                        "satisfaction": {
                                "avg_tip_pct": 6.625367403477797,
                                "refund_rate": 2.094240837696335,
                                "highest_refund_restaurant": 1179825,
                                "highest_refund_restaurant_count": 4,
                                "highest_refund_hour": 11,
                                "highest_refund_hour_count": 1
                        },
                        "flags": {
                                "very_long_count": 0,
                                "very_long_pct": 0.0,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": 21940848,
                                "driver_outlier_rate": 100.0
                        }
                },
                "Minneapolis": {
                        "operational": {
                                "total_fulfillment_time": 25.976507520037718,
                                "prep_time": 11.025815912305516,
                                "delivery_time": 14.94467095709571,
                                "driver_active_time": 14.94467095709571,
                                "prep_time_pct": 42.44533605528164,
                                "delivery_time_pct": 57.53148665411511,
                                "fast_pct": 23.90998593530239,
                                "normal_pct": 62.58790436005626,
                                "slow_pct": 12.939521800281295,
                                "incomplete_rate": 0.42194092827004215,
                                "driver_to_order_ratio": 0.5485232067510548,
                                "lunch_rush_failure_rate": 0.3597122302158274,
                                "dinner_rush_failure_rate": 0
                        },
                        "revenue": {
                                "total_gmv": 20728.629999999997,
                                "avg_net_order": 28.66057665260197,
                                "avg_tip_pct": 12.393921818840772,
                                "aov": 29.154191279887478,
                                "small_pct": 16.17440225035162,
                                "regular_pct": 62.447257383966246,
                                "large_pct": 21.09704641350211,
                                "xlarge_pct": 0.2812939521800281
                        },
                        "satisfaction": {
                                "avg_tip_pct": 12.393921818840772,
                                "refund_rate": 0.42194092827004215,
                                "highest_refund_restaurant": 110356,
                                "highest_refund_restaurant_count": 3,
                                "highest_refund_hour": 9,
                                "highest_refund_hour_count": 1
                        },
                        "flags": {
                                "very_long_count": 0,
                                "very_long_pct": 0.0,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": 25811069,
                                "driver_outlier_rate": 100.0
                        }
                },
                "Orange County": {
                        "operational": {
                                "total_fulfillment_time": 22.477412945113787,
                                "prep_time": 6.624783159303882,
                                "delivery_time": 13.4055681124498,
                                "driver_active_time": 13.4055681124498,
                                "prep_time_pct": 29.473067810252594,
                                "delivery_time_pct": 59.64017364980584,
                                "fast_pct": 62.23277909738717,
                                "normal_pct": 26.44497228820269,
                                "slow_pct": 9.897070467141726,
                                "incomplete_rate": 0.870942201108472,
                                "driver_to_order_ratio": 0.3602533650039588,
                                "lunch_rush_failure_rate": 1.4367816091954022,
                                "dinner_rush_failure_rate": 0.24630541871921183
                        },
                        "revenue": {
                                "total_gmv": 48432.71000000001,
                                "avg_net_order": 37.823832145684875,
                                "avg_tip_pct": 7.812279657379861,
                                "aov": 38.34735550277119,
                                "small_pct": 17.181314330958035,
                                "regular_pct": 37.60886777513856,
                                "large_pct": 41.88440221694378,
                                "xlarge_pct": 3.32541567695962
                        },
                        "satisfaction": {
                                "avg_tip_pct": 7.812279657379861,
                                "refund_rate": 0.870942201108472,
                                "highest_refund_restaurant": 135488,
                                "highest_refund_restaurant_count": 11,
                                "highest_refund_hour": 12,
                                "highest_refund_hour_count": 5
                        },
                        "flags": {
                                "very_long_count": 8,
                                "very_long_pct": 0.6334125098970704,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": 32981924,
                                "driver_outlier_rate": 50.0
                        }
                },
                "Central Jersey": {
                        "operational": {
                                "total_fulfillment_time": 25.440114393939396,
                                "prep_time": 11.120001212121212,
                                "delivery_time": 14.190183232323232,
                                "driver_active_time": 14.190183232323232,
                                "prep_time_pct": 43.710500039144215,
                                "delivery_time_pct": 55.778771323857576,
                                "fast_pct": 37.0,
                                "normal_pct": 45.300000000000004,
                                "slow_pct": 16.7,
                                "incomplete_rate": 1.0582010582010581,
                                "driver_to_order_ratio": 0.418,
                                "lunch_rush_failure_rate": 0.0,
                                "dinner_rush_failure_rate": 1.8181818181818181
                        },
                        "revenue": {
                                "total_gmv": 29672.32,
                                "avg_net_order": 29.33281,
                                "avg_tip_pct": 12.462670009997256,
                                "aov": 29.67232,
                                "small_pct": 20.1,
                                "regular_pct": 55.800000000000004,
                                "large_pct": 23.9,
                                "xlarge_pct": 0.2
                        },
                        "satisfaction": {
                                "avg_tip_pct": 12.462670009997256,
                                "refund_rate": 1.0,
                                "highest_refund_restaurant": 837394,
                                "highest_refund_restaurant_count": 8,
                                "highest_refund_hour": 17,
                                "highest_refund_hour_count": 2
                        },
                        "flags": {
                                "very_long_count": 0,
                                "very_long_pct": 0.0,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": 9566946,
                                "driver_outlier_rate": 100.0
                        }
                },
                "Medford, OR": {
                        "operational": {
                                "total_fulfillment_time": 31.71123535353535,
                                "prep_time": 15.614938383838387,
                                "delivery_time": 16.093531313131315,
                                "driver_active_time": 16.093531313131315,
                                "prep_time_pct": 49.241028328773524,
                                "delivery_time_pct": 50.75025029366166,
                                "fast_pct": 19.51219512195122,
                                "normal_pct": 39.02439024390244,
                                "slow_pct": 21.951219512195124,
                                "incomplete_rate": 4.878048780487805,
                                "driver_to_order_ratio": 0.7073170731707317,
                                "lunch_rush_failure_rate": 9.090909090909092,
                                "dinner_rush_failure_rate": 7.142857142857142
                        },
                        "revenue": {
                                "total_gmv": 1589.17,
                                "avg_net_order": 37.50975609756098,
                                "avg_tip_pct": 9.771575338131871,
                                "aov": 38.76024390243903,
                                "small_pct": 19.51219512195122,
                                "regular_pct": 31.70731707317073,
                                "large_pct": 46.34146341463415,
                                "xlarge_pct": 2.4390243902439024
                        },
                        "satisfaction": {
                                "avg_tip_pct": 9.771575338131871,
                                "refund_rate": 4.878048780487805,
                                "highest_refund_restaurant": 25441476,
                                "highest_refund_restaurant_count": 2,
                                "highest_refund_hour": 13,
                                "highest_refund_hour_count": 1
                        },
                        "flags": {
                                "very_long_count": 0,
                                "very_long_pct": 0.0,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": 21875680,
                                "driver_outlier_rate": 100.0
                        }
                },
                "Whistler, BC": {
                        "operational": {
                                "total_fulfillment_time": 20.900559586466166,
                                "prep_time": 6.484064223057644,
                                "delivery_time": 14.409740852130325,
                                "driver_active_time": 14.409740852130325,
                                "prep_time_pct": 31.023400097173955,
                                "delivery_time_pct": 68.94428253232574,
                                "fast_pct": 56.42857142857143,
                                "normal_pct": 29.464285714285715,
                                "slow_pct": 9.107142857142856,
                                "incomplete_rate": 2.142857142857143,
                                "driver_to_order_ratio": 0.12321428571428572,
                                "lunch_rush_failure_rate": 2.955665024630542,
                                "dinner_rush_failure_rate": 2.1739130434782608
                        },
                        "revenue": {
                                "total_gmv": 11810.02,
                                "avg_net_order": 20.420232142857138,
                                "avg_tip_pct": 9.514326491004276,
                                "aov": 21.08932142857143,
                                "small_pct": 50.89285714285714,
                                "regular_pct": 41.964285714285715,
                                "large_pct": 7.142857142857142,
                                "xlarge_pct": 0.0
                        },
                        "satisfaction": {
                                "avg_tip_pct": 9.514326491004276,
                                "refund_rate": 2.142857142857143,
                                "highest_refund_restaurant": 26106782,
                                "highest_refund_restaurant_count": 12,
                                "highest_refund_hour": 11,
                                "highest_refund_hour_count": 2
                        },
                        "flags": {
                                "very_long_count": 0,
                                "very_long_pct": 0.0,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": 36909412,
                                "driver_outlier_rate": 33.33333333333333
                        }
                },
                "Northern Virginia": {
                        "operational": {
                                "total_fulfillment_time": 40.91260030120482,
                                "prep_time": 19.477645682730923,
                                "delivery_time": 21.42765110441767,
                                "driver_active_time": 21.42765110441767,
                                "prep_time_pct": 47.60793872629341,
                                "delivery_time_pct": 52.37420977074062,
                                "fast_pct": 4.733727810650888,
                                "normal_pct": 33.13609467455622,
                                "slow_pct": 60.35502958579882,
                                "incomplete_rate": 0.819672131147541,
                                "driver_to_order_ratio": 0.8047337278106509,
                                "lunch_rush_failure_rate": 0.0,
                                "dinner_rush_failure_rate": 0.0
                        },
                        "revenue": {
                                "total_gmv": 4784.629999999999,
                                "avg_net_order": 27.94650887573964,
                                "avg_tip_pct": 13.152906229742365,
                                "aov": 28.31142011834319,
                                "small_pct": 21.301775147928996,
                                "regular_pct": 58.57988165680473,
                                "large_pct": 19.526627218934912,
                                "xlarge_pct": 0.591715976331361
                        },
                        "satisfaction": {
                                "avg_tip_pct": 13.152906229742365,
                                "refund_rate": 1.183431952662722,
                                "highest_refund_restaurant": 26182459,
                                "highest_refund_restaurant_count": 2,
                                "highest_refund_hour": 4,
                                "highest_refund_hour_count": 1
                        },
                        "flags": {
                                "very_long_count": 0,
                                "very_long_pct": 0.0,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": 28292400,
                                "driver_outlier_rate": 100.0
                        }
                },
                "Perth": {
                        "operational": {
                                "total_fulfillment_time": 18.64108666666667,
                                "prep_time": 7.672745000000001,
                                "delivery_time": 10.962150000000001,
                                "driver_active_time": 10.962150000000001,
                                "prep_time_pct": 41.16039551342322,
                                "delivery_time_pct": 58.80638932708858,
                                "fast_pct": 80.0,
                                "normal_pct": 20.0,
                                "slow_pct": 0.0,
                                "incomplete_rate": 0.0,
                                "driver_to_order_ratio": 1.0,
                                "lunch_rush_failure_rate": 0.0,
                                "dinner_rush_failure_rate": 0.0
                        },
                        "revenue": {
                                "total_gmv": 227.0,
                                "avg_net_order": 22.433,
                                "avg_tip_pct": 0.0,
                                "aov": 22.7,
                                "small_pct": 50.0,
                                "regular_pct": 40.0,
                                "large_pct": 10.0,
                                "xlarge_pct": 0.0
                        },
                        "satisfaction": {
                                "avg_tip_pct": 0.0,
                                "refund_rate": 0.0,
                                "highest_refund_restaurant": null,
                                "highest_refund_restaurant_count": 0,
                                "highest_refund_hour": null,
                                "highest_refund_hour_count": 0
                        },
                        "flags": {
                                "very_long_count": 0,
                                "very_long_pct": 0.0,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Nashville": {
                        "operational": {
                                "total_fulfillment_time": 32.64118923611111,
                                "prep_time": 13.80531576388889,
                                "delivery_time": 17.210557569444447,
                                "driver_active_time": 17.210557569444447,
                                "prep_time_pct": 42.29415682139424,
                                "delivery_time_pct": 52.72650283956052,
                                "fast_pct": 19.66873706004141,
                                "normal_pct": 60.45548654244306,
                                "slow_pct": 19.25465838509317,
                                "incomplete_rate": 0.2070393374741201,
                                "driver_to_order_ratio": 0.4906832298136646,
                                "lunch_rush_failure_rate": 0.6134969325153374,
                                "dinner_rush_failure_rate": 0.0
                        },
                        "revenue": {
                                "total_gmv": 17008.6,
                                "avg_net_order": 34.78031055900621,
                                "avg_tip_pct": 13.478833955208449,
                                "aov": 35.21449275362318,
                                "small_pct": 8.695652173913043,
                                "regular_pct": 53.41614906832298,
                                "large_pct": 37.47412008281574,
                                "xlarge_pct": 0.4140786749482402
                        },
                        "satisfaction": {
                                "avg_tip_pct": 13.478833955208449,
                                "refund_rate": 0.2070393374741201,
                                "highest_refund_restaurant": 28044587,
                                "highest_refund_restaurant_count": 1,
                                "highest_refund_hour": 11,
                                "highest_refund_hour_count": 1
                        },
                        "flags": {
                                "very_long_count": 4,
                                "very_long_pct": 0.8281573498964804,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": 32803361,
                                "driver_outlier_rate": 20.0
                        }
                },
                "Cedar Rapids": {
                        "operational": {
                                "total_fulfillment_time": 38.226493030303025,
                                "prep_time": 19.29962515151515,
                                "delivery_time": 17.957046363636362,
                                "driver_active_time": 17.957046363636362,
                                "prep_time_pct": 50.487564046787895,
                                "delivery_time_pct": 46.97539570109504,
                                "fast_pct": 3.571428571428571,
                                "normal_pct": 42.857142857142854,
                                "slow_pct": 51.78571428571429,
                                "incomplete_rate": 0.0,
                                "driver_to_order_ratio": 0.8392857142857143,
                                "lunch_rush_failure_rate": 0.0,
                                "dinner_rush_failure_rate": 0.0
                        },
                        "revenue": {
                                "total_gmv": 2730.16,
                                "avg_net_order": 48.253750000000004,
                                "avg_tip_pct": 9.193298420281105,
                                "aov": 48.75285714285714,
                                "small_pct": 1.7857142857142856,
                                "regular_pct": 41.07142857142857,
                                "large_pct": 53.57142857142857,
                                "xlarge_pct": 3.571428571428571
                        },
                        "satisfaction": {
                                "avg_tip_pct": 9.193298420281105,
                                "refund_rate": 0.0,
                                "highest_refund_restaurant": null,
                                "highest_refund_restaurant_count": 0,
                                "highest_refund_hour": null,
                                "highest_refund_hour_count": 0
                        },
                        "flags": {
                                "very_long_count": 0,
                                "very_long_pct": 0.0,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "San Antonio": {
                        "operational": {
                                "total_fulfillment_time": 44.46100036892361,
                                "prep_time": 21.6617944589309,
                                "delivery_time": 20.573285940895264,
                                "driver_active_time": 20.57328594089526,
                                "prep_time_pct": 48.72088859717064,
                                "delivery_time_pct": 46.27265641839929,
                                "fast_pct": 2.842377260981912,
                                "normal_pct": 23.51421188630491,
                                "slow_pct": 72.86821705426357,
                                "incomplete_rate": 2.3323615160349855,
                                "driver_to_order_ratio": 0.7144702842377261,
                                "lunch_rush_failure_rate": 2.73972602739726,
                                "dinner_rush_failure_rate": 2.262443438914027
                        },
                        "revenue": {
                                "total_gmv": 32234.619999999995,
                                "avg_net_order": 40.9756330749354,
                                "avg_tip_pct": 11.128486097721616,
                                "aov": 41.64679586563307,
                                "small_pct": 6.5891472868217065,
                                "regular_pct": 43.15245478036176,
                                "large_pct": 47.80361757105943,
                                "xlarge_pct": 2.454780361757106
                        },
                        "satisfaction": {
                                "avg_tip_pct": 11.128486097721616,
                                "refund_rate": 2.3255813953488373,
                                "highest_refund_restaurant": 47452,
                                "highest_refund_restaurant_count": 14,
                                "highest_refund_hour": 1,
                                "highest_refund_hour_count": 2
                        },
                        "flags": {
                                "very_long_count": 13,
                                "very_long_pct": 1.6795865633074936,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": 6103035,
                                "driver_outlier_rate": 100.0
                        }
                },
                "Rapid City, SD": {
                        "operational": {
                                "total_fulfillment_time": 24.668513278008298,
                                "prep_time": 8.134772683264178,
                                "delivery_time": 16.42043589211618,
                                "driver_active_time": 16.42043589211618,
                                "prep_time_pct": 32.97633948015925,
                                "delivery_time_pct": 66.5643515158849,
                                "fast_pct": 30.165289256198346,
                                "normal_pct": 58.67768595041323,
                                "slow_pct": 10.743801652892563,
                                "incomplete_rate": 0.4132231404958678,
                                "driver_to_order_ratio": 0.6942148760330579,
                                "lunch_rush_failure_rate": 1.1494252873563218,
                                "dinner_rush_failure_rate": 0.0
                        },
                        "revenue": {
                                "total_gmv": 8281.21,
                                "avg_net_order": 33.925206611570246,
                                "avg_tip_pct": 14.204609750118195,
                                "aov": 34.21987603305785,
                                "small_pct": 7.851239669421488,
                                "regular_pct": 50.82644628099173,
                                "large_pct": 41.32231404958678,
                                "xlarge_pct": 0.0
                        },
                        "satisfaction": {
                                "avg_tip_pct": 14.204609750118195,
                                "refund_rate": 0.4132231404958678,
                                "highest_refund_restaurant": 894463,
                                "highest_refund_restaurant_count": 1,
                                "highest_refund_hour": 12,
                                "highest_refund_hour_count": 1
                        },
                        "flags": {
                                "very_long_count": 0,
                                "very_long_pct": 0.0,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": 6383330,
                                "driver_outlier_rate": 50.0
                        }
                },
                "Muncie, IN": {
                        "operational": {
                                "total_fulfillment_time": 31.034086150234742,
                                "prep_time": 15.109460641627543,
                                "delivery_time": 15.92128140323422,
                                "driver_active_time": 15.92128140323422,
                                "prep_time_pct": 48.68666204148323,
                                "delivery_time_pct": 51.302562370162754,
                                "fast_pct": 14.97659906396256,
                                "normal_pct": 57.09828393135725,
                                "slow_pct": 27.613104524180965,
                                "incomplete_rate": 1.24804992199688,
                                "driver_to_order_ratio": 0.47425897035881437,
                                "lunch_rush_failure_rate": 0.0,
                                "dinner_rush_failure_rate": 1.2096774193548387
                        },
                        "revenue": {
                                "total_gmv": 22551.120000000003,
                                "avg_net_order": 34.471591263650545,
                                "avg_tip_pct": 12.050687784195658,
                                "aov": 35.18115444617785,
                                "small_pct": 12.792511700468017,
                                "regular_pct": 49.297971918876755,
                                "large_pct": 36.973478939157566,
                                "xlarge_pct": 0.93603744149766
                        },
                        "satisfaction": {
                                "avg_tip_pct": 12.050687784195658,
                                "refund_rate": 1.24804992199688,
                                "highest_refund_restaurant": 24618036,
                                "highest_refund_restaurant_count": 8,
                                "highest_refund_hour": 23,
                                "highest_refund_hour_count": 2
                        },
                        "flags": {
                                "very_long_count": 2,
                                "very_long_pct": 0.31201248049922,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": 18923869,
                                "driver_outlier_rate": 100.0
                        }
                },
                "Regina": {
                        "operational": {
                                "total_fulfillment_time": 41.667488541666664,
                                "prep_time": 26.802868229166666,
                                "delivery_time": 14.861411979166668,
                                "driver_active_time": 14.861411979166668,
                                "prep_time_pct": 64.32561492724557,
                                "delivery_time_pct": 35.66668522463395,
                                "fast_pct": 0.0,
                                "normal_pct": 42.857142857142854,
                                "slow_pct": 55.10204081632652,
                                "incomplete_rate": 0.0,
                                "driver_to_order_ratio": 0.7142857142857143,
                                "lunch_rush_failure_rate": 0.0,
                                "dinner_rush_failure_rate": 0.0
                        },
                        "revenue": {
                                "total_gmv": 2289.9799999999996,
                                "avg_net_order": 21.680714285714288,
                                "avg_tip_pct": 3.6534726401964064,
                                "aov": 23.367142857142852,
                                "small_pct": 62.244897959183675,
                                "regular_pct": 24.489795918367346,
                                "large_pct": 13.26530612244898,
                                "xlarge_pct": 0.0
                        },
                        "satisfaction": {
                                "avg_tip_pct": 3.6534726401964064,
                                "refund_rate": 0.0,
                                "highest_refund_restaurant": null,
                                "highest_refund_restaurant_count": 0,
                                "highest_refund_hour": null,
                                "highest_refund_hour_count": 0
                        },
                        "flags": {
                                "very_long_count": 2,
                                "very_long_pct": 2.0408163265306123,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Los Angeles": {
                        "operational": {
                                "total_fulfillment_time": 33.97919393939394,
                                "prep_time": 17.38119090909091,
                                "delivery_time": 16.567989393939392,
                                "driver_active_time": 16.567989393939392,
                                "prep_time_pct": 51.1524521155281,
                                "delivery_time_pct": 48.759218430815146,
                                "fast_pct": 0.0,
                                "normal_pct": 66.66666666666666,
                                "slow_pct": 25.0,
                                "incomplete_rate": 0.0,
                                "driver_to_order_ratio": 0.9166666666666666,
                                "lunch_rush_failure_rate": 0,
                                "dinner_rush_failure_rate": 0.0
                        },
                        "revenue": {
                                "total_gmv": 371.51000000000005,
                                "avg_net_order": 30.750833333333336,
                                "avg_tip_pct": 3.7091040635936734,
                                "aov": 30.959166666666672,
                                "small_pct": 8.333333333333332,
                                "regular_pct": 58.333333333333336,
                                "large_pct": 33.33333333333333,
                                "xlarge_pct": 0.0
                        },
                        "satisfaction": {
                                "avg_tip_pct": 3.7091040635936734,
                                "refund_rate": 0.0,
                                "highest_refund_restaurant": null,
                                "highest_refund_restaurant_count": 0,
                                "highest_refund_hour": null,
                                "highest_refund_hour_count": 0
                        },
                        "flags": {
                                "very_long_count": 0,
                                "very_long_pct": 0.0,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "South Texas": {
                        "operational": {
                                "total_fulfillment_time": 45.66015896551725,
                                "prep_time": 29.10555551724138,
                                "delivery_time": 14.843008045977012,
                                "driver_active_time": 14.843008045977012,
                                "prep_time_pct": 63.74387688667932,
                                "delivery_time_pct": 32.50756979884042,
                                "fast_pct": 2.04778156996587,
                                "normal_pct": 27.303754266211605,
                                "slow_pct": 69.6245733788396,
                                "incomplete_rate": 1.3651877133105803,
                                "driver_to_order_ratio": 0.42662116040955633,
                                "lunch_rush_failure_rate": 0.0,
                                "dinner_rush_failure_rate": 1.4084507042253522
                        },
                        "revenue": {
                                "total_gmv": 7938.5,
                                "avg_net_order": 26.37358361774744,
                                "avg_tip_pct": 12.031554242281645,
                                "aov": 27.093856655290104,
                                "small_pct": 29.01023890784983,
                                "regular_pct": 48.122866894197955,
                                "large_pct": 22.866894197952217,
                                "xlarge_pct": 0.0
                        },
                        "satisfaction": {
                                "avg_tip_pct": 12.031554242281645,
                                "refund_rate": 1.3651877133105803,
                                "highest_refund_restaurant": 694494,
                                "highest_refund_restaurant_count": 4,
                                "highest_refund_hour": 21,
                                "highest_refund_hour_count": 2
                        },
                        "flags": {
                                "very_long_count": 1,
                                "very_long_pct": 0.3412969283276451,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": 13086929,
                                "driver_outlier_rate": 100.0
                        }
                },
                "Portland": {
                        "operational": {
                                "total_fulfillment_time": 278.60767894736836,
                                "prep_time": 218.4955600877193,
                                "delivery_time": 21.36619912280701,
                                "driver_active_time": 21.36619912280701,
                                "prep_time_pct": 78.42409832824285,
                                "delivery_time_pct": 7.668919680725415,
                                "fast_pct": 0.0,
                                "normal_pct": 2.564102564102564,
                                "slow_pct": 94.87179487179486,
                                "incomplete_rate": 2.564102564102564,
                                "driver_to_order_ratio": 0.8205128205128205,
                                "lunch_rush_failure_rate": 0,
                                "dinner_rush_failure_rate": 2.941176470588235
                        },
                        "revenue": {
                                "total_gmv": 2270.8600000000006,
                                "avg_net_order": 56.7671794871795,
                                "avg_tip_pct": 9.723624136906208,
                                "aov": 58.227179487179505,
                                "small_pct": 17.94871794871795,
                                "regular_pct": 5.128205128205128,
                                "large_pct": 69.23076923076923,
                                "xlarge_pct": 7.6923076923076925
                        },
                        "satisfaction": {
                                "avg_tip_pct": 9.723624136906208,
                                "refund_rate": 2.564102564102564,
                                "highest_refund_restaurant": 27830670,
                                "highest_refund_restaurant_count": 1,
                                "highest_refund_hour": 18,
                                "highest_refund_hour_count": 1
                        },
                        "flags": {
                                "very_long_count": 3,
                                "very_long_pct": 7.6923076923076925,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": 36157876,
                                "driver_outlier_rate": 50.0
                        }
                },
                "Cincinnati": {
                        "operational": {
                                "total_fulfillment_time": 33.15495733333333,
                                "prep_time": 16.044907444444448,
                                "delivery_time": 17.10656766666667,
                                "driver_active_time": 17.10656766666667,
                                "prep_time_pct": 48.3936905215475,
                                "delivery_time_pct": 51.595806607985196,
                                "fast_pct": 13.333333333333334,
                                "normal_pct": 54.0,
                                "slow_pct": 32.666666666666664,
                                "incomplete_rate": 0.6666666666666667,
                                "driver_to_order_ratio": 0.7933333333333333,
                                "lunch_rush_failure_rate": 0.0,
                                "dinner_rush_failure_rate": 1.1363636363636365
                        },
                        "revenue": {
                                "total_gmv": 5704.78,
                                "avg_net_order": 36.95733333333334,
                                "avg_tip_pct": 12.441558956916642,
                                "aov": 38.031866666666666,
                                "small_pct": 10.0,
                                "regular_pct": 40.0,
                                "large_pct": 50.0,
                                "xlarge_pct": 0.0
                        },
                        "satisfaction": {
                                "avg_tip_pct": 12.441558956916642,
                                "refund_rate": 0.6666666666666667,
                                "highest_refund_restaurant": 23252078,
                                "highest_refund_restaurant_count": 1,
                                "highest_refund_hour": 18,
                                "highest_refund_hour_count": 1
                        },
                        "flags": {
                                "very_long_count": 1,
                                "very_long_pct": 0.6666666666666667,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": 24081403,
                                "driver_outlier_rate": 100.0
                        }
                },
                "Philadelphia": {
                        "operational": {
                                "total_fulfillment_time": 33.39988204845815,
                                "prep_time": 14.823014280469899,
                                "delivery_time": 17.192751248164463,
                                "driver_active_time": 17.192751248164463,
                                "prep_time_pct": 44.38043900563468,
                                "delivery_time_pct": 51.47548492303174,
                                "fast_pct": 7.6923076923076925,
                                "normal_pct": 61.31868131868132,
                                "slow_pct": 30.76923076923077,
                                "incomplete_rate": 2.2172949002217295,
                                "driver_to_order_ratio": 0.7736263736263737,
                                "lunch_rush_failure_rate": 3.7037037037037033,
                                "dinner_rush_failure_rate": 1.953125
                        },
                        "revenue": {
                                "total_gmv": 20598.79,
                                "avg_net_order": 44.43085714285714,
                                "avg_tip_pct": 9.019329778408313,
                                "aov": 45.272065934065935,
                                "small_pct": 13.626373626373626,
                                "regular_pct": 32.527472527472526,
                                "large_pct": 48.57142857142857,
                                "xlarge_pct": 5.274725274725275
                        },
                        "satisfaction": {
                                "avg_tip_pct": 9.019329778408313,
                                "refund_rate": 2.197802197802198,
                                "highest_refund_restaurant": 1383768,
                                "highest_refund_restaurant_count": 6,
                                "highest_refund_hour": 20,
                                "highest_refund_hour_count": 2
                        },
                        "flags": {
                                "very_long_count": 2,
                                "very_long_pct": 0.43956043956043955,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": 22153362,
                                "driver_outlier_rate": 100.0
                        }
                },
                "Boston": {
                        "operational": {
                                "total_fulfillment_time": 18.734138235294118,
                                "prep_time": 9.659532987312572,
                                "delivery_time": 8.931010495963092,
                                "driver_active_time": 8.931010495963092,
                                "prep_time_pct": 51.56112795791442,
                                "delivery_time_pct": 47.67238494662938,
                                "fast_pct": 62.41379310344828,
                                "normal_pct": 32.068965517241374,
                                "slow_pct": 5.172413793103448,
                                "incomplete_rate": 1.384083044982699,
                                "driver_to_order_ratio": 0.42758620689655175,
                                "lunch_rush_failure_rate": 4.444444444444445,
                                "dinner_rush_failure_rate": 0.0
                        },
                        "revenue": {
                                "total_gmv": 6526.37,
                                "avg_net_order": 22.189206896551724,
                                "avg_tip_pct": 13.4701785908106,
                                "aov": 22.504724137931035,
                                "small_pct": 45.86206896551724,
                                "regular_pct": 45.51724137931035,
                                "large_pct": 8.620689655172415,
                                "xlarge_pct": 0.0
                        },
                        "satisfaction": {
                                "avg_tip_pct": 13.4701785908106,
                                "refund_rate": 1.3793103448275863,
                                "highest_refund_restaurant": 1101978,
                                "highest_refund_restaurant_count": 4,
                                "highest_refund_hour": 6,
                                "highest_refund_hour_count": 1
                        },
                        "flags": {
                                "very_long_count": 0,
                                "very_long_pct": 0.0,
                                "very_short_count": 1,
                                "very_short_pct": 0.3448275862068966,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": 22814949,
                                "driver_outlier_rate": 100.0
                        }
                },
                "North Jersey": {
                        "operational": {
                                "total_fulfillment_time": 35.456818229166664,
                                "prep_time": 13.626322916666666,
                                "delivery_time": 12.209279427083333,
                                "driver_active_time": 12.209279427083333,
                                "prep_time_pct": 38.43075492165198,
                                "delivery_time_pct": 34.43422178541677,
                                "fast_pct": 34.375,
                                "normal_pct": 45.3125,
                                "slow_pct": 20.3125,
                                "incomplete_rate": 0.0,
                                "driver_to_order_ratio": 0.65625,
                                "lunch_rush_failure_rate": 0.0,
                                "dinner_rush_failure_rate": 0.0
                        },
                        "revenue": {
                                "total_gmv": 1616.79,
                                "avg_net_order": 25.091406250000002,
                                "avg_tip_pct": 11.543932923190553,
                                "aov": 25.26234375,
                                "small_pct": 50.0,
                                "regular_pct": 31.25,
                                "large_pct": 18.75,
                                "xlarge_pct": 0.0
                        },
                        "satisfaction": {
                                "avg_tip_pct": 11.543932923190553,
                                "refund_rate": 0.0,
                                "highest_refund_restaurant": null,
                                "highest_refund_restaurant_count": 0,
                                "highest_refund_hour": null,
                                "highest_refund_hour_count": 0
                        },
                        "flags": {
                                "very_long_count": 1,
                                "very_long_pct": 1.5625,
                                "very_short_count": 0,
                                "very_short_pct": 0.0,
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                }
        }
};
        
        
        // Chart.js configuration
        Chart.defaults.color = '#4a5568';
        Chart.defaults.borderColor = '#e2e8f0';
        Chart.defaults.font.family = "'IBM Plex Sans', system-ui, sans-serif";
        
        let weekdayChart = null;
        let hourlyChart = null;
        
        // Format currency
        function formatCurrency(value) {
            return '$' + Math.round(value).toLocaleString();
        }
        
        // Format percentage
        function formatPercent(value) {
            return value.toFixed(1) + '%';
        }
        
        // Format time
        function formatTime(minutes) {
            return minutes.toFixed(1) + 'min';
        }
        
        // Format number with commas
        function formatNumber(value) {
            return Math.round(value).toLocaleString();
        }
        
        
        
        let orderSizePieChart = null;
        
        // Initialize pie chart for order sizes
        function initializeOrderSizePieChart(data) {
            const ctx = document.getElementById('orderSizePieChart');
            if (!ctx) return;
            
            // Destroy existing chart if it exists
            if (orderSizePieChart) {
                orderSizePieChart.destroy();
            }
            
            orderSizePieChart = new Chart(ctx.getContext('2d'), {
                type: 'doughnut',
                data: {
                    labels: [
                        'Small (<$20)',
                        'Regular ($20-$35)',
                        'Large ($35-$100)',
                        'X-Large ($100+)'
                    ],
                    datasets: [{
                        data: [
                            data.small || 0,
                            data.regular || 0,
                            data.large || 0,
                            data.xlarge || 0
                        ],
                        backgroundColor: [
                            '#FF3008',
                            'rgb(0, 155, 213)',
                            'rgb(248, 106, 52)',
                            'rgb(0, 131, 138)'
                        ],
                        borderColor: '#ffffff',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 15,
                                font: {
                                    size: 11
                                },
                                usePointStyle: true,
                                pointStyle: 'circle'
                            }
                        },
                        tooltip: {
                            backgroundColor: '#ffffff',
                            borderColor: '#e2e8f0',
                            titleColor: '#191919',
                            bodyColor: '#4a5568',
                            borderWidth: 1,
                            padding: 12,
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = context.parsed || 0;
                                    return label + ': ' + value.toFixed(1) + '%';
                                }
                            }
                        }
                    }
                }
            });
        }
        // Initialize charts
        function initializeCharts() {
            const weekdayData = dashboardData.market_performance.weekday_stats;
            const hourlyData = dashboardData.market_performance.hourly_stats;
            
            // Weekday Chart - Dual Axis (Orders + GMV)
            const weekdayCtx = document.getElementById('weekdayChart').getContext('2d');
            weekdayChart = new Chart(weekdayCtx, {
                type: 'line',
                data: {
                    labels: weekdayData.map(d => d.day),
                    datasets: [
                        {
                            label: 'Orders',
                            data: weekdayData.map(d => d.orders),
                            borderColor: '#FF3008',
                            backgroundColor: 'rgba(255, 48, 8, 0.1)',
                            tension: 0.4,
                            fill: true,
                            pointRadius: 5,
                            pointHoverRadius: 7,
                            pointBackgroundColor: '#FF3008',
                            pointBorderColor: '#ffffff',
                            pointBorderWidth: 2,
                            yAxisID: 'y-orders'
                        },
                        {
                            label: 'GMV',
                            data: weekdayData.map(d => d.gmv),
                            borderColor: 'rgb(0, 155, 213)',
                            backgroundColor: 'rgba(0, 155, 213, 0.1)',
                            tension: 0.4,
                            fill: true,
                            pointRadius: 5,
                            pointHoverRadius: 7,
                            pointBackgroundColor: 'rgb(0, 155, 213)',
                            pointBorderColor: '#ffffff',
                            pointBorderWidth: 2,
                            yAxisID: 'y-gmv'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false
                    },
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top',
                            labels: {
                                usePointStyle: true,
                                padding: 15,
                                font: {
                                    size: 12
                                }
                            }
                        },
                        tooltip: {
                            backgroundColor: '#ffffff',
                            borderColor: '#e2e8f0',
                            borderWidth: 1,
                            padding: 12,
                            displayColors: true,
                            titleColor: '#191919',
                            bodyColor: '#4a5568',
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.dataset.label === 'GMV') {
                                        label += '$' + Math.round(context.parsed.y).toLocaleString();
                                    } else {
                                        label += context.parsed.y.toLocaleString();
                                    }
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        'y-orders': {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Orders',
                                color: '#FF3008',
                                font: {
                                    weight: 'bold',
                                    size: 12
                                }
                            },
                            grid: {
                                color: '#e2e8f0'
                            },
                            ticks: {
                                callback: function(value) {
                                    return value.toLocaleString();
                                }
                            }
                        },
                        'y-gmv': {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'GMV ($)',
                                color: 'rgb(0, 155, 213)',
                                font: {
                                    weight: 'bold',
                                    size: 12
                                }
                            },
                            grid: {
                                drawOnChartArea: false
                            },
                            ticks: {
                                callback: function(value) {
                                    return '$' + (value / 1000).toFixed(0) + 'K';
                                }
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
            
            // Hourly Chart - Dual Axis (Orders + GMV)
            const hourlyCtx = document.getElementById('hourlyChart').getContext('2d');
            hourlyChart = new Chart(hourlyCtx, {
                type: 'line',
                data: {
                    labels: hourlyData.map(d => d.hour + ':00'),
                    datasets: [
                        {
                            label: 'Orders',
                            data: hourlyData.map(d => d.orders),
                            borderColor: '#FF3008',
                            backgroundColor: 'rgba(255, 48, 8, 0.1)',
                            tension: 0.4,
                            fill: true,
                            pointRadius: 3,
                            pointHoverRadius: 6,
                            pointBackgroundColor: '#FF3008',
                            pointBorderColor: '#ffffff',
                            pointBorderWidth: 2,
                            yAxisID: 'y-orders'
                        },
                        {
                            label: 'GMV',
                            data: hourlyData.map(d => d.gmv),
                            borderColor: 'rgb(0, 155, 213)',
                            backgroundColor: 'rgba(0, 155, 213, 0.1)',
                            tension: 0.4,
                            fill: true,
                            pointRadius: 3,
                            pointHoverRadius: 6,
                            pointBackgroundColor: 'rgb(0, 155, 213)',
                            pointBorderColor: '#ffffff',
                            pointBorderWidth: 2,
                            yAxisID: 'y-gmv'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false
                    },
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top',
                            labels: {
                                usePointStyle: true,
                                padding: 15,
                                font: {
                                    size: 12
                                }
                            }
                        },
                        tooltip: {
                            backgroundColor: '#ffffff',
                            borderColor: '#e2e8f0',
                            borderWidth: 1,
                            padding: 12,
                            displayColors: true,
                            titleColor: '#191919',
                            bodyColor: '#4a5568',
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.dataset.label === 'GMV') {
                                        label += '$' + Math.round(context.parsed.y).toLocaleString();
                                    } else {
                                        label += context.parsed.y.toLocaleString();
                                    }
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        'y-orders': {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Orders',
                                color: '#FF3008',
                                font: {
                                    weight: 'bold',
                                    size: 12
                                }
                            },
                            grid: {
                                color: '#e2e8f0'
                            },
                            ticks: {
                                callback: function(value) {
                                    return value.toLocaleString();
                                }
                            }
                        },
                        'y-gmv': {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'GMV ($)',
                                color: 'rgb(0, 155, 213)',
                                font: {
                                    weight: 'bold',
                                    size: 12
                                }
                            },
                            grid: {
                                drawOnChartArea: false
                            },
                            ticks: {
                                callback: function(value) {
                                    return '$' + (value / 1000).toFixed(0) + 'K';
                                }
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                maxRotation: 45,
                                minRotation: 45
                            }
                        }
                    }
                }
            });
        }
        
        function initializeDashboard() {
            // Populate header metrics
            document.getElementById('header-gmv').textContent = formatCurrency(dashboardData.market_performance.total_gmv);
            document.getElementById('header-orders').textContent = formatNumber(dashboardData.market_performance.total_orders);
            document.getElementById('header-aov').textContent = formatCurrency(dashboardData.market_performance.total_aov);
            
            // Initialize charts
            initializeCharts();
            
            // Populate region filter
            const regionFilter = document.getElementById('region-filter');
            const regions = Object.keys(dashboardData.regions).sort();
            
            regions.forEach(region => {
                const option = document.createElement('option');
                option.value = region;
                option.textContent = region;
                regionFilter.appendChild(option);
            });
            
            // Populate top 10 regions table
            populateTopRegionsTable();
            
            // Show total market by default
            showMarketData('all');
            
            // Add event listener for filter
            regionFilter.addEventListener('change', (e) => {
                showMarketData(e.target.value);
            });
            
            // Initialize sortable headers
            initializeSortableHeaders();
        }
        
        // Global variable for all regions data
        let allRegionsData = [];
        let currentSortColumn = 'gmv';
        let currentSortDirection = 'desc';
        
        // Populate all regions table
        function populateTopRegionsTable() {
            // Build all regions data from dashboardData.regions
            allRegionsData = [];
            const totalGMV = dashboardData.market_performance.total_gmv;
            
            Object.keys(dashboardData.regions).forEach(regionName => {
                const regionData = dashboardData.regions[regionName];
                const gmv = regionData.revenue.total_gmv;
                
                // Count orders (derive from GMV and AOV)
                const orders = Math.round(gmv / regionData.revenue.aov);
                
                const deliveryTime = regionData.operational.total_fulfillment_time;
                
                // Include ALL regions (no minimum order filter)
                allRegionsData.push({
                    region: regionName,
                    gmv: gmv,
                    gmv_pct: (gmv / totalGMV * 100),
                    orders: orders,
                    avg_delivery_time: deliveryTime,
                    retention: 0
                });
            });
            
            // Add retention data from top 10 if available
            dashboardData.market_performance.top_10_regions.forEach(top10Region => {
                const match = allRegionsData.find(r => r.region === top10Region.region);
                if (match) {
                    match.retention = top10Region.retention;
                    match.orders = top10Region.orders; // Use actual order count
                }
            });
            
            // Sort by current column
            sortRegionsTable(currentSortColumn, false);
        }
        
        // Sort regions table
        function sortRegionsTable(column, toggleDirection = true) {
            if (toggleDirection && column === currentSortColumn) {
                currentSortDirection = currentSortDirection === 'asc' ? 'desc' : 'asc';
            } else if (column !== currentSortColumn) {
                currentSortColumn = column;
                currentSortDirection = 'desc'; // Default to descending for new column
            }
            
            // Sort the data
            allRegionsData.sort((a, b) => {
                let aVal, bVal;
                
                switch(column) {
                    case 'region':
                        aVal = a.region.toLowerCase();
                        bVal = b.region.toLowerCase();
                        break;
                    case 'gmv':
                        aVal = a.gmv;
                        bVal = b.gmv;
                        break;
                    case 'orders':
                        aVal = a.orders;
                        bVal = b.orders;
                        break;
                    case 'delivery':
                        aVal = a.avg_delivery_time;
                        bVal = b.avg_delivery_time;
                        break;
                    case 'retention':
                        aVal = a.retention;
                        bVal = b.retention;
                        break;
                    default:
                        return 0;
                }
                
                if (currentSortDirection === 'asc') {
                    return aVal > bVal ? 1 : -1;
                } else {
                    return aVal < bVal ? 1 : -1;
                }
            });
            
            // Update table
            renderRegionsTable();
            updateSortIndicators();
        }
        
        // Render regions table
        function renderRegionsTable() {
            const tbody = document.querySelector('#top-regions-table tbody');
            tbody.innerHTML = '';
            
            allRegionsData.forEach((region, index) => {
                const row = document.createElement('tr');
                const isTop10 = index < 10;
                
                if (isTop10) {
                    row.style.backgroundColor = 'rgba(0, 155, 213, 0.08)';
                    row.style.borderLeft = '3px solid var(--primary-red)';
                }
                
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td style="font-weight: ${isTop10 ? '600' : '400'}">
                        <a href="#" class="region-link" data-region="${region.region}" style="color: var(--primary-red); text-decoration: none; font-weight: ${isTop10 ? '600' : '500'};">
                            ${region.region}
                        </a>
                    </td>
                    <td>${formatCurrency(region.gmv)}</td>
                    <td>${region.orders.toLocaleString()}</td>
                    <td>${formatTime(region.avg_delivery_time)}</td>
                    <td>${region.retention > 0 ? formatPercent(region.retention) : 'N/A'}</td>
                `;
                
                // Add click handler to region link
                const regionLink = row.querySelector('.region-link');
                if (regionLink) {
                    regionLink.addEventListener('click', function(e) {
                        e.preventDefault();
                        const regionName = this.dataset.region;
                        
                        // Update filter dropdown
                        document.getElementById('region-filter').value = regionName;
                        
                        // Apply filter
                        showMarketData(regionName);
                        
                        // Scroll to Market Performance section
                        const marketSection = document.querySelector('section:has(#region-filter)');
                        if (marketSection) {
                            marketSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        }
                    });
                }
                tbody.appendChild(row);
            });
        }
        
        // Update sort indicators
        function updateSortIndicators() {
            document.querySelectorAll('th.sortable').forEach(th => {
                th.classList.remove('asc', 'desc');
                if (th.dataset.column === currentSortColumn) {
                    th.classList.add(currentSortDirection);
                }
            });
        }
        
        // Add click handlers to sortable headers
        function initializeSortableHeaders() {
            document.querySelectorAll('th.sortable').forEach(th => {
                th.addEventListener('click', () => {
                    sortRegionsTable(th.dataset.column);
                });
            });
        }
        
        // Show market data based on filter
        function showMarketData(regionName) {
            if (regionName === 'all') {
                showTotalMarketMetrics();
                document.getElementById('filter-status').textContent = 'Showing: Total Market';
            } else {
                showRegionalMetrics(regionName);
                document.getElementById('filter-status').textContent = `Showing: ${regionName}`;
            }
        }
        
        // Calculate and show total market metrics
        function showTotalMarketMetrics() {
            const regions = Object.values(dashboardData.regions);
            
            // Aggregate metrics
            let totalOrders = 0;
            let totalFulfillmentSum = 0;
            let totalPrepSum = 0;
            let totalDeliverySum = 0;
            let fastCount = 0;
            let normalCount = 0;
            let slowCount = 0;
            let incompleteCount = 0;
            let lunchFailCount = 0;
            let dinnerFailCount = 0;
            let driverSum = 0;
            
            let totalGMV = 0;
            let netOrderSum = 0;
            let aovSum = 0;
            let tipSum = 0;
            let smallSum = 0;
            let regularSum = 0;
            let largeSum = 0;
            
            let refundSum = 0;
            let veryLongSum = 0;
            let veryShortSum = 0;
            
            regions.forEach(region => {
                const op = region.operational;
                const rev = region.revenue;
                const sat = region.satisfaction;
                const flags = region.flags;
                
                totalOrders++;
                totalFulfillmentSum += op.total_fulfillment_time;
                totalPrepSum += op.prep_time;
                totalDeliverySum += op.delivery_time;
                fastCount += op.fast_pct;
                normalCount += op.normal_pct;
                slowCount += op.slow_pct;
                incompleteCount += op.incomplete_rate;
                lunchFailCount += op.lunch_rush_failure_rate;
                dinnerFailCount += op.dinner_rush_failure_rate;
                driverSum += op.driver_to_order_ratio;
                
                totalGMV += rev.total_gmv;
                netOrderSum += rev.avg_net_order;
                aovSum += rev.aov;
                tipSum += rev.avg_tip_pct;
                smallSum += rev.small_pct;
                regularSum += rev.regular_pct;
                largeSum += rev.large_pct;
                
                refundSum += sat.refund_rate;
                
                veryLongSum += flags.very_long_count;
                veryShortSum += flags.very_short_count;
            });
            
            // Calculate averages
            const avgFulfillment = totalFulfillmentSum / totalOrders;
            const avgPrep = totalPrepSum / totalOrders;
            const avgDelivery = totalDeliverySum / totalOrders;
            const avgFast = fastCount / totalOrders;
            const avgNormal = normalCount / totalOrders;
            const avgSlow = slowCount / totalOrders;
            const avgIncomplete = incompleteCount / totalOrders;
            const avgLunchFail = lunchFailCount / totalOrders;
            const avgDinnerFail = dinnerFailCount / totalOrders;
            const avgDriver = driverSum / totalOrders;
            
            const avgNetOrder = netOrderSum / totalOrders;
            const avgAOV = aovSum / totalOrders;
            const avgTip = tipSum / totalOrders;
            const avgSmall = smallSum / totalOrders;
            const avgRegular = regularSum / totalOrders;
            const avgLarge = largeSum / totalOrders;
            
            const avgRefund = refundSum / totalOrders;
            
            // Update operational metrics
            document.getElementById('total-fulfillment').textContent = formatTime(avgFulfillment);
            document.getElementById('total-fulfillment-diff').textContent = '';
            document.getElementById('prep-time').textContent = formatTime(avgPrep);
            document.getElementById('delivery-time').textContent = formatTime(avgDelivery);
            
            document.getElementById('fast-pct').textContent = formatPercent(avgFast);
            document.getElementById('fast-bar').style.width = avgFast + '%';
            document.getElementById('normal-pct').textContent = formatPercent(avgNormal);
            document.getElementById('normal-bar').style.width = avgNormal + '%';
            document.getElementById('slow-pct').textContent = formatPercent(avgSlow);
            document.getElementById('slow-bar').style.width = avgSlow + '%';
            
            document.getElementById('incomplete-rate').textContent = formatPercent(avgIncomplete);
            document.getElementById('lunch-failure').textContent = formatPercent(avgLunchFail);
            document.getElementById('dinner-failure').textContent = formatPercent(avgDinnerFail);
            document.getElementById('driver-ratio').textContent = avgDriver.toFixed(3);
            
            // Update revenue metrics
            document.getElementById('revenue-gmv').textContent = formatCurrency(totalGMV);
            // Removed avg-net-order metric
            document.getElementById('aov').textContent = formatCurrency(avgAOV);
            document.getElementById('avg-tip').textContent = formatPercent(avgTip);
            
            // Calculate X-Large percentage for total market
            const totalMarketOrderSizes = dashboardData.market_performance.order_sizes;
            
            // Update pie chart with order size distribution
            initializeOrderSizePieChart({
                small: totalMarketOrderSizes.small_pct,
                regular: totalMarketOrderSizes.regular_pct,
                large: totalMarketOrderSizes.large_pct,
                xlarge: totalMarketOrderSizes.xlarge_pct
            });
            
            // Update satisfaction metrics
            document.getElementById('refund-rate').textContent = formatPercent(avgRefund);
            document.getElementById('refund-hour').textContent = 'N/A';
            
            // Update problem spots
            document.getElementById('problem-spots').innerHTML = '<div class="flag-item info"><div class="flag-title">Total Market View</div><div class="flag-value">Select a region to see problem spots</div></div>';
            
            // Update flags
            const flagsContainer = document.getElementById('flags-container');
            flagsContainer.innerHTML = `
                <div class="flag-item warning">
                    <div class="flag-title">Very Long Deliveries (>2 hours)</div>
                    <div class="flag-value">${veryLongSum} deliveries across all markets</div>
                </div>
                <div class="flag-item info">
                    <div class="flag-title">Very Short Deliveries (<5 minutes)</div>
                    <div class="flag-value">${veryShortSum} deliveries across all markets</div>
                </div>
                <div class="flag-item info">
                    <div class="flag-title">Outlier Detection</div>
                    <div class="flag-value">Select a specific region to see restaurant and driver outliers</div>
                </div>
            `;
        }
        
        // Show regional metrics
        function showRegionalMetrics(regionName) {
            const regionData = dashboardData.regions[regionName];
            if (!regionData) return;
            
            const op = regionData.operational;
            const rev = regionData.revenue;
            const sat = regionData.satisfaction;
            const flags = regionData.flags;
            
            // Calculate total market baseline for comparison
            const regions = Object.values(dashboardData.regions);
            const totalMarketFulfillment = regions.reduce((sum, r) => sum + r.operational.total_fulfillment_time, 0) / regions.length;
            
            // Update operational metrics
            const fulfillmentDiff = ((op.total_fulfillment_time - totalMarketFulfillment) / totalMarketFulfillment * 100);
            document.getElementById('total-fulfillment').textContent = formatTime(op.total_fulfillment_time);
            const diffEl = document.getElementById('total-fulfillment-diff');
            diffEl.textContent = (fulfillmentDiff > 0 ? '+' : '') + fulfillmentDiff.toFixed(1) + '% vs market';
            diffEl.className = 'metric-diff ' + (fulfillmentDiff > 0 ? 'negative' : 'positive');
            
            document.getElementById('prep-time').textContent = formatTime(op.prep_time);
            document.getElementById('delivery-time').textContent = formatTime(op.delivery_time);
            
            document.getElementById('fast-pct').textContent = formatPercent(op.fast_pct);
            document.getElementById('fast-bar').style.width = op.fast_pct + '%';
            document.getElementById('normal-pct').textContent = formatPercent(op.normal_pct);
            document.getElementById('normal-bar').style.width = op.normal_pct + '%';
            document.getElementById('slow-pct').textContent = formatPercent(op.slow_pct);
            document.getElementById('slow-bar').style.width = op.slow_pct + '%';
            
            document.getElementById('incomplete-rate').textContent = formatPercent(op.incomplete_rate);
            document.getElementById('lunch-failure').textContent = formatPercent(op.lunch_rush_failure_rate);
            document.getElementById('dinner-failure').textContent = formatPercent(op.dinner_rush_failure_rate);
            document.getElementById('driver-ratio').textContent = op.driver_to_order_ratio.toFixed(3);
            
            // Update revenue metrics
            document.getElementById('revenue-gmv').textContent = formatCurrency(rev.total_gmv);
            // Removed avg-net-order metric
            document.getElementById('aov').textContent = formatCurrency(rev.aov);
            document.getElementById('avg-tip').textContent = formatPercent(rev.avg_tip_pct);
            
            // Update pie chart with order size distribution
            initializeOrderSizePieChart({
                small: rev.small_pct,
                regular: rev.regular_pct,
                large: rev.large_pct,
                xlarge: rev.xlarge_pct || 0
            });
            
            // Update satisfaction metrics
            document.getElementById('refund-rate').textContent = formatPercent(sat.refund_rate);
            document.getElementById('refund-hour').textContent = sat.highest_refund_hour ? sat.highest_refund_hour + ':00' : 'N/A';
            
            // Update problem spots
            const problemSpots = document.getElementById('problem-spots');
            let problemHTML = '';
            
            if (sat.highest_refund_restaurant) {
                problemHTML += `
                    <div class="flag-item warning">
                        <div class="flag-title">Highest Refund Restaurant</div>
                        <div class="flag-value">ID: ${sat.highest_refund_restaurant} (${sat.highest_refund_restaurant_count} refunds)</div>
                    </div>
                `;
            }
            
            if (sat.highest_refund_hour) {
                problemHTML += `
                    <div class="flag-item info">
                        <div class="flag-title">Peak Refund Time</div>
                        <div class="flag-value">${sat.highest_refund_hour}:00 (${sat.highest_refund_hour_count} refunds)</div>
                    </div>
                `;
            }
            
            if (!problemHTML) {
                problemHTML = '<div class="flag-item info"><div class="flag-title">No Issues</div><div class="flag-value">No significant problem spots detected</div></div>';
            }
            
            problemSpots.innerHTML = problemHTML;
            
            // Update flags
            const flagsContainer = document.getElementById('flags-container');
            let flagsHTML = '';
            
            if (flags.very_long_count > 0) {
                flagsHTML += `
                    <div class="flag-item error">
                        <div class="flag-title">Very Long Deliveries (>2 hours)</div>
                        <div class="flag-value">${flags.very_long_count} deliveries (${formatPercent(flags.very_long_pct)})</div>
                    </div>
                `;
            }
            
            if (flags.very_short_count > 0) {
                flagsHTML += `
                    <div class="flag-item warning">
                        <div class="flag-title">Very Short Deliveries (<5 minutes)</div>
                        <div class="flag-value">${flags.very_short_count} deliveries (${formatPercent(flags.very_short_pct)})</div>
                    </div>
                `;
            }
            
            if (flags.restaurant_outlier) {
                flagsHTML += `
                    <div class="flag-item error">
                        <div class="flag-title">Restaurant Outlier Detected</div>
                        <div class="flag-value">Restaurant ID ${flags.restaurant_outlier} has abnormal refund rate (${formatPercent(flags.restaurant_outlier_rate)})</div>
                    </div>
                `;
            }
            
            if (flags.driver_outlier) {
                flagsHTML += `
                    <div class="flag-item error">
                        <div class="flag-title">Driver Outlier Detected</div>
                        <div class="flag-value">Driver ID ${flags.driver_outlier} has abnormal refund rate (${formatPercent(flags.driver_outlier_rate)})</div>
                    </div>
                `;
            }
            
            if (!flagsHTML) {
                flagsHTML = '<div class="flag-item info"><div class="flag-title">No Issues Detected</div><div class="flag-value">All metrics within normal ranges</div></div>';
            }
            
            flagsContainer.innerHTML = flagsHTML;
        }
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', initializeDashboard);

    </script>
</body>
</html>
