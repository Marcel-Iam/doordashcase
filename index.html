<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Performance Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&family=IBM+Plex+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        :root {
            /* Color Palette - White Background with Red/Blue/Orange/Teal */
            --bg-primary: #ffffff;
            --bg-secondary: #f8f9fa;
            --bg-tertiary: #f0f2f5;
            --bg-card: #ffffff;
            
            /* Primary Brand Colors */
            --primary-red: #FF3008;
            --primary-red-dark: #EB1700;
            
            /* Secondary Colors */
            --secondary-blue: rgb(0, 155, 213);      /* #009BD5 */
            --secondary-orange: rgb(248, 106, 52);   /* #F86A34 */
            --secondary-teal: rgb(0, 131, 138);      /* #00838A */
            
            /* Text Colors */
            --text-primary: #191919;
            --text-secondary: #4a5568;
            --text-muted: #718096;
            
            /* Border Colors */
            --border-color: #e2e8f0;
            --border-accent: #cbd5e0;
            
            /* Gradient accents */
            --gradient-red: linear-gradient(135deg, #FF3008, #EB1700);
            --gradient-multi: linear-gradient(135deg, #FF3008, rgb(0, 155, 213), rgb(0, 131, 138));
            --gradient-warm: linear-gradient(135deg, #FF3008, rgb(248, 106, 52));
            
            /* Typography */
            --font-mono: 'JetBrains Mono', monospace;
            --font-sans: 'IBM Plex Sans', system-ui, sans-serif;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: var(--bg-primary);
            background-image: linear-gradient(to bottom right, #ffffff, #f8f9fa);
            color: var(--text-primary);
            font-family: var(--font-sans);
            line-height: 1.6;
            overflow-x: hidden;
        }
        
        /* Animated Background Grid */
        .background-grid {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(90deg, var(--border-color) 1px, transparent 1px),
                linear-gradient(var(--border-color) 1px, transparent 1px);
            background-size: 50px 50px;
            opacity: 0.5;
            z-index: 0;
            pointer-events: none;
        }
        
        .container {
            position: relative;
            z-index: 1;
            max-width: 1600px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        /* Header */
        header {
            margin-bottom: 3rem;
            padding-bottom: 2rem;
            border-bottom: 2px solid var(--border-color);
        }
        
        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            letter-spacing: -0.02em;
            background: var(--gradient-multi);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 2rem;
        }
        
        /* Key Metrics Grid */
        .key-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .key-metric {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            position: relative;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }
        
        .key-metric::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: var(--gradient-warm);
        }
        
        .key-metric-label {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--text-muted);
            font-family: var(--font-mono);
            margin-bottom: 0.5rem;
        }
        
        .key-metric-value {
            font-size: 2rem;
            font-weight: 700;
            font-family: var(--font-mono);
            color: var(--primary-red);
        }
        
        /* Charts Section */
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }
        
        .chart-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            transition: all 0.3s ease;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }
        
        .chart-card:hover {
            border-color: var(--secondary-blue);
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1), 0 4px 8px rgba(0, 155, 213, 0.15);
        }
        
        .chart-title {
            font-size: 1rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        .chart-container {
            position: relative;
            height: 300px;
        }
        
        /* Region Filter */
        .filter-section {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem 1.5rem;
            background: var(--bg-secondary);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--border-accent);
            border-radius: 8px;
        }
        
        .filter-label {
            font-size: 0.875rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-secondary);
        }
        
        select {
            background: var(--bg-card);
            color: var(--text-primary);
            border: 2px solid var(--border-color);
            padding: 0.75rem 1rem;
            border-radius: 6px;
            font-family: var(--font-sans);
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s;
            min-width: 200px;
        }
        
        select:hover {
            border-color: var(--accent-white);
            background: var(--bg-card);
        }
        
        select:focus {
            outline: none;
            border-color: var(--primary-red);
            box-shadow: 0 0 0 3px rgba(255, 48, 8, 0.1);
        }
        
        .filter-status {
            font-size: 0.875rem;
            color: var(--text-muted);
            font-family: var(--font-mono);
            margin-left: auto;
        }
        
        /* Grid Layout */
        .dashboard-grid {
            display: grid;
            gap: 2rem;
            margin-bottom: 2rem;
        }
        
        /* Card Styles */
        .card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }
        
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: var(--gradient-red);
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .card:hover {
            border-color: var(--border-accent);
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
        }
        
        .card:hover::before {
            opacity: 1;
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        .card-title {
            font-size: 1rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-secondary);
        }
        
        .card-badge {
            font-size: 0.75rem;
            font-family: var(--font-mono);
            padding: 0.25rem 0.75rem;
            border-radius: 4px;
            background: var(--bg-tertiary);
            color: var(--accent-red);
            border: 1px solid var(--border-accent);
        }
        
        /* Metric Display */
        .metric-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
        }
        
        .metric {
            padding: 1rem;
            background: var(--bg-secondary);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }
        
        .metric-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.5rem;
        }
        
        .metric-value {
            font-size: 1.75rem;
            font-weight: 700;
            font-family: var(--font-mono);
            color: var(--primary-red);
        }
        
        .metric-diff {
            font-size: 0.875rem;
            font-family: var(--font-mono);
            margin-top: 0.25rem;
        }
        
        .metric-diff.positive {
            color: var(--accent-white);
        }
        
        .metric-diff.negative {
            color: var(--accent-red-bright);
        }
        
        /* Table Styles */
        .table-container {
            overflow-x: auto;
            max-height: 500px;
            overflow-y: auto;
            margin-top: 1rem;
            border: 1px solid var(--border-color);
            border-radius: 8px;
        }
        
        .table-container::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        .table-container::-webkit-scrollbar-track {
            background: var(--bg-secondary);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }
        
        .table-container::-webkit-scrollbar-thumb {
            background: var(--secondary-blue);
            border-radius: 4px;
        }
        
        .table-container::-webkit-scrollbar-thumb:hover {
            background: var(--primary-red);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }
        
        thead {
            background: var(--bg-secondary);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }
        
        th {
            text-align: left;
            padding: 0.75rem 1rem;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            font-size: 0.75rem;
            letter-spacing: 0.05em;
            border-bottom: 2px solid var(--border-accent);
        }
        
        td {
            padding: 0.75rem 1rem;
            border-bottom: 1px solid var(--border-color);
            font-family: var(--font-mono);
            font-size: 0.875rem;
        }
        
        tr:hover td {
            background: var(--bg-secondary);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }
        
        /* Progress Bars */
        .progress-bar {
            height: 6px;
            background: var(--bg-tertiary);
            border-radius: 3px;
            overflow: hidden;
            margin-top: 0.5rem;
        }
        
        .progress-fill {
            height: 100%;
            background: var(--gradient-red);
            transition: width 0.3s ease;
        }
        
        /* Flags and Warnings */
        .flag-item {
            padding: 1rem;
            background: var(--bg-secondary);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            border-left: 3px solid var(--accent-red-bright);
            border-radius: 6px;
            margin-bottom: 0.75rem;
        }
        
        .flag-item.error {
            border-left-color: var(--accent-red-bright);
        }
        
        .flag-item.warning {
            border-left-color: var(--accent-red-bright);
        }
        
        .flag-item.info {
            border-left-color: var(--accent-red-bright);
        }
        
        .flag-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
            color: var(--text-primary);
        }
        
        .flag-value {
            font-family: var(--font-mono);
            font-size: 0.875rem;
            color: var(--text-secondary);
        }
        
        /* Section Dividers */
        .section-divider {
            margin: 3rem 0 2rem;
            text-align: left;
        }
        
        .section-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }
        
        .section-subtitle {
            font-size: 0.875rem;
            color: var(--text-muted);
        }
        

        
        th.sortable {
            cursor: pointer;
            user-select: none;
            position: relative;
            padding-right: 1.5rem;
        }
        
        th.sortable:hover {
            color: var(--primary-red);
        }
        
        th.sortable::after {
            content: '⇅';
            position: absolute;
            right: 0.5rem;
            opacity: 0.3;
            font-size: 0.875rem;
        }
        
        th.sortable.asc::after {
            content: '↑';
            opacity: 1;
            color: var(--secondary-teal);
        }
        
        th.sortable.desc::after {
            content: '↓';
            opacity: 1;
            color: var(--accent-red);
        }
        
        
        /* Three-fold metrics layout */
        .metrics-three-col {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 2rem;
            margin-bottom: 2rem;
        }
        
        @media (max-width: 1200px) {
            .metrics-three-col {
                grid-template-columns: 1fr;
            }
        }
        
        /* Pie chart container */
        .pie-chart-container {
            position: relative;
            height: 350px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
                /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }
            
            h1 {
                font-size: 1.75rem;
            }
            
            .key-metrics {
                grid-template-columns: 1fr;
            }
            
            .charts-grid {
                grid-template-columns: 1fr;
            }
            
            .metric-grid {
                grid-template-columns: 1fr;
            }
        }
    
        
        /* Enhanced visual effects */
        .key-metric {
            transition: all 0.3s ease;
        }
        
        .key-metric:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 48, 8, 0.15), 0 2px 6px rgba(0, 155, 213, 0.1);
        }
        
        .chart-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: var(--gradient-red);
            opacity: 0.5;
        }
        
        /* Progress bar enhancement */
        .progress-fill {
            background: var(--gradient-warm);
        }
        
        /* Glow effect on hover for cards */
        .card:hover {
            box-shadow: 0 8px 24px rgba(255, 48, 8, 0.15), 0 4px 8px rgba(0, 155, 213, 0.1);
        }
    
        
        .region-link:hover {
            text-decoration: underline !important;
            color: var(--primary-red-dark) !important;
        }
        
        /* Tier Badge Styles */
        .tier-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .tier-super {
            background: linear-gradient(135deg, #00D084, #00A86B);
            color: white;
        }
        
        .tier-elite {
            background: linear-gradient(135deg, rgb(0, 155, 213), rgb(0, 131, 138));
            color: white;
        }
        
        .tier-average {
            background: linear-gradient(135deg, rgb(248, 106, 52), #FF8C42);
            color: white;
        }
        
        .tier-poor {
            background: linear-gradient(135deg, #FF3008, #EB1700);
            color: white;
        }
        
        .tier-n\/a {
            background: #e2e8f0;
            color: #718096;
        }
    </style>
</head>
<body>
    <div class="background-grid"></div>
    
    <div class="container">
        <!-- Header -->
        <header>
            <h1>Performance Dashboard</h1>
            <p style="color: var(--text-muted); font-size: 0.875rem; margin-top: -1rem; margin-bottom: 1.5rem; font-family: var(--font-mono);">
                By: Marcel Iam
            </p>
            
            <!-- Key Metrics -->
            <div class="key-metrics">
                <div class="key-metric">
                    <div class="key-metric-label">Total GMV</div>
                    <div class="key-metric-value" id="header-gmv">$0</div>
                </div>
                <div class="key-metric">
                    <div class="key-metric-label">Total Orders</div>
                    <div class="key-metric-value" id="header-orders">0</div>
                </div>
                <div class="key-metric">
                    <div class="key-metric-label">Average Order Value</div>
                    <div class="key-metric-value" id="header-aov">$0</div>
                </div>
            </div>
            
            <!-- Charts -->
            <div class="charts-grid">
                <div class="chart-card">
                    <h3 class="chart-title">Orders by Weekday</h3>
                    <div class="chart-container">
                        <canvas id="weekdayChart"></canvas>
                    </div>
                </div>
                <div class="chart-card">
                    <h3 class="chart-title">Orders by Hour of Day</h3>
                    <div class="chart-container">
                        <canvas id="hourlyChart"></canvas>
                    </div>
                </div>
            </div>
            

        </header>
        
                <!-- Regions Overview Section -->
        <section>
            <div class="section-divider">
                <h2 class="section-title">Regions Overview</h2>
                <p class="section-subtitle">All 50 regions - Top 10 highlighted in blue - Click region names to filter or sort by columns</p>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">All Regions (Top 10 Highlighted)</h3>
                    <span class="card-badge">GLOBAL</span>
                </div>
                <div class="table-container">
                    <table id="top-regions-table">
                        <thead>
                            <tr>
                                <th>Rank</th>
                                <th class="sortable" data-column="region">Region</th>
                                <th class="sortable" data-column="gmv">GMV</th>
                                <th class="sortable" data-column="orders">Orders</th>
                                <th class="sortable" data-column="delivery">Avg Delivery</th>
                                <th class="sortable" data-column="tier">Performance Tier</th>
                                <th class="sortable" data-column="retention">Retention</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </section>
        
                <!-- Market Performance Section -->
        <section>
            <div class="section-divider">
                <h2 class="section-title">Market Performance</h2>
                <p class="section-subtitle">Select a region to view detailed metrics</p>
            </div>
            
            <!-- Filter Section -->
            <div class="filter-section">
                <span class="filter-label">Filter by Region:</span>
                <select id="region-filter">
                    <option value="all">All Markets (Total)</option>
                </select>
                <span class="filter-status" id="filter-status">Showing: Total Market</span>
            </div>
        </section>
        
        <!-- Performance Metrics Section -->
        <section>
            <div class="section-divider">
                <h2 class="section-title">Performance Metrics</h2>
                <p class="section-subtitle">Revenue, operational, and satisfaction metrics</p>
            </div>
            
            <div class="metrics-three-col">
                <!-- Column 1: Revenue Performance -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Revenue Performance</h3>
                    </div>
                    <div class="metric-grid">
                        <div class="metric">
                            <div class="metric-label">Total GMV</div>
                            <div class="metric-value" id="revenue-gmv">-</div>
                        </div>
                        <div class="metric">
                            <div class="metric-label">AOV</div>
                            <div class="metric-value" id="aov">-</div>
                        </div>
                        <div class="metric">
                            <div class="metric-label">Avg Tip %</div>
                            <div class="metric-value" id="avg-tip">-</div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 2rem;">
                        <div class="card-header" style="margin-bottom: 1rem; padding-bottom: 0.5rem;">
                            <h3 class="card-title" style="font-size: 0.875rem;">Order Size Distribution</h3>
                        </div>
                        <div class="pie-chart-container">
                            <canvas id="orderSizePieChart"></canvas>
                        </div>
                        <div class="metric" style="margin-top: 1.5rem; text-align: center;">
                            <div class="metric-label">Total Orders</div>
                            <div class="metric-value" id="total-orders">-</div>
                        </div>
                    </div>
                </div>
                
                <!-- Column 2: Operational Metrics -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Operational Performance</h3>
                    </div>
                    
                    <!-- Total Fulfillment Time (Full Width) -->
                    <div class="metric" style="margin-bottom: 1.5rem;">
                        <div class="metric-label">Total Fulfillment Time</div>
                        <div class="metric-value" id="total-fulfillment">-</div>
                        <div class="metric-diff" id="total-fulfillment-diff"></div>
                    </div>
                    
                    <!-- Prep Time and Delivery Time (Side by Side) -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem;">
                        <div class="metric">
                            <div class="metric-label">Restaurant Prep Time</div>
                            <div class="metric-value" id="prep-time">-</div>
                        </div>
                        <div class="metric">
                            <div class="metric-label">Delivery Time</div>
                            <div class="metric-value" id="delivery-time">-</div>
                        </div>
                    </div>
                    
                    <!-- Speed Categories -->
                    <div style="margin-top: 1.5rem;">
                        <div style="margin-bottom: 1rem;">
                            <div class="metric-label">Speed Categories</div>
                        </div>
                        <div class="metric" style="margin-bottom: 0.75rem;">
                            <div class="metric-label">Fast (<20min)</div>
                            <div class="metric-value" id="fast-pct" style="font-size: 1.25rem;">-</div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="fast-bar"></div>
                            </div>
                        </div>
                        <div class="metric" style="margin-bottom: 0.75rem;">
                            <div class="metric-label">Normal (20-35min)</div>
                            <div class="metric-value" id="normal-pct" style="font-size: 1.25rem;">-</div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="normal-bar"></div>
                            </div>
                        </div>
                        <div class="metric">
                            <div class="metric-label">Slow (>35min)</div>
                            <div class="metric-value" id="slow-pct" style="font-size: 1.25rem;">-</div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="slow-bar"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Column 3: Driver Performance -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Driver Performance</h3>
                    </div>
                    <div class="metric-grid" style="grid-template-columns: 1fr;">
                        <div class="metric">
                            <div class="metric-label">Total Drivers</div>
                            <div class="metric-value" id="total-drivers">-</div>
                        </div>
                        <div class="metric">
                            <div class="metric-label">Driver/Order Ratio</div>
                            <div class="metric-value" id="driver-order-ratio">-</div>
                        </div>
                    </div>
                    
                    <!-- Driver Distribution Pie Chart -->
                    <div style="margin-top: 2rem;">
                        <div class="card-header" style="margin-bottom: 1rem; padding-bottom: 0.5rem;">
                            <h3 class="card-title" style="font-size: 0.875rem;">Driver Distribution</h3>
                        </div>
                        <div class="pie-chart-container">
                            <canvas id="driverTierPieChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Flags and Errors Section -->
        <section>
            <div class="section-divider">
                <h2 class="section-title">Flags & Errors</h2>
                <p class="section-subtitle">Data quality and operational anomalies</p>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Problem Spots</h3>
                </div>
                <div id="flags-container">
                    <!-- Dynamically populated -->
                </div>
            </div>
        </section>
    </div>
    
    <script>
        // Dashboard data will be embedded here
        
        // Embedded dashboard data
        const dashboardData = {
        "market_performance": {
                "total_gmv": 703095.91,
                "total_orders": 19813,
                "total_aov": 35.49,
                "peak_day": "Sunday",
                "peak_day_count": 3294,
                "peak_hour": 18,
                "peak_hour_count": 1879,
                "operational": {
                        "total_fulfillment_time": 30.84,
                        "prep_time": 13.41,
                        "delivery_time": 16.09,
                        "fast_pct": 26.87,
                        "normal_pct": 44.95,
                        "slow_pct": 26.83,
                        "driver_to_order_ratio": 0.475
                },
                "revenue": {
                        "total_gmv": 703095.91,
                        "aov": 35.49,
                        "avg_tip_pct": 10.22,
                        "small_pct": 15.71,
                        "medium_pct": 44.34,
                        "large_pct": 20.39,
                        "xlarge_pct": 15.68,
                        "catering_pct": 1.72
                },
                "satisfaction": {
                        "refund_rate": 1.38,
                        "highest_refund_hour": 17,
                        "highest_refund_hour_count": 31,
                        "highest_refund_restaurant": 537034,
                        "highest_refund_restaurant_rate": 10.0,
                        "highest_refund_restaurant_count": 1
                },
                "driver_tiers": {
                        "fulltime_count": 70,
                        "parttime_count": 403,
                        "occasional_count": 8932,
                        "fulltime_pct": 0.74,
                        "parttime_pct": 4.28,
                        "occasional_pct": 94.97
                },
                "order_sizes": {
                        "small_pct": 15.71,
                        "medium_pct": 44.34,
                        "large_pct": 20.39,
                        "xlarge_pct": 15.68,
                        "catering_pct": 1.72
                },
                "outliers": {
                        "driver_outliers": [
                                {
                                        "id": 9842768,
                                        "rate": 27.27,
                                        "refund_count": 3,
                                        "total_orders": 11,
                                        "regions": [
                                                "Scranton"
                                        ]
                                },
                                {
                                        "id": 31828425,
                                        "rate": 23.81,
                                        "refund_count": 5,
                                        "total_orders": 21,
                                        "regions": [
                                                "Scranton"
                                        ]
                                },
                                {
                                        "id": 14679175,
                                        "rate": 20.0,
                                        "refund_count": 2,
                                        "total_orders": 10,
                                        "regions": [
                                                "Scranton"
                                        ]
                                }
                        ],
                        "restaurant_outliers": [
                                {
                                        "id": 537034,
                                        "rate": 10.0,
                                        "refund_count": 1,
                                        "total_orders": 10,
                                        "regions": [
                                                "Calgary"
                                        ]
                                },
                                {
                                        "id": 27971896,
                                        "rate": 7.69,
                                        "refund_count": 1,
                                        "total_orders": 13,
                                        "regions": [
                                                "Baltimore"
                                        ]
                                },
                                {
                                        "id": 690495,
                                        "rate": 2.28,
                                        "refund_count": 71,
                                        "total_orders": 3113,
                                        "regions": [
                                                "Scranton"
                                        ]
                                }
                        ]
                },
                "top_10_regions": [
                        {
                                "rank": 1,
                                "region": "San Francisco",
                                "gmv": 112394.18,
                                "gmv_pct": 15.99,
                                "orders": 3077,
                                "order_pct": 15.53,
                                "avg_delivery_time": 29.62,
                                "retention": 22.61,
                                "performance_tier": "Average"
                        },
                        {
                                "rank": 2,
                                "region": "Scranton",
                                "gmv": 91475.11,
                                "gmv_pct": 13.01,
                                "orders": 3220,
                                "order_pct": 16.25,
                                "avg_delivery_time": 23.71,
                                "retention": 38.81,
                                "performance_tier": "Elite"
                        },
                        {
                                "rank": 3,
                                "region": "Orange County",
                                "gmv": 48432.71,
                                "gmv_pct": 6.89,
                                "orders": 1263,
                                "order_pct": 6.37,
                                "avg_delivery_time": 22.48,
                                "retention": 22.49,
                                "performance_tier": "Elite"
                        },
                        {
                                "rank": 4,
                                "region": "Dallas",
                                "gmv": 37136.17,
                                "gmv_pct": 5.28,
                                "orders": 794,
                                "order_pct": 4.01,
                                "avg_delivery_time": 41.17,
                                "retention": 18.94,
                                "performance_tier": "Poor"
                        },
                        {
                                "rank": 5,
                                "region": "San Antonio",
                                "gmv": 32234.62,
                                "gmv_pct": 4.58,
                                "orders": 774,
                                "order_pct": 3.91,
                                "avg_delivery_time": 44.46,
                                "retention": 17.65,
                                "performance_tier": "Poor"
                        },
                        {
                                "rank": 6,
                                "region": "Traverse City, MI",
                                "gmv": 32196.73,
                                "gmv_pct": 4.58,
                                "orders": 643,
                                "order_pct": 3.25,
                                "avg_delivery_time": 37.02,
                                "retention": 20.17,
                                "performance_tier": "Poor"
                        },
                        {
                                "rank": 7,
                                "region": "Bellevue",
                                "gmv": 29737.83,
                                "gmv_pct": 4.23,
                                "orders": 767,
                                "order_pct": 3.87,
                                "avg_delivery_time": 45.15,
                                "retention": 28.27,
                                "performance_tier": "Poor"
                        },
                        {
                                "rank": 8,
                                "region": "Central Jersey",
                                "gmv": 29672.32,
                                "gmv_pct": 4.22,
                                "orders": 1000,
                                "order_pct": 5.05,
                                "avg_delivery_time": 25.44,
                                "retention": 25.51,
                                "performance_tier": "Average"
                        },
                        {
                                "rank": 9,
                                "region": "Muncie, IN",
                                "gmv": 22551.12,
                                "gmv_pct": 3.21,
                                "orders": 641,
                                "order_pct": 3.24,
                                "avg_delivery_time": 31.03,
                                "retention": 18.24,
                                "performance_tier": "Average"
                        },
                        {
                                "rank": 10,
                                "region": "Minneapolis",
                                "gmv": 20728.63,
                                "gmv_pct": 2.95,
                                "orders": 711,
                                "order_pct": 3.59,
                                "avg_delivery_time": 25.98,
                                "retention": 21.64,
                                "performance_tier": "Average"
                        }
                ],
                "weekday_stats": [
                        {
                                "day": "Monday",
                                "orders": 2818,
                                "gmv": 96886.97,
                                "avg_fulfillment": 30.41
                        },
                        {
                                "day": "Tuesday",
                                "orders": 2525,
                                "gmv": 83566.69,
                                "avg_fulfillment": 29.54
                        },
                        {
                                "day": "Wednesday",
                                "orders": 2420,
                                "gmv": 83133.41,
                                "avg_fulfillment": 29.79
                        },
                        {
                                "day": "Thursday",
                                "orders": 2540,
                                "gmv": 90047.74,
                                "avg_fulfillment": 29.85
                        },
                        {
                                "day": "Friday",
                                "orders": 2932,
                                "gmv": 107235.64,
                                "avg_fulfillment": 34.76
                        },
                        {
                                "day": "Saturday",
                                "orders": 3284,
                                "gmv": 122805.16,
                                "avg_fulfillment": 30.22
                        },
                        {
                                "day": "Sunday",
                                "orders": 3294,
                                "gmv": 119420.3,
                                "avg_fulfillment": 30.89
                        }
                ],
                "hourly_stats": [
                        {
                                "hour": 0,
                                "orders": 336,
                                "gmv": 10602.9,
                                "avg_fulfillment": 28.68
                        },
                        {
                                "hour": 1,
                                "orders": 239,
                                "gmv": 6334.04,
                                "avg_fulfillment": 26.1
                        },
                        {
                                "hour": 2,
                                "orders": 100,
                                "gmv": 2552.17,
                                "avg_fulfillment": 33.99
                        },
                        {
                                "hour": 3,
                                "orders": 22,
                                "gmv": 627.88,
                                "avg_fulfillment": 35.21
                        },
                        {
                                "hour": 4,
                                "orders": 74,
                                "gmv": 1927.44,
                                "avg_fulfillment": 39.5
                        },
                        {
                                "hour": 5,
                                "orders": 42,
                                "gmv": 1086.67,
                                "avg_fulfillment": 37.3
                        },
                        {
                                "hour": 6,
                                "orders": 186,
                                "gmv": 4768.73,
                                "avg_fulfillment": 33.73
                        },
                        {
                                "hour": 7,
                                "orders": 299,
                                "gmv": 7729.97,
                                "avg_fulfillment": 30.72
                        },
                        {
                                "hour": 8,
                                "orders": 594,
                                "gmv": 15827.11,
                                "avg_fulfillment": 25.88
                        },
                        {
                                "hour": 9,
                                "orders": 785,
                                "gmv": 21300.28,
                                "avg_fulfillment": 27.24
                        },
                        {
                                "hour": 10,
                                "orders": 993,
                                "gmv": 29017.31,
                                "avg_fulfillment": 27.15
                        },
                        {
                                "hour": 11,
                                "orders": 1332,
                                "gmv": 42983.04,
                                "avg_fulfillment": 28.82
                        },
                        {
                                "hour": 12,
                                "orders": 1309,
                                "gmv": 42840.51,
                                "avg_fulfillment": 28.15
                        },
                        {
                                "hour": 13,
                                "orders": 1033,
                                "gmv": 34224.49,
                                "avg_fulfillment": 28.09
                        },
                        {
                                "hour": 14,
                                "orders": 954,
                                "gmv": 32095.61,
                                "avg_fulfillment": 32.23
                        },
                        {
                                "hour": 15,
                                "orders": 1044,
                                "gmv": 37772.7,
                                "avg_fulfillment": 32.18
                        },
                        {
                                "hour": 16,
                                "orders": 1407,
                                "gmv": 57143.81,
                                "avg_fulfillment": 31.94
                        },
                        {
                                "hour": 17,
                                "orders": 1837,
                                "gmv": 80962.81,
                                "avg_fulfillment": 32.45
                        },
                        {
                                "hour": 18,
                                "orders": 1879,
                                "gmv": 81279.74,
                                "avg_fulfillment": 37.84
                        },
                        {
                                "hour": 19,
                                "orders": 1790,
                                "gmv": 71948.49,
                                "avg_fulfillment": 32.37
                        },
                        {
                                "hour": 20,
                                "orders": 1322,
                                "gmv": 48536.77,
                                "avg_fulfillment": 30.02
                        },
                        {
                                "hour": 21,
                                "orders": 965,
                                "gmv": 32572.7,
                                "avg_fulfillment": 30.38
                        },
                        {
                                "hour": 22,
                                "orders": 699,
                                "gmv": 21684.09,
                                "avg_fulfillment": 27.83
                        },
                        {
                                "hour": 23,
                                "orders": 572,
                                "gmv": 17276.65,
                                "avg_fulfillment": 29.02
                        }
                ],
                "all_regions": [
                        {
                                "region": "San Francisco",
                                "gmv": 112394.18,
                                "orders": 3077,
                                "avg_delivery_time": 29.62,
                                "performance_tier": "Average",
                                "retention": 22.61
                        },
                        {
                                "region": "Dallas",
                                "gmv": 37136.17,
                                "orders": 794,
                                "avg_delivery_time": 41.17,
                                "performance_tier": "Poor",
                                "retention": 18.94
                        },
                        {
                                "region": "Florence, SC",
                                "gmv": 455.28,
                                "orders": 13,
                                "avg_delivery_time": 37.98,
                                "performance_tier": "Poor",
                                "retention": 18.18
                        },
                        {
                                "region": "Scranton",
                                "gmv": 91475.11,
                                "orders": 3220,
                                "avg_delivery_time": 23.71,
                                "performance_tier": "Elite",
                                "retention": 38.81
                        },
                        {
                                "region": "Chicago",
                                "gmv": 12298.09,
                                "orders": 215,
                                "avg_delivery_time": 35.97,
                                "performance_tier": "Poor",
                                "retention": 9.5
                        },
                        {
                                "region": "Traverse City, MI",
                                "gmv": 32196.73,
                                "orders": 643,
                                "avg_delivery_time": 37.02,
                                "performance_tier": "Poor",
                                "retention": 20.17
                        },
                        {
                                "region": "Calgary",
                                "gmv": 420.11,
                                "orders": 10,
                                "avg_delivery_time": 41.33,
                                "performance_tier": "Poor",
                                "retention": 0.0
                        },
                        {
                                "region": "Oak Harbor, WA",
                                "gmv": 5291.06,
                                "orders": 151,
                                "avg_delivery_time": 25.78,
                                "performance_tier": "Average",
                                "retention": 26.17
                        },
                        {
                                "region": "Lufkin, TX",
                                "gmv": 1634.35,
                                "orders": 53,
                                "avg_delivery_time": 24.55,
                                "performance_tier": "Elite",
                                "retention": 37.04
                        },
                        {
                                "region": "Sacramento",
                                "gmv": 17219.19,
                                "orders": 249,
                                "avg_delivery_time": 41.45,
                                "performance_tier": "Poor",
                                "retention": 13.37
                        },
                        {
                                "region": "Hamilton",
                                "gmv": 3613.97,
                                "orders": 161,
                                "avg_delivery_time": 26.68,
                                "performance_tier": "Average",
                                "retention": 17.89
                        },
                        {
                                "region": "South Bay",
                                "gmv": 10690.07,
                                "orders": 162,
                                "avg_delivery_time": 48.27,
                                "performance_tier": "Poor",
                                "retention": 16.53
                        },
                        {
                                "region": "Lake Tahoe, CA",
                                "gmv": 12266.12,
                                "orders": 218,
                                "avg_delivery_time": 30.35,
                                "performance_tier": "Average",
                                "retention": 19.51
                        },
                        {
                                "region": "Bellevue",
                                "gmv": 29737.83,
                                "orders": 767,
                                "avg_delivery_time": 45.15,
                                "performance_tier": "Poor",
                                "retention": 28.27
                        },
                        {
                                "region": "Rochester",
                                "gmv": 1997.1,
                                "orders": 41,
                                "avg_delivery_time": 32.49,
                                "performance_tier": "Average",
                                "retention": 20.69
                        },
                        {
                                "region": "Baltimore",
                                "gmv": 586.49,
                                "orders": 13,
                                "avg_delivery_time": 35.88,
                                "performance_tier": "Poor",
                                "retention": 18.18
                        },
                        {
                                "region": "Lubbock",
                                "gmv": 17237.98,
                                "orders": 709,
                                "avg_delivery_time": 19.91,
                                "performance_tier": "Super",
                                "retention": 33.51
                        },
                        {
                                "region": "Port St. Lucie",
                                "gmv": 319.36,
                                "orders": 11,
                                "avg_delivery_time": 28.0,
                                "performance_tier": "Average",
                                "retention": 25.0
                        },
                        {
                                "region": "Buffalo",
                                "gmv": 4682.68,
                                "orders": 179,
                                "avg_delivery_time": 20.21,
                                "performance_tier": "Elite",
                                "retention": 22.66
                        },
                        {
                                "region": "Lakeland",
                                "gmv": 11300.33,
                                "orders": 427,
                                "avg_delivery_time": 31.86,
                                "performance_tier": "Average",
                                "retention": 16.76
                        },
                        {
                                "region": "Hartford",
                                "gmv": 7981.0,
                                "orders": 151,
                                "avg_delivery_time": 38.86,
                                "performance_tier": "Poor",
                                "retention": 13.08
                        },
                        {
                                "region": "Bakersfield",
                                "gmv": 3650.6,
                                "orders": 69,
                                "avg_delivery_time": 114.8,
                                "performance_tier": "Poor",
                                "retention": 11.67
                        },
                        {
                                "region": "Windsor",
                                "gmv": 4172.19,
                                "orders": 142,
                                "avg_delivery_time": 31.59,
                                "performance_tier": "Average",
                                "retention": 15.32
                        },
                        {
                                "region": "LA Valley",
                                "gmv": 658.91,
                                "orders": 28,
                                "avg_delivery_time": 38.07,
                                "performance_tier": "Poor",
                                "retention": 25.0
                        },
                        {
                                "region": "Auckland",
                                "gmv": 1030.47,
                                "orders": 38,
                                "avg_delivery_time": 33.39,
                                "performance_tier": "Average",
                                "retention": 9.38
                        },
                        {
                                "region": "Vernon, BC",
                                "gmv": 2590.89,
                                "orders": 80,
                                "avg_delivery_time": 27.87,
                                "performance_tier": "Average",
                                "retention": 20.63
                        },
                        {
                                "region": "Brooklyn",
                                "gmv": 13408.1,
                                "orders": 337,
                                "avg_delivery_time": 37.69,
                                "performance_tier": "Poor",
                                "retention": 20.65
                        },
                        {
                                "region": "Denver/Boulder",
                                "gmv": 14001.93,
                                "orders": 311,
                                "avg_delivery_time": 29.84,
                                "performance_tier": "Average",
                                "retention": 12.22
                        },
                        {
                                "region": "Winnipeg",
                                "gmv": 5220.56,
                                "orders": 191,
                                "avg_delivery_time": 21.17,
                                "performance_tier": "Elite",
                                "retention": 26.62
                        },
                        {
                                "region": "Minneapolis",
                                "gmv": 20728.63,
                                "orders": 711,
                                "avg_delivery_time": 25.98,
                                "performance_tier": "Average",
                                "retention": 21.64
                        },
                        {
                                "region": "Orange County",
                                "gmv": 48432.71,
                                "orders": 1263,
                                "avg_delivery_time": 22.48,
                                "performance_tier": "Elite",
                                "retention": 22.49
                        },
                        {
                                "region": "Central Jersey",
                                "gmv": 29672.32,
                                "orders": 1000,
                                "avg_delivery_time": 25.44,
                                "performance_tier": "Average",
                                "retention": 25.51
                        },
                        {
                                "region": "Albany",
                                "gmv": 61.29,
                                "orders": 2,
                                "avg_delivery_time": 56.24,
                                "performance_tier": "Poor",
                                "retention": 0.0
                        },
                        {
                                "region": "Medford, OR",
                                "gmv": 1589.17,
                                "orders": 41,
                                "avg_delivery_time": 31.71,
                                "performance_tier": "Average",
                                "retention": 2.5
                        },
                        {
                                "region": "Whistler, BC",
                                "gmv": 11810.02,
                                "orders": 560,
                                "avg_delivery_time": 20.9,
                                "performance_tier": "Elite",
                                "retention": 42.05
                        },
                        {
                                "region": "Northern Virginia",
                                "gmv": 4784.63,
                                "orders": 169,
                                "avg_delivery_time": 40.91,
                                "performance_tier": "Poor",
                                "retention": 21.54
                        },
                        {
                                "region": "Perth",
                                "gmv": 227.0,
                                "orders": 10,
                                "avg_delivery_time": 18.64,
                                "performance_tier": "Super",
                                "retention": 25.0
                        },
                        {
                                "region": "Nashville",
                                "gmv": 17008.6,
                                "orders": 483,
                                "avg_delivery_time": 32.64,
                                "performance_tier": "Average",
                                "retention": 27.82
                        },
                        {
                                "region": "Cedar Rapids",
                                "gmv": 2730.16,
                                "orders": 56,
                                "avg_delivery_time": 38.23,
                                "performance_tier": "Poor",
                                "retention": 14.89
                        },
                        {
                                "region": "San Antonio",
                                "gmv": 32234.62,
                                "orders": 774,
                                "avg_delivery_time": 44.46,
                                "performance_tier": "Poor",
                                "retention": 17.65
                        },
                        {
                                "region": "Rapid City, SD",
                                "gmv": 8281.21,
                                "orders": 242,
                                "avg_delivery_time": 24.67,
                                "performance_tier": "Elite",
                                "retention": 26.35
                        },
                        {
                                "region": "Muncie, IN",
                                "gmv": 22551.12,
                                "orders": 641,
                                "avg_delivery_time": 31.03,
                                "performance_tier": "Average",
                                "retention": 18.24
                        },
                        {
                                "region": "Regina",
                                "gmv": 2289.98,
                                "orders": 98,
                                "avg_delivery_time": 41.67,
                                "performance_tier": "Poor",
                                "retention": 21.54
                        },
                        {
                                "region": "Los Angeles",
                                "gmv": 371.51,
                                "orders": 12,
                                "avg_delivery_time": 33.98,
                                "performance_tier": "Average",
                                "retention": 12.5
                        },
                        {
                                "region": "South Texas",
                                "gmv": 7938.5,
                                "orders": 293,
                                "avg_delivery_time": 45.66,
                                "performance_tier": "Poor",
                                "retention": 30.25
                        },
                        {
                                "region": "Portland",
                                "gmv": 2270.86,
                                "orders": 39,
                                "avg_delivery_time": 278.61,
                                "performance_tier": "Poor",
                                "retention": 5.41
                        },
                        {
                                "region": "Cincinnati",
                                "gmv": 5704.78,
                                "orders": 150,
                                "avg_delivery_time": 33.15,
                                "performance_tier": "Average",
                                "retention": 20.54
                        },
                        {
                                "region": "Philadelphia",
                                "gmv": 20598.79,
                                "orders": 455,
                                "avg_delivery_time": 33.4,
                                "performance_tier": "Average",
                                "retention": 20.29
                        },
                        {
                                "region": "Boston",
                                "gmv": 6526.37,
                                "orders": 290,
                                "avg_delivery_time": 18.73,
                                "performance_tier": "Super",
                                "retention": 42.98
                        },
                        {
                                "region": "North Jersey",
                                "gmv": 1616.79,
                                "orders": 64,
                                "avg_delivery_time": 35.46,
                                "performance_tier": "Poor",
                                "retention": 31.71
                        }
                ]
        },
        "regions": {
                "San Francisco": {
                        "operational": {
                                "total_fulfillment_time": 29.62,
                                "prep_time": 11.85,
                                "delivery_time": 16.44,
                                "fast_pct": 20.7,
                                "normal_pct": 56.22,
                                "slow_pct": 22.62,
                                "driver_to_order_ratio": 0.368
                        },
                        "revenue": {
                                "total_gmv": 112394.18,
                                "aov": 36.53,
                                "avg_tip_pct": 11.43,
                                "small_pct": 7.83,
                                "medium_pct": 49.43,
                                "large_pct": 24.93,
                                "xlarge_pct": 16.28,
                                "catering_pct": 0.81
                        },
                        "satisfaction": {
                                "refund_rate": 1.04,
                                "highest_refund_hour": 15,
                                "highest_refund_hour_count": 5,
                                "highest_refund_restaurant": 11000,
                                "highest_refund_restaurant_rate": 1.04,
                                "highest_refund_restaurant_count": 32
                        },
                        "driver_tiers": {
                                "fulltime_count": 19,
                                "parttime_count": 57,
                                "occasional_count": 1056,
                                "fulltime_pct": 1.68,
                                "parttime_pct": 5.04,
                                "occasional_pct": 93.29
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Dallas": {
                        "operational": {
                                "total_fulfillment_time": 41.17,
                                "prep_time": 20.54,
                                "delivery_time": 20.59,
                                "fast_pct": 1.13,
                                "normal_pct": 34.63,
                                "slow_pct": 58.82,
                                "driver_to_order_ratio": 0.664
                        },
                        "revenue": {
                                "total_gmv": 37136.17,
                                "aov": 46.77,
                                "avg_tip_pct": 10.8,
                                "small_pct": 3.78,
                                "medium_pct": 31.86,
                                "large_pct": 21.91,
                                "xlarge_pct": 31.23,
                                "catering_pct": 5.67
                        },
                        "satisfaction": {
                                "refund_rate": 1.76,
                                "highest_refund_hour": 17,
                                "highest_refund_hour_count": 5,
                                "highest_refund_restaurant": 26107483,
                                "highest_refund_restaurant_rate": 2.26,
                                "highest_refund_restaurant_count": 3
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 6,
                                "occasional_count": 521,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 1.14,
                                "occasional_pct": 98.86
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Florence, SC": {
                        "operational": {
                                "total_fulfillment_time": 37.98,
                                "prep_time": 17.14,
                                "delivery_time": 20.83,
                                "fast_pct": 0.0,
                                "normal_pct": 30.77,
                                "slow_pct": 69.23,
                                "driver_to_order_ratio": 0.923
                        },
                        "revenue": {
                                "total_gmv": 455.28,
                                "aov": 35.02,
                                "avg_tip_pct": 9.3,
                                "small_pct": 0.0,
                                "medium_pct": 69.23,
                                "large_pct": 23.08,
                                "xlarge_pct": 7.69,
                                "catering_pct": 0.0
                        },
                        "satisfaction": {
                                "refund_rate": 0.0,
                                "highest_refund_hour": null,
                                "highest_refund_hour_count": 0,
                                "highest_refund_restaurant": 2732731,
                                "highest_refund_restaurant_rate": 0.0,
                                "highest_refund_restaurant_count": 0
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 0,
                                "occasional_count": 12,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 0.0,
                                "occasional_pct": 100.0
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Scranton": {
                        "operational": {
                                "total_fulfillment_time": 23.71,
                                "prep_time": 8.72,
                                "delivery_time": 14.06,
                                "fast_pct": 43.2,
                                "normal_pct": 44.88,
                                "slow_pct": 9.91,
                                "driver_to_order_ratio": 0.184
                        },
                        "revenue": {
                                "total_gmv": 91475.11,
                                "aov": 28.41,
                                "avg_tip_pct": 8.6,
                                "small_pct": 23.42,
                                "medium_pct": 49.94,
                                "large_pct": 18.39,
                                "xlarge_pct": 6.24,
                                "catering_pct": 0.0
                        },
                        "satisfaction": {
                                "refund_rate": 2.36,
                                "highest_refund_hour": 23,
                                "highest_refund_hour_count": 9,
                                "highest_refund_restaurant": 690495,
                                "highest_refund_restaurant_rate": 2.36,
                                "highest_refund_restaurant_count": 76
                        },
                        "driver_tiers": {
                                "fulltime_count": 34,
                                "parttime_count": 111,
                                "occasional_count": 449,
                                "fulltime_pct": 5.72,
                                "parttime_pct": 18.69,
                                "occasional_pct": 75.59
                        },
                        "flags": {
                                "restaurant_outliers": [
                                        {
                                                "id": 690495,
                                                "rate": 2.28,
                                                "refund_count": 71,
                                                "total_orders": 3113
                                        }
                                ],
                                "restaurant_outlier": 690495,
                                "restaurant_outlier_rate": 2.28,
                                "driver_outliers": [
                                        {
                                                "id": 9842768,
                                                "rate": 27.27,
                                                "refund_count": 3,
                                                "total_orders": 11
                                        },
                                        {
                                                "id": 31828425,
                                                "rate": 23.81,
                                                "refund_count": 5,
                                                "total_orders": 21
                                        },
                                        {
                                                "id": 14679175,
                                                "rate": 20.0,
                                                "refund_count": 2,
                                                "total_orders": 10
                                        }
                                ],
                                "driver_outlier": 9842768,
                                "driver_outlier_rate": 27.27
                        }
                },
                "Chicago": {
                        "operational": {
                                "total_fulfillment_time": 35.97,
                                "prep_time": 12.71,
                                "delivery_time": 21.83,
                                "fast_pct": 13.02,
                                "normal_pct": 42.79,
                                "slow_pct": 43.72,
                                "driver_to_order_ratio": 0.707
                        },
                        "revenue": {
                                "total_gmv": 12298.09,
                                "aov": 57.2,
                                "avg_tip_pct": 10.24,
                                "small_pct": 2.33,
                                "medium_pct": 15.35,
                                "large_pct": 32.09,
                                "xlarge_pct": 42.79,
                                "catering_pct": 6.98
                        },
                        "satisfaction": {
                                "refund_rate": 1.4,
                                "highest_refund_hour": 11,
                                "highest_refund_hour_count": 1,
                                "highest_refund_restaurant": 179164,
                                "highest_refund_restaurant_rate": 1.4,
                                "highest_refund_restaurant_count": 3
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 2,
                                "occasional_count": 150,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 1.32,
                                "occasional_pct": 98.68
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Traverse City, MI": {
                        "operational": {
                                "total_fulfillment_time": 37.02,
                                "prep_time": 16.29,
                                "delivery_time": 18.46,
                                "fast_pct": 3.42,
                                "normal_pct": 52.57,
                                "slow_pct": 43.08,
                                "driver_to_order_ratio": 0.432
                        },
                        "revenue": {
                                "total_gmv": 32196.73,
                                "aov": 50.07,
                                "avg_tip_pct": 12.75,
                                "small_pct": 2.33,
                                "medium_pct": 28.93,
                                "large_pct": 25.19,
                                "xlarge_pct": 39.04,
                                "catering_pct": 3.58
                        },
                        "satisfaction": {
                                "refund_rate": 0.93,
                                "highest_refund_hour": 20,
                                "highest_refund_hour_count": 2,
                                "highest_refund_restaurant": 22917173,
                                "highest_refund_restaurant_rate": 0.93,
                                "highest_refund_restaurant_count": 6
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 22,
                                "occasional_count": 256,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 7.91,
                                "occasional_pct": 92.09
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Calgary": {
                        "operational": {
                                "total_fulfillment_time": 41.33,
                                "prep_time": 21.67,
                                "delivery_time": 19.66,
                                "fast_pct": 0.0,
                                "normal_pct": 30.0,
                                "slow_pct": 70.0,
                                "driver_to_order_ratio": 1.0
                        },
                        "revenue": {
                                "total_gmv": 420.11,
                                "aov": 42.01,
                                "avg_tip_pct": 11.59,
                                "small_pct": 20.0,
                                "medium_pct": 10.0,
                                "large_pct": 50.0,
                                "xlarge_pct": 20.0,
                                "catering_pct": 0.0
                        },
                        "satisfaction": {
                                "refund_rate": 10.0,
                                "highest_refund_hour": 17,
                                "highest_refund_hour_count": 1,
                                "highest_refund_restaurant": 537034,
                                "highest_refund_restaurant_rate": 10.0,
                                "highest_refund_restaurant_count": 1
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 0,
                                "occasional_count": 10,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 0.0,
                                "occasional_pct": 100.0
                        },
                        "flags": {
                                "restaurant_outliers": [
                                        {
                                                "id": 537034,
                                                "rate": 10.0,
                                                "refund_count": 1,
                                                "total_orders": 10
                                        }
                                ],
                                "restaurant_outlier": 537034,
                                "restaurant_outlier_rate": 10.0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Oak Harbor, WA": {
                        "operational": {
                                "total_fulfillment_time": 25.78,
                                "prep_time": 9.96,
                                "delivery_time": 15.51,
                                "fast_pct": 29.14,
                                "normal_pct": 57.62,
                                "slow_pct": 12.58,
                                "driver_to_order_ratio": 0.609
                        },
                        "revenue": {
                                "total_gmv": 5291.06,
                                "aov": 35.04,
                                "avg_tip_pct": 11.73,
                                "small_pct": 5.3,
                                "medium_pct": 60.26,
                                "large_pct": 18.54,
                                "xlarge_pct": 14.57,
                                "catering_pct": 0.66
                        },
                        "satisfaction": {
                                "refund_rate": 0.0,
                                "highest_refund_hour": null,
                                "highest_refund_hour_count": 0,
                                "highest_refund_restaurant": 23523811,
                                "highest_refund_restaurant_rate": 0.0,
                                "highest_refund_restaurant_count": 0
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 0,
                                "occasional_count": 92,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 0.0,
                                "occasional_pct": 100.0
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Lufkin, TX": {
                        "operational": {
                                "total_fulfillment_time": 24.55,
                                "prep_time": 10.44,
                                "delivery_time": 14.0,
                                "fast_pct": 39.62,
                                "normal_pct": 52.83,
                                "slow_pct": 7.55,
                                "driver_to_order_ratio": 0.849
                        },
                        "revenue": {
                                "total_gmv": 1634.35,
                                "aov": 30.84,
                                "avg_tip_pct": 9.07,
                                "small_pct": 16.98,
                                "medium_pct": 52.83,
                                "large_pct": 18.87,
                                "xlarge_pct": 11.32,
                                "catering_pct": 0.0
                        },
                        "satisfaction": {
                                "refund_rate": 0.0,
                                "highest_refund_hour": null,
                                "highest_refund_hour_count": 0,
                                "highest_refund_restaurant": 24767059,
                                "highest_refund_restaurant_rate": 0.0,
                                "highest_refund_restaurant_count": 0
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 0,
                                "occasional_count": 45,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 0.0,
                                "occasional_pct": 100.0
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Sacramento": {
                        "operational": {
                                "total_fulfillment_time": 41.45,
                                "prep_time": 25.44,
                                "delivery_time": 16.01,
                                "fast_pct": 3.61,
                                "normal_pct": 44.98,
                                "slow_pct": 51.41,
                                "driver_to_order_ratio": 0.618
                        },
                        "revenue": {
                                "total_gmv": 17219.19,
                                "aov": 69.15,
                                "avg_tip_pct": 10.34,
                                "small_pct": 1.61,
                                "medium_pct": 18.07,
                                "large_pct": 16.06,
                                "xlarge_pct": 45.78,
                                "catering_pct": 18.47
                        },
                        "satisfaction": {
                                "refund_rate": 1.2,
                                "highest_refund_hour": 17,
                                "highest_refund_hour_count": 1,
                                "highest_refund_restaurant": 1837054,
                                "highest_refund_restaurant_rate": 1.2,
                                "highest_refund_restaurant_count": 3
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 5,
                                "occasional_count": 149,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 3.25,
                                "occasional_pct": 96.75
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Hamilton": {
                        "operational": {
                                "total_fulfillment_time": 26.68,
                                "prep_time": 11.3,
                                "delivery_time": 12.3,
                                "fast_pct": 43.48,
                                "normal_pct": 45.96,
                                "slow_pct": 10.56,
                                "driver_to_order_ratio": 0.658
                        },
                        "revenue": {
                                "total_gmv": 3613.97,
                                "aov": 22.45,
                                "avg_tip_pct": 5.62,
                                "small_pct": 49.07,
                                "medium_pct": 43.48,
                                "large_pct": 6.21,
                                "xlarge_pct": 1.24,
                                "catering_pct": 0.0
                        },
                        "satisfaction": {
                                "refund_rate": 1.86,
                                "highest_refund_hour": 14,
                                "highest_refund_hour_count": 1,
                                "highest_refund_restaurant": 455137,
                                "highest_refund_restaurant_rate": 1.86,
                                "highest_refund_restaurant_count": 3
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 1,
                                "occasional_count": 105,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 0.94,
                                "occasional_pct": 99.06
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "South Bay": {
                        "operational": {
                                "total_fulfillment_time": 48.27,
                                "prep_time": 29.36,
                                "delivery_time": 18.9,
                                "fast_pct": 0.0,
                                "normal_pct": 24.07,
                                "slow_pct": 75.31,
                                "driver_to_order_ratio": 0.796
                        },
                        "revenue": {
                                "total_gmv": 10690.07,
                                "aov": 65.99,
                                "avg_tip_pct": 8.41,
                                "small_pct": 0.0,
                                "medium_pct": 10.49,
                                "large_pct": 24.69,
                                "xlarge_pct": 49.38,
                                "catering_pct": 14.81
                        },
                        "satisfaction": {
                                "refund_rate": 0.0,
                                "highest_refund_hour": null,
                                "highest_refund_hour_count": 0,
                                "highest_refund_restaurant": 367,
                                "highest_refund_restaurant_rate": 0.0,
                                "highest_refund_restaurant_count": 0
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 0,
                                "occasional_count": 129,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 0.0,
                                "occasional_pct": 100.0
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Lake Tahoe, CA": {
                        "operational": {
                                "total_fulfillment_time": 30.35,
                                "prep_time": 10.76,
                                "delivery_time": 19.58,
                                "fast_pct": 15.14,
                                "normal_pct": 61.01,
                                "slow_pct": 23.85,
                                "driver_to_order_ratio": 0.482
                        },
                        "revenue": {
                                "total_gmv": 12266.12,
                                "aov": 56.27,
                                "avg_tip_pct": 12.12,
                                "small_pct": 0.92,
                                "medium_pct": 27.06,
                                "large_pct": 21.1,
                                "xlarge_pct": 44.04,
                                "catering_pct": 6.88
                        },
                        "satisfaction": {
                                "refund_rate": 0.46,
                                "highest_refund_hour": 17,
                                "highest_refund_hour_count": 1,
                                "highest_refund_restaurant": 24575094,
                                "highest_refund_restaurant_rate": 0.46,
                                "highest_refund_restaurant_count": 1
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 4,
                                "occasional_count": 101,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 3.81,
                                "occasional_pct": 96.19
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Bellevue": {
                        "operational": {
                                "total_fulfillment_time": 45.15,
                                "prep_time": 22.39,
                                "delivery_time": 20.59,
                                "fast_pct": 1.56,
                                "normal_pct": 26.21,
                                "slow_pct": 70.53,
                                "driver_to_order_ratio": 0.69
                        },
                        "revenue": {
                                "total_gmv": 29737.83,
                                "aov": 38.77,
                                "avg_tip_pct": 10.47,
                                "small_pct": 8.34,
                                "medium_pct": 42.11,
                                "large_pct": 25.68,
                                "xlarge_pct": 20.6,
                                "catering_pct": 1.3
                        },
                        "satisfaction": {
                                "refund_rate": 1.04,
                                "highest_refund_hour": 11,
                                "highest_refund_hour_count": 2,
                                "highest_refund_restaurant": 24907356,
                                "highest_refund_restaurant_rate": 1.04,
                                "highest_refund_restaurant_count": 8
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 1,
                                "occasional_count": 528,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 0.19,
                                "occasional_pct": 99.81
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Rochester": {
                        "operational": {
                                "total_fulfillment_time": 32.49,
                                "prep_time": 14.49,
                                "delivery_time": 17.99,
                                "fast_pct": 4.88,
                                "normal_pct": 56.1,
                                "slow_pct": 36.59,
                                "driver_to_order_ratio": 0.902
                        },
                        "revenue": {
                                "total_gmv": 1997.1,
                                "aov": 48.71,
                                "avg_tip_pct": 12.37,
                                "small_pct": 4.88,
                                "medium_pct": 19.51,
                                "large_pct": 39.02,
                                "xlarge_pct": 31.71,
                                "catering_pct": 2.44
                        },
                        "satisfaction": {
                                "refund_rate": 0.0,
                                "highest_refund_hour": null,
                                "highest_refund_hour_count": 0,
                                "highest_refund_restaurant": 307989,
                                "highest_refund_restaurant_rate": 0.0,
                                "highest_refund_restaurant_count": 0
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 0,
                                "occasional_count": 37,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 0.0,
                                "occasional_pct": 100.0
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Baltimore": {
                        "operational": {
                                "total_fulfillment_time": 35.88,
                                "prep_time": 19.66,
                                "delivery_time": 16.21,
                                "fast_pct": 7.69,
                                "normal_pct": 38.46,
                                "slow_pct": 53.85,
                                "driver_to_order_ratio": 0.846
                        },
                        "revenue": {
                                "total_gmv": 586.49,
                                "aov": 45.11,
                                "avg_tip_pct": 15.99,
                                "small_pct": 0.0,
                                "medium_pct": 30.77,
                                "large_pct": 53.85,
                                "xlarge_pct": 7.69,
                                "catering_pct": 7.69
                        },
                        "satisfaction": {
                                "refund_rate": 7.69,
                                "highest_refund_hour": 16,
                                "highest_refund_hour_count": 1,
                                "highest_refund_restaurant": 27971896,
                                "highest_refund_restaurant_rate": 7.69,
                                "highest_refund_restaurant_count": 1
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 0,
                                "occasional_count": 11,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 0.0,
                                "occasional_pct": 100.0
                        },
                        "flags": {
                                "restaurant_outliers": [
                                        {
                                                "id": 27971896,
                                                "rate": 7.69,
                                                "refund_count": 1,
                                                "total_orders": 13
                                        }
                                ],
                                "restaurant_outlier": 27971896,
                                "restaurant_outlier_rate": 7.69,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Lubbock": {
                        "operational": {
                                "total_fulfillment_time": 19.91,
                                "prep_time": 9.53,
                                "delivery_time": 10.13,
                                "fast_pct": 60.93,
                                "normal_pct": 32.86,
                                "slow_pct": 5.22,
                                "driver_to_order_ratio": 0.597
                        },
                        "revenue": {
                                "total_gmv": 17237.98,
                                "aov": 24.31,
                                "avg_tip_pct": 8.8,
                                "small_pct": 40.2,
                                "medium_pct": 44.85,
                                "large_pct": 11.85,
                                "xlarge_pct": 2.12,
                                "catering_pct": 0.0
                        },
                        "satisfaction": {
                                "refund_rate": 1.41,
                                "highest_refund_hour": 22,
                                "highest_refund_hour_count": 2,
                                "highest_refund_restaurant": 2498402,
                                "highest_refund_restaurant_rate": 1.41,
                                "highest_refund_restaurant_count": 10
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 14,
                                "occasional_count": 409,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 3.31,
                                "occasional_pct": 96.69
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Port St. Lucie": {
                        "operational": {
                                "total_fulfillment_time": 28.0,
                                "prep_time": 11.06,
                                "delivery_time": 16.95,
                                "fast_pct": 36.36,
                                "normal_pct": 36.36,
                                "slow_pct": 27.27,
                                "driver_to_order_ratio": 1.0
                        },
                        "revenue": {
                                "total_gmv": 319.36,
                                "aov": 29.03,
                                "avg_tip_pct": 13.17,
                                "small_pct": 9.09,
                                "medium_pct": 72.73,
                                "large_pct": 18.18,
                                "xlarge_pct": 0.0,
                                "catering_pct": 0.0
                        },
                        "satisfaction": {
                                "refund_rate": 0.0,
                                "highest_refund_hour": null,
                                "highest_refund_hour_count": 0,
                                "highest_refund_restaurant": 30889198,
                                "highest_refund_restaurant_rate": 0.0,
                                "highest_refund_restaurant_count": 0
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 0,
                                "occasional_count": 11,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 0.0,
                                "occasional_pct": 100.0
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Buffalo": {
                        "operational": {
                                "total_fulfillment_time": 20.21,
                                "prep_time": 8.04,
                                "delivery_time": 12.17,
                                "fast_pct": 54.75,
                                "normal_pct": 37.99,
                                "slow_pct": 3.91,
                                "driver_to_order_ratio": 0.553
                        },
                        "revenue": {
                                "total_gmv": 4682.68,
                                "aov": 26.16,
                                "avg_tip_pct": 10.89,
                                "small_pct": 31.84,
                                "medium_pct": 46.93,
                                "large_pct": 12.29,
                                "xlarge_pct": 5.03,
                                "catering_pct": 0.0
                        },
                        "satisfaction": {
                                "refund_rate": 3.35,
                                "highest_refund_hour": 7,
                                "highest_refund_hour_count": 1,
                                "highest_refund_restaurant": 1302779,
                                "highest_refund_restaurant_rate": 3.35,
                                "highest_refund_restaurant_count": 6
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 4,
                                "occasional_count": 95,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 4.04,
                                "occasional_pct": 95.96
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Lakeland": {
                        "operational": {
                                "total_fulfillment_time": 31.86,
                                "prep_time": 14.25,
                                "delivery_time": 17.25,
                                "fast_pct": 9.6,
                                "normal_pct": 55.97,
                                "slow_pct": 32.79,
                                "driver_to_order_ratio": 0.581
                        },
                        "revenue": {
                                "total_gmv": 11300.33,
                                "aov": 26.46,
                                "avg_tip_pct": 9.5,
                                "small_pct": 32.32,
                                "medium_pct": 46.6,
                                "large_pct": 13.82,
                                "xlarge_pct": 5.62,
                                "catering_pct": 0.0
                        },
                        "satisfaction": {
                                "refund_rate": 0.94,
                                "highest_refund_hour": 19,
                                "highest_refund_hour_count": 3,
                                "highest_refund_restaurant": 1160958,
                                "highest_refund_restaurant_rate": 0.94,
                                "highest_refund_restaurant_count": 4
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 5,
                                "occasional_count": 243,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 2.02,
                                "occasional_pct": 97.98
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Hartford": {
                        "operational": {
                                "total_fulfillment_time": 38.86,
                                "prep_time": 15.56,
                                "delivery_time": 20.14,
                                "fast_pct": 3.97,
                                "normal_pct": 46.36,
                                "slow_pct": 49.67,
                                "driver_to_order_ratio": 0.801
                        },
                        "revenue": {
                                "total_gmv": 7981.0,
                                "aov": 52.85,
                                "avg_tip_pct": 13.69,
                                "small_pct": 1.99,
                                "medium_pct": 23.84,
                                "large_pct": 30.46,
                                "xlarge_pct": 37.75,
                                "catering_pct": 5.3
                        },
                        "satisfaction": {
                                "refund_rate": 0.0,
                                "highest_refund_hour": null,
                                "highest_refund_hour_count": 0,
                                "highest_refund_restaurant": 23140214,
                                "highest_refund_restaurant_rate": 0.0,
                                "highest_refund_restaurant_count": 0
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 0,
                                "occasional_count": 121,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 0.0,
                                "occasional_pct": 100.0
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Bakersfield": {
                        "operational": {
                                "total_fulfillment_time": 114.8,
                                "prep_time": 13.14,
                                "delivery_time": 23.36,
                                "fast_pct": 2.9,
                                "normal_pct": 44.93,
                                "slow_pct": 52.17,
                                "driver_to_order_ratio": 0.87
                        },
                        "revenue": {
                                "total_gmv": 3650.6,
                                "aov": 52.91,
                                "avg_tip_pct": 8.65,
                                "small_pct": 8.7,
                                "medium_pct": 30.43,
                                "large_pct": 11.59,
                                "xlarge_pct": 42.03,
                                "catering_pct": 7.25
                        },
                        "satisfaction": {
                                "refund_rate": 0.0,
                                "highest_refund_hour": null,
                                "highest_refund_hour_count": 0,
                                "highest_refund_restaurant": 2365309,
                                "highest_refund_restaurant_rate": 0.0,
                                "highest_refund_restaurant_count": 0
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 0,
                                "occasional_count": 60,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 0.0,
                                "occasional_pct": 100.0
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Windsor": {
                        "operational": {
                                "total_fulfillment_time": 31.59,
                                "prep_time": 13.06,
                                "delivery_time": 18.52,
                                "fast_pct": 7.04,
                                "normal_pct": 64.79,
                                "slow_pct": 26.76,
                                "driver_to_order_ratio": 0.542
                        },
                        "revenue": {
                                "total_gmv": 4172.19,
                                "aov": 29.38,
                                "avg_tip_pct": 9.38,
                                "small_pct": 26.06,
                                "medium_pct": 45.07,
                                "large_pct": 19.72,
                                "xlarge_pct": 7.75,
                                "catering_pct": 0.0
                        },
                        "satisfaction": {
                                "refund_rate": 1.41,
                                "highest_refund_hour": 17,
                                "highest_refund_hour_count": 1,
                                "highest_refund_restaurant": 300405,
                                "highest_refund_restaurant_rate": 1.41,
                                "highest_refund_restaurant_count": 2
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 4,
                                "occasional_count": 73,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 5.19,
                                "occasional_pct": 94.81
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "LA Valley": {
                        "operational": {
                                "total_fulfillment_time": 38.07,
                                "prep_time": 24.96,
                                "delivery_time": 13.1,
                                "fast_pct": 64.29,
                                "normal_pct": 21.43,
                                "slow_pct": 14.29,
                                "driver_to_order_ratio": 0.821
                        },
                        "revenue": {
                                "total_gmv": 658.91,
                                "aov": 23.53,
                                "avg_tip_pct": 12.18,
                                "small_pct": 46.43,
                                "medium_pct": 32.14,
                                "large_pct": 10.71,
                                "xlarge_pct": 7.14,
                                "catering_pct": 0.0
                        },
                        "satisfaction": {
                                "refund_rate": 3.57,
                                "highest_refund_hour": 15,
                                "highest_refund_hour_count": 1,
                                "highest_refund_restaurant": 25006256,
                                "highest_refund_restaurant_rate": 3.57,
                                "highest_refund_restaurant_count": 1
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 0,
                                "occasional_count": 23,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 0.0,
                                "occasional_pct": 100.0
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Auckland": {
                        "operational": {
                                "total_fulfillment_time": 33.39,
                                "prep_time": 14.04,
                                "delivery_time": 19.34,
                                "fast_pct": 10.53,
                                "normal_pct": 63.16,
                                "slow_pct": 26.32,
                                "driver_to_order_ratio": 0.842
                        },
                        "revenue": {
                                "total_gmv": 1030.47,
                                "aov": 27.12,
                                "avg_tip_pct": 0.0,
                                "small_pct": 44.74,
                                "medium_pct": 26.32,
                                "large_pct": 23.68,
                                "xlarge_pct": 5.26,
                                "catering_pct": 0.0
                        },
                        "satisfaction": {
                                "refund_rate": 0.0,
                                "highest_refund_hour": null,
                                "highest_refund_hour_count": 0,
                                "highest_refund_restaurant": 27528122,
                                "highest_refund_restaurant_rate": 0.0,
                                "highest_refund_restaurant_count": 0
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 0,
                                "occasional_count": 32,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 0.0,
                                "occasional_pct": 100.0
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Vernon, BC": {
                        "operational": {
                                "total_fulfillment_time": 27.87,
                                "prep_time": 12.06,
                                "delivery_time": 15.44,
                                "fast_pct": 18.75,
                                "normal_pct": 61.25,
                                "slow_pct": 17.5,
                                "driver_to_order_ratio": 0.475
                        },
                        "revenue": {
                                "total_gmv": 2590.89,
                                "aov": 32.39,
                                "avg_tip_pct": 5.92,
                                "small_pct": 23.75,
                                "medium_pct": 42.5,
                                "large_pct": 15.0,
                                "xlarge_pct": 13.75,
                                "catering_pct": 2.5
                        },
                        "satisfaction": {
                                "refund_rate": 2.5,
                                "highest_refund_hour": 21,
                                "highest_refund_hour_count": 1,
                                "highest_refund_restaurant": 24730971,
                                "highest_refund_restaurant_rate": 2.5,
                                "highest_refund_restaurant_count": 2
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 2,
                                "occasional_count": 36,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 5.26,
                                "occasional_pct": 94.74
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Brooklyn": {
                        "operational": {
                                "total_fulfillment_time": 37.69,
                                "prep_time": 16.51,
                                "delivery_time": 21.17,
                                "fast_pct": 12.76,
                                "normal_pct": 39.47,
                                "slow_pct": 46.59,
                                "driver_to_order_ratio": 0.858
                        },
                        "revenue": {
                                "total_gmv": 13408.1,
                                "aov": 39.79,
                                "avg_tip_pct": 1.52,
                                "small_pct": 1.48,
                                "medium_pct": 46.29,
                                "large_pct": 25.22,
                                "xlarge_pct": 22.55,
                                "catering_pct": 1.78
                        },
                        "satisfaction": {
                                "refund_rate": 2.08,
                                "highest_refund_hour": 17,
                                "highest_refund_hour_count": 2,
                                "highest_refund_restaurant": 157613,
                                "highest_refund_restaurant_rate": 2.7,
                                "highest_refund_restaurant_count": 3
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 0,
                                "occasional_count": 289,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 0.0,
                                "occasional_pct": 100.0
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Denver/Boulder": {
                        "operational": {
                                "total_fulfillment_time": 29.84,
                                "prep_time": 10.6,
                                "delivery_time": 19.24,
                                "fast_pct": 17.68,
                                "normal_pct": 62.06,
                                "slow_pct": 19.61,
                                "driver_to_order_ratio": 0.797
                        },
                        "revenue": {
                                "total_gmv": 14001.93,
                                "aov": 45.02,
                                "avg_tip_pct": 13.61,
                                "small_pct": 5.47,
                                "medium_pct": 33.76,
                                "large_pct": 25.72,
                                "xlarge_pct": 31.83,
                                "catering_pct": 2.57
                        },
                        "satisfaction": {
                                "refund_rate": 0.64,
                                "highest_refund_hour": 11,
                                "highest_refund_hour_count": 1,
                                "highest_refund_restaurant": 23158630,
                                "highest_refund_restaurant_rate": 1.39,
                                "highest_refund_restaurant_count": 1
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 0,
                                "occasional_count": 248,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 0.0,
                                "occasional_pct": 100.0
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Winnipeg": {
                        "operational": {
                                "total_fulfillment_time": 21.17,
                                "prep_time": 7.59,
                                "delivery_time": 13.55,
                                "fast_pct": 51.31,
                                "normal_pct": 43.98,
                                "slow_pct": 3.66,
                                "driver_to_order_ratio": 0.707
                        },
                        "revenue": {
                                "total_gmv": 5220.56,
                                "aov": 27.33,
                                "avg_tip_pct": 6.56,
                                "small_pct": 39.27,
                                "medium_pct": 35.08,
                                "large_pct": 16.75,
                                "xlarge_pct": 7.33,
                                "catering_pct": 0.52
                        },
                        "satisfaction": {
                                "refund_rate": 2.09,
                                "highest_refund_hour": 11,
                                "highest_refund_hour_count": 1,
                                "highest_refund_restaurant": 1179825,
                                "highest_refund_restaurant_rate": 2.09,
                                "highest_refund_restaurant_count": 4
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 3,
                                "occasional_count": 132,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 2.22,
                                "occasional_pct": 97.78
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Minneapolis": {
                        "operational": {
                                "total_fulfillment_time": 25.98,
                                "prep_time": 11.03,
                                "delivery_time": 14.94,
                                "fast_pct": 23.91,
                                "normal_pct": 62.59,
                                "slow_pct": 12.94,
                                "driver_to_order_ratio": 0.549
                        },
                        "revenue": {
                                "total_gmv": 20728.63,
                                "aov": 29.15,
                                "avg_tip_pct": 12.32,
                                "small_pct": 15.61,
                                "medium_pct": 62.45,
                                "large_pct": 15.47,
                                "xlarge_pct": 5.63,
                                "catering_pct": 0.28
                        },
                        "satisfaction": {
                                "refund_rate": 0.42,
                                "highest_refund_hour": 9,
                                "highest_refund_hour_count": 1,
                                "highest_refund_restaurant": 110356,
                                "highest_refund_restaurant_rate": 0.42,
                                "highest_refund_restaurant_count": 3
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 17,
                                "occasional_count": 373,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 4.36,
                                "occasional_pct": 95.64
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Orange County": {
                        "operational": {
                                "total_fulfillment_time": 22.48,
                                "prep_time": 6.62,
                                "delivery_time": 13.41,
                                "fast_pct": 62.23,
                                "normal_pct": 26.44,
                                "slow_pct": 9.9,
                                "driver_to_order_ratio": 0.36
                        },
                        "revenue": {
                                "total_gmv": 48432.71,
                                "aov": 38.35,
                                "avg_tip_pct": 6.94,
                                "small_pct": 6.02,
                                "medium_pct": 37.61,
                                "large_pct": 22.8,
                                "xlarge_pct": 19.08,
                                "catering_pct": 3.33
                        },
                        "satisfaction": {
                                "refund_rate": 0.87,
                                "highest_refund_hour": 11,
                                "highest_refund_hour_count": 4,
                                "highest_refund_restaurant": 135488,
                                "highest_refund_restaurant_rate": 1.02,
                                "highest_refund_restaurant_count": 11
                        },
                        "driver_tiers": {
                                "fulltime_count": 8,
                                "parttime_count": 33,
                                "occasional_count": 414,
                                "fulltime_pct": 1.76,
                                "parttime_pct": 7.25,
                                "occasional_pct": 90.99
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Central Jersey": {
                        "operational": {
                                "total_fulfillment_time": 25.44,
                                "prep_time": 11.12,
                                "delivery_time": 14.19,
                                "fast_pct": 37.0,
                                "normal_pct": 45.3,
                                "slow_pct": 16.7,
                                "driver_to_order_ratio": 0.418
                        },
                        "revenue": {
                                "total_gmv": 29672.32,
                                "aov": 29.67,
                                "avg_tip_pct": 12.34,
                                "small_pct": 19.1,
                                "medium_pct": 55.8,
                                "large_pct": 16.8,
                                "xlarge_pct": 7.1,
                                "catering_pct": 0.2
                        },
                        "satisfaction": {
                                "refund_rate": 1.0,
                                "highest_refund_hour": 17,
                                "highest_refund_hour_count": 3,
                                "highest_refund_restaurant": 1028224,
                                "highest_refund_restaurant_rate": 2.53,
                                "highest_refund_restaurant_count": 2
                        },
                        "driver_tiers": {
                                "fulltime_count": 1,
                                "parttime_count": 31,
                                "occasional_count": 386,
                                "fulltime_pct": 0.24,
                                "parttime_pct": 7.42,
                                "occasional_pct": 92.34
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Albany": {
                        "operational": {
                                "total_fulfillment_time": 56.24,
                                "prep_time": 34.67,
                                "delivery_time": 21.57,
                                "fast_pct": 0.0,
                                "normal_pct": 0.0,
                                "slow_pct": 100.0,
                                "driver_to_order_ratio": 1.0
                        },
                        "revenue": {
                                "total_gmv": 61.29,
                                "aov": 30.64,
                                "avg_tip_pct": 15.5,
                                "small_pct": 0.0,
                                "medium_pct": 100.0,
                                "large_pct": 0.0,
                                "xlarge_pct": 0.0,
                                "catering_pct": 0.0
                        },
                        "satisfaction": {
                                "refund_rate": 0.0,
                                "highest_refund_hour": null,
                                "highest_refund_hour_count": 0,
                                "highest_refund_restaurant": null,
                                "highest_refund_restaurant_rate": 0,
                                "highest_refund_restaurant_count": 0
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 0,
                                "occasional_count": 2,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 0.0,
                                "occasional_pct": 100.0
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Medford, OR": {
                        "operational": {
                                "total_fulfillment_time": 31.71,
                                "prep_time": 15.61,
                                "delivery_time": 16.09,
                                "fast_pct": 19.51,
                                "normal_pct": 39.02,
                                "slow_pct": 21.95,
                                "driver_to_order_ratio": 0.707
                        },
                        "revenue": {
                                "total_gmv": 1589.17,
                                "aov": 38.76,
                                "avg_tip_pct": 7.86,
                                "small_pct": 0.0,
                                "medium_pct": 31.71,
                                "large_pct": 24.39,
                                "xlarge_pct": 21.95,
                                "catering_pct": 2.44
                        },
                        "satisfaction": {
                                "refund_rate": 4.88,
                                "highest_refund_hour": 12,
                                "highest_refund_hour_count": 1,
                                "highest_refund_restaurant": 25441476,
                                "highest_refund_restaurant_rate": 4.88,
                                "highest_refund_restaurant_count": 2
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 0,
                                "occasional_count": 29,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 0.0,
                                "occasional_pct": 100.0
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Whistler, BC": {
                        "operational": {
                                "total_fulfillment_time": 20.9,
                                "prep_time": 6.48,
                                "delivery_time": 14.41,
                                "fast_pct": 56.43,
                                "normal_pct": 29.46,
                                "slow_pct": 9.11,
                                "driver_to_order_ratio": 0.123
                        },
                        "revenue": {
                                "total_gmv": 11810.02,
                                "aov": 21.09,
                                "avg_tip_pct": 9.04,
                                "small_pct": 45.89,
                                "medium_pct": 41.96,
                                "large_pct": 5.89,
                                "xlarge_pct": 1.25,
                                "catering_pct": 0.0
                        },
                        "satisfaction": {
                                "refund_rate": 2.14,
                                "highest_refund_hour": 12,
                                "highest_refund_hour_count": 4,
                                "highest_refund_restaurant": 26106782,
                                "highest_refund_restaurant_rate": 2.14,
                                "highest_refund_restaurant_count": 12
                        },
                        "driver_tiers": {
                                "fulltime_count": 7,
                                "parttime_count": 20,
                                "occasional_count": 42,
                                "fulltime_pct": 10.14,
                                "parttime_pct": 28.99,
                                "occasional_pct": 60.87
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Northern Virginia": {
                        "operational": {
                                "total_fulfillment_time": 40.91,
                                "prep_time": 19.48,
                                "delivery_time": 21.43,
                                "fast_pct": 4.73,
                                "normal_pct": 33.14,
                                "slow_pct": 60.36,
                                "driver_to_order_ratio": 0.805
                        },
                        "revenue": {
                                "total_gmv": 4784.63,
                                "aov": 28.31,
                                "avg_tip_pct": 12.84,
                                "small_pct": 18.93,
                                "medium_pct": 58.58,
                                "large_pct": 14.2,
                                "xlarge_pct": 5.33,
                                "catering_pct": 0.59
                        },
                        "satisfaction": {
                                "refund_rate": 1.18,
                                "highest_refund_hour": 4,
                                "highest_refund_hour_count": 1,
                                "highest_refund_restaurant": 26182459,
                                "highest_refund_restaurant_rate": 1.18,
                                "highest_refund_restaurant_count": 2
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 0,
                                "occasional_count": 136,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 0.0,
                                "occasional_pct": 100.0
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Perth": {
                        "operational": {
                                "total_fulfillment_time": 18.64,
                                "prep_time": 7.67,
                                "delivery_time": 10.96,
                                "fast_pct": 80.0,
                                "normal_pct": 20.0,
                                "slow_pct": 0.0,
                                "driver_to_order_ratio": 1.0
                        },
                        "revenue": {
                                "total_gmv": 227.0,
                                "aov": 22.7,
                                "avg_tip_pct": 0.0,
                                "small_pct": 50.0,
                                "medium_pct": 40.0,
                                "large_pct": 10.0,
                                "xlarge_pct": 0.0,
                                "catering_pct": 0.0
                        },
                        "satisfaction": {
                                "refund_rate": 0.0,
                                "highest_refund_hour": null,
                                "highest_refund_hour_count": 0,
                                "highest_refund_restaurant": 24459646,
                                "highest_refund_restaurant_rate": 0.0,
                                "highest_refund_restaurant_count": 0
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 0,
                                "occasional_count": 10,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 0.0,
                                "occasional_pct": 100.0
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Nashville": {
                        "operational": {
                                "total_fulfillment_time": 32.64,
                                "prep_time": 13.81,
                                "delivery_time": 17.21,
                                "fast_pct": 19.67,
                                "normal_pct": 60.46,
                                "slow_pct": 19.25,
                                "driver_to_order_ratio": 0.491
                        },
                        "revenue": {
                                "total_gmv": 17008.6,
                                "aov": 35.21,
                                "avg_tip_pct": 13.4,
                                "small_pct": 8.07,
                                "medium_pct": 53.42,
                                "large_pct": 22.36,
                                "xlarge_pct": 15.11,
                                "catering_pct": 0.41
                        },
                        "satisfaction": {
                                "refund_rate": 0.21,
                                "highest_refund_hour": 11,
                                "highest_refund_hour_count": 1,
                                "highest_refund_restaurant": 28044587,
                                "highest_refund_restaurant_rate": 0.21,
                                "highest_refund_restaurant_count": 1
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 14,
                                "occasional_count": 223,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 5.91,
                                "occasional_pct": 94.09
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Cedar Rapids": {
                        "operational": {
                                "total_fulfillment_time": 38.23,
                                "prep_time": 19.3,
                                "delivery_time": 17.96,
                                "fast_pct": 3.57,
                                "normal_pct": 42.86,
                                "slow_pct": 51.79,
                                "driver_to_order_ratio": 0.839
                        },
                        "revenue": {
                                "total_gmv": 2730.16,
                                "aov": 48.75,
                                "avg_tip_pct": 9.03,
                                "small_pct": 0.0,
                                "medium_pct": 41.07,
                                "large_pct": 16.07,
                                "xlarge_pct": 37.5,
                                "catering_pct": 3.57
                        },
                        "satisfaction": {
                                "refund_rate": 0.0,
                                "highest_refund_hour": null,
                                "highest_refund_hour_count": 0,
                                "highest_refund_restaurant": 25850858,
                                "highest_refund_restaurant_rate": 0.0,
                                "highest_refund_restaurant_count": 0
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 0,
                                "occasional_count": 47,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 0.0,
                                "occasional_pct": 100.0
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "San Antonio": {
                        "operational": {
                                "total_fulfillment_time": 44.46,
                                "prep_time": 21.66,
                                "delivery_time": 20.57,
                                "fast_pct": 2.84,
                                "normal_pct": 23.51,
                                "slow_pct": 72.87,
                                "driver_to_order_ratio": 0.714
                        },
                        "revenue": {
                                "total_gmv": 32234.62,
                                "aov": 41.65,
                                "avg_tip_pct": 11.03,
                                "small_pct": 5.81,
                                "medium_pct": 43.15,
                                "large_pct": 26.1,
                                "xlarge_pct": 21.71,
                                "catering_pct": 2.45
                        },
                        "satisfaction": {
                                "refund_rate": 2.33,
                                "highest_refund_hour": 17,
                                "highest_refund_hour_count": 3,
                                "highest_refund_restaurant": 287510,
                                "highest_refund_restaurant_rate": 2.65,
                                "highest_refund_restaurant_count": 4
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 5,
                                "occasional_count": 548,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 0.9,
                                "occasional_pct": 99.1
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Rapid City, SD": {
                        "operational": {
                                "total_fulfillment_time": 24.67,
                                "prep_time": 8.13,
                                "delivery_time": 16.42,
                                "fast_pct": 30.17,
                                "normal_pct": 58.68,
                                "slow_pct": 10.74,
                                "driver_to_order_ratio": 0.694
                        },
                        "revenue": {
                                "total_gmv": 8281.21,
                                "aov": 34.22,
                                "avg_tip_pct": 13.74,
                                "small_pct": 4.55,
                                "medium_pct": 50.83,
                                "large_pct": 28.51,
                                "xlarge_pct": 12.81,
                                "catering_pct": 0.0
                        },
                        "satisfaction": {
                                "refund_rate": 0.41,
                                "highest_refund_hour": 12,
                                "highest_refund_hour_count": 1,
                                "highest_refund_restaurant": 894463,
                                "highest_refund_restaurant_rate": 0.41,
                                "highest_refund_restaurant_count": 1
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 1,
                                "occasional_count": 167,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 0.6,
                                "occasional_pct": 99.4
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Muncie, IN": {
                        "operational": {
                                "total_fulfillment_time": 31.03,
                                "prep_time": 15.11,
                                "delivery_time": 15.92,
                                "fast_pct": 14.98,
                                "normal_pct": 57.1,
                                "slow_pct": 27.61,
                                "driver_to_order_ratio": 0.474
                        },
                        "revenue": {
                                "total_gmv": 22551.12,
                                "aov": 35.18,
                                "avg_tip_pct": 11.94,
                                "small_pct": 11.86,
                                "medium_pct": 49.3,
                                "large_pct": 21.22,
                                "xlarge_pct": 15.76,
                                "catering_pct": 0.94
                        },
                        "satisfaction": {
                                "refund_rate": 1.25,
                                "highest_refund_hour": 22,
                                "highest_refund_hour_count": 2,
                                "highest_refund_restaurant": 24618036,
                                "highest_refund_restaurant_rate": 1.25,
                                "highest_refund_restaurant_count": 8
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 18,
                                "occasional_count": 286,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 5.92,
                                "occasional_pct": 94.08
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Regina": {
                        "operational": {
                                "total_fulfillment_time": 41.67,
                                "prep_time": 26.8,
                                "delivery_time": 14.86,
                                "fast_pct": 0.0,
                                "normal_pct": 42.86,
                                "slow_pct": 55.1,
                                "driver_to_order_ratio": 0.714
                        },
                        "revenue": {
                                "total_gmv": 2289.98,
                                "aov": 23.37,
                                "avg_tip_pct": 3.58,
                                "small_pct": 60.2,
                                "medium_pct": 24.49,
                                "large_pct": 8.16,
                                "xlarge_pct": 5.1,
                                "catering_pct": 0.0
                        },
                        "satisfaction": {
                                "refund_rate": 0.0,
                                "highest_refund_hour": null,
                                "highest_refund_hour_count": 0,
                                "highest_refund_restaurant": 711949,
                                "highest_refund_restaurant_rate": 0.0,
                                "highest_refund_restaurant_count": 0
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 0,
                                "occasional_count": 70,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 0.0,
                                "occasional_pct": 100.0
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Los Angeles": {
                        "operational": {
                                "total_fulfillment_time": 33.98,
                                "prep_time": 17.38,
                                "delivery_time": 16.57,
                                "fast_pct": 0.0,
                                "normal_pct": 66.67,
                                "slow_pct": 25.0,
                                "driver_to_order_ratio": 0.917
                        },
                        "revenue": {
                                "total_gmv": 371.51,
                                "aov": 30.96,
                                "avg_tip_pct": 3.4,
                                "small_pct": 0.0,
                                "medium_pct": 58.33,
                                "large_pct": 33.33,
                                "xlarge_pct": 0.0,
                                "catering_pct": 0.0
                        },
                        "satisfaction": {
                                "refund_rate": 0.0,
                                "highest_refund_hour": null,
                                "highest_refund_hour_count": 0,
                                "highest_refund_restaurant": 390164,
                                "highest_refund_restaurant_rate": 0.0,
                                "highest_refund_restaurant_count": 0
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 0,
                                "occasional_count": 11,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 0.0,
                                "occasional_pct": 100.0
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "South Texas": {
                        "operational": {
                                "total_fulfillment_time": 45.66,
                                "prep_time": 29.11,
                                "delivery_time": 14.84,
                                "fast_pct": 2.05,
                                "normal_pct": 27.3,
                                "slow_pct": 69.62,
                                "driver_to_order_ratio": 0.427
                        },
                        "revenue": {
                                "total_gmv": 7938.5,
                                "aov": 27.09,
                                "avg_tip_pct": 11.91,
                                "small_pct": 27.99,
                                "medium_pct": 48.12,
                                "large_pct": 19.11,
                                "xlarge_pct": 3.75,
                                "catering_pct": 0.0
                        },
                        "satisfaction": {
                                "refund_rate": 1.37,
                                "highest_refund_hour": 15,
                                "highest_refund_hour_count": 1,
                                "highest_refund_restaurant": 694494,
                                "highest_refund_restaurant_rate": 1.37,
                                "highest_refund_restaurant_count": 4
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 8,
                                "occasional_count": 117,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 6.4,
                                "occasional_pct": 93.6
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Portland": {
                        "operational": {
                                "total_fulfillment_time": 278.61,
                                "prep_time": 218.5,
                                "delivery_time": 21.37,
                                "fast_pct": 0.0,
                                "normal_pct": 2.56,
                                "slow_pct": 94.87,
                                "driver_to_order_ratio": 0.821
                        },
                        "revenue": {
                                "total_gmv": 2270.86,
                                "aov": 58.23,
                                "avg_tip_pct": 7.98,
                                "small_pct": 0.0,
                                "medium_pct": 5.13,
                                "large_pct": 7.69,
                                "xlarge_pct": 61.54,
                                "catering_pct": 7.69
                        },
                        "satisfaction": {
                                "refund_rate": 2.56,
                                "highest_refund_hour": 17,
                                "highest_refund_hour_count": 1,
                                "highest_refund_restaurant": 27830670,
                                "highest_refund_restaurant_rate": 2.56,
                                "highest_refund_restaurant_count": 1
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 0,
                                "occasional_count": 32,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 0.0,
                                "occasional_pct": 100.0
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Cincinnati": {
                        "operational": {
                                "total_fulfillment_time": 33.15,
                                "prep_time": 16.04,
                                "delivery_time": 17.11,
                                "fast_pct": 13.33,
                                "normal_pct": 54.0,
                                "slow_pct": 32.67,
                                "driver_to_order_ratio": 0.793
                        },
                        "revenue": {
                                "total_gmv": 5704.78,
                                "aov": 38.03,
                                "avg_tip_pct": 12.44,
                                "small_pct": 10.0,
                                "medium_pct": 40.0,
                                "large_pct": 28.0,
                                "xlarge_pct": 22.0,
                                "catering_pct": 0.0
                        },
                        "satisfaction": {
                                "refund_rate": 0.67,
                                "highest_refund_hour": 18,
                                "highest_refund_hour_count": 1,
                                "highest_refund_restaurant": 23252078,
                                "highest_refund_restaurant_rate": 0.67,
                                "highest_refund_restaurant_count": 1
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 1,
                                "occasional_count": 118,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 0.84,
                                "occasional_pct": 99.16
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Philadelphia": {
                        "operational": {
                                "total_fulfillment_time": 33.4,
                                "prep_time": 14.82,
                                "delivery_time": 17.19,
                                "fast_pct": 7.69,
                                "normal_pct": 61.32,
                                "slow_pct": 30.77,
                                "driver_to_order_ratio": 0.774
                        },
                        "revenue": {
                                "total_gmv": 20598.79,
                                "aov": 45.27,
                                "avg_tip_pct": 9.0,
                                "small_pct": 13.41,
                                "medium_pct": 32.53,
                                "large_pct": 22.86,
                                "xlarge_pct": 25.71,
                                "catering_pct": 5.27
                        },
                        "satisfaction": {
                                "refund_rate": 2.2,
                                "highest_refund_hour": 19,
                                "highest_refund_hour_count": 3,
                                "highest_refund_restaurant": 23983224,
                                "highest_refund_restaurant_rate": 2.25,
                                "highest_refund_restaurant_count": 4
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 3,
                                "occasional_count": 349,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 0.85,
                                "occasional_pct": 99.15
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "Boston": {
                        "operational": {
                                "total_fulfillment_time": 18.73,
                                "prep_time": 9.66,
                                "delivery_time": 8.93,
                                "fast_pct": 62.41,
                                "normal_pct": 32.07,
                                "slow_pct": 5.17,
                                "driver_to_order_ratio": 0.428
                        },
                        "revenue": {
                                "total_gmv": 6526.37,
                                "aov": 22.5,
                                "avg_tip_pct": 13.42,
                                "small_pct": 45.52,
                                "medium_pct": 45.52,
                                "large_pct": 6.9,
                                "xlarge_pct": 1.72,
                                "catering_pct": 0.0
                        },
                        "satisfaction": {
                                "refund_rate": 1.38,
                                "highest_refund_hour": 5,
                                "highest_refund_hour_count": 1,
                                "highest_refund_restaurant": 1101978,
                                "highest_refund_restaurant_rate": 1.38,
                                "highest_refund_restaurant_count": 4
                        },
                        "driver_tiers": {
                                "fulltime_count": 1,
                                "parttime_count": 10,
                                "occasional_count": 113,
                                "fulltime_pct": 0.81,
                                "parttime_pct": 8.06,
                                "occasional_pct": 91.13
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                },
                "North Jersey": {
                        "operational": {
                                "total_fulfillment_time": 35.46,
                                "prep_time": 13.63,
                                "delivery_time": 12.21,
                                "fast_pct": 34.38,
                                "normal_pct": 45.31,
                                "slow_pct": 20.31,
                                "driver_to_order_ratio": 0.656
                        },
                        "revenue": {
                                "total_gmv": 1616.79,
                                "aov": 25.26,
                                "avg_tip_pct": 11.54,
                                "small_pct": 50.0,
                                "medium_pct": 31.25,
                                "large_pct": 12.5,
                                "xlarge_pct": 6.25,
                                "catering_pct": 0.0
                        },
                        "satisfaction": {
                                "refund_rate": 0.0,
                                "highest_refund_hour": null,
                                "highest_refund_hour_count": 0,
                                "highest_refund_restaurant": 1069410,
                                "highest_refund_restaurant_rate": 0.0,
                                "highest_refund_restaurant_count": 0
                        },
                        "driver_tiers": {
                                "fulltime_count": 0,
                                "parttime_count": 1,
                                "occasional_count": 41,
                                "fulltime_pct": 0.0,
                                "parttime_pct": 2.38,
                                "occasional_pct": 97.62
                        },
                        "flags": {
                                "restaurant_outliers": [],
                                "restaurant_outlier": null,
                                "restaurant_outlier_rate": 0,
                                "driver_outliers": [],
                                "driver_outlier": null,
                                "driver_outlier_rate": 0
                        }
                }
        },
        "time_series": {
                "hourly_deliveries": [
                        {
                                "hour": 0,
                                "count": 336
                        },
                        {
                                "hour": 1,
                                "count": 239
                        },
                        {
                                "hour": 2,
                                "count": 100
                        },
                        {
                                "hour": 3,
                                "count": 22
                        },
                        {
                                "hour": 4,
                                "count": 74
                        },
                        {
                                "hour": 5,
                                "count": 42
                        },
                        {
                                "hour": 6,
                                "count": 186
                        },
                        {
                                "hour": 7,
                                "count": 299
                        },
                        {
                                "hour": 8,
                                "count": 594
                        },
                        {
                                "hour": 9,
                                "count": 785
                        },
                        {
                                "hour": 10,
                                "count": 993
                        },
                        {
                                "hour": 11,
                                "count": 1332
                        },
                        {
                                "hour": 12,
                                "count": 1309
                        },
                        {
                                "hour": 13,
                                "count": 1033
                        },
                        {
                                "hour": 14,
                                "count": 954
                        },
                        {
                                "hour": 15,
                                "count": 1044
                        },
                        {
                                "hour": 16,
                                "count": 1407
                        },
                        {
                                "hour": 17,
                                "count": 1837
                        },
                        {
                                "hour": 18,
                                "count": 1879
                        },
                        {
                                "hour": 19,
                                "count": 1790
                        },
                        {
                                "hour": 20,
                                "count": 1322
                        },
                        {
                                "hour": 21,
                                "count": 965
                        },
                        {
                                "hour": 22,
                                "count": 699
                        },
                        {
                                "hour": 23,
                                "count": 572
                        }
                ],
                "gmv_by_day": [
                        {
                                "day": "Monday",
                                "gmv": 96886.97,
                                "orders": 2818
                        },
                        {
                                "day": "Tuesday",
                                "gmv": 83566.69,
                                "orders": 2525
                        },
                        {
                                "day": "Wednesday",
                                "gmv": 83133.41,
                                "orders": 2420
                        },
                        {
                                "day": "Thursday",
                                "gmv": 90047.74,
                                "orders": 2540
                        },
                        {
                                "day": "Friday",
                                "gmv": 107235.64,
                                "orders": 2932
                        },
                        {
                                "day": "Saturday",
                                "gmv": 122805.16,
                                "orders": 3284
                        },
                        {
                                "day": "Sunday",
                                "gmv": 119420.3,
                                "orders": 3294
                        }
                ],
                "heatmap": [
                        {
                                "day": "Monday",
                                "hour": 0,
                                "count": 50
                        },
                        {
                                "day": "Monday",
                                "hour": 1,
                                "count": 25
                        },
                        {
                                "day": "Monday",
                                "hour": 2,
                                "count": 12
                        },
                        {
                                "day": "Monday",
                                "hour": 3,
                                "count": 2
                        },
                        {
                                "day": "Monday",
                                "hour": 4,
                                "count": 11
                        },
                        {
                                "day": "Monday",
                                "hour": 5,
                                "count": 5
                        },
                        {
                                "day": "Monday",
                                "hour": 6,
                                "count": 40
                        },
                        {
                                "day": "Monday",
                                "hour": 7,
                                "count": 30
                        },
                        {
                                "day": "Monday",
                                "hour": 8,
                                "count": 72
                        },
                        {
                                "day": "Monday",
                                "hour": 9,
                                "count": 114
                        },
                        {
                                "day": "Monday",
                                "hour": 10,
                                "count": 128
                        },
                        {
                                "day": "Monday",
                                "hour": 11,
                                "count": 202
                        },
                        {
                                "day": "Monday",
                                "hour": 12,
                                "count": 220
                        },
                        {
                                "day": "Monday",
                                "hour": 13,
                                "count": 169
                        },
                        {
                                "day": "Monday",
                                "hour": 14,
                                "count": 167
                        },
                        {
                                "day": "Monday",
                                "hour": 15,
                                "count": 154
                        },
                        {
                                "day": "Monday",
                                "hour": 16,
                                "count": 218
                        },
                        {
                                "day": "Monday",
                                "hour": 17,
                                "count": 254
                        },
                        {
                                "day": "Monday",
                                "hour": 18,
                                "count": 241
                        },
                        {
                                "day": "Monday",
                                "hour": 19,
                                "count": 240
                        },
                        {
                                "day": "Monday",
                                "hour": 20,
                                "count": 187
                        },
                        {
                                "day": "Monday",
                                "hour": 21,
                                "count": 114
                        },
                        {
                                "day": "Monday",
                                "hour": 22,
                                "count": 90
                        },
                        {
                                "day": "Monday",
                                "hour": 23,
                                "count": 73
                        },
                        {
                                "day": "Tuesday",
                                "hour": 0,
                                "count": 52
                        },
                        {
                                "day": "Tuesday",
                                "hour": 1,
                                "count": 25
                        },
                        {
                                "day": "Tuesday",
                                "hour": 2,
                                "count": 13
                        },
                        {
                                "day": "Tuesday",
                                "hour": 3,
                                "count": 4
                        },
                        {
                                "day": "Tuesday",
                                "hour": 4,
                                "count": 13
                        },
                        {
                                "day": "Tuesday",
                                "hour": 5,
                                "count": 7
                        },
                        {
                                "day": "Tuesday",
                                "hour": 6,
                                "count": 31
                        },
                        {
                                "day": "Tuesday",
                                "hour": 7,
                                "count": 49
                        },
                        {
                                "day": "Tuesday",
                                "hour": 8,
                                "count": 76
                        },
                        {
                                "day": "Tuesday",
                                "hour": 9,
                                "count": 116
                        },
                        {
                                "day": "Tuesday",
                                "hour": 10,
                                "count": 121
                        },
                        {
                                "day": "Tuesday",
                                "hour": 11,
                                "count": 203
                        },
                        {
                                "day": "Tuesday",
                                "hour": 12,
                                "count": 184
                        },
                        {
                                "day": "Tuesday",
                                "hour": 13,
                                "count": 144
                        },
                        {
                                "day": "Tuesday",
                                "hour": 14,
                                "count": 115
                        },
                        {
                                "day": "Tuesday",
                                "hour": 15,
                                "count": 137
                        },
                        {
                                "day": "Tuesday",
                                "hour": 16,
                                "count": 192
                        },
                        {
                                "day": "Tuesday",
                                "hour": 17,
                                "count": 223
                        },
                        {
                                "day": "Tuesday",
                                "hour": 18,
                                "count": 230
                        },
                        {
                                "day": "Tuesday",
                                "hour": 19,
                                "count": 211
                        },
                        {
                                "day": "Tuesday",
                                "hour": 20,
                                "count": 122
                        },
                        {
                                "day": "Tuesday",
                                "hour": 21,
                                "count": 109
                        },
                        {
                                "day": "Tuesday",
                                "hour": 22,
                                "count": 84
                        },
                        {
                                "day": "Tuesday",
                                "hour": 23,
                                "count": 64
                        },
                        {
                                "day": "Wednesday",
                                "hour": 0,
                                "count": 30
                        },
                        {
                                "day": "Wednesday",
                                "hour": 1,
                                "count": 25
                        },
                        {
                                "day": "Wednesday",
                                "hour": 2,
                                "count": 4
                        },
                        {
                                "day": "Wednesday",
                                "hour": 3,
                                "count": 3
                        },
                        {
                                "day": "Wednesday",
                                "hour": 4,
                                "count": 5
                        },
                        {
                                "day": "Wednesday",
                                "hour": 5,
                                "count": 6
                        },
                        {
                                "day": "Wednesday",
                                "hour": 6,
                                "count": 21
                        },
                        {
                                "day": "Wednesday",
                                "hour": 7,
                                "count": 36
                        },
                        {
                                "day": "Wednesday",
                                "hour": 8,
                                "count": 67
                        },
                        {
                                "day": "Wednesday",
                                "hour": 9,
                                "count": 87
                        },
                        {
                                "day": "Wednesday",
                                "hour": 10,
                                "count": 119
                        },
                        {
                                "day": "Wednesday",
                                "hour": 11,
                                "count": 165
                        },
                        {
                                "day": "Wednesday",
                                "hour": 12,
                                "count": 175
                        },
                        {
                                "day": "Wednesday",
                                "hour": 13,
                                "count": 129
                        },
                        {
                                "day": "Wednesday",
                                "hour": 14,
                                "count": 115
                        },
                        {
                                "day": "Wednesday",
                                "hour": 15,
                                "count": 128
                        },
                        {
                                "day": "Wednesday",
                                "hour": 16,
                                "count": 167
                        },
                        {
                                "day": "Wednesday",
                                "hour": 17,
                                "count": 230
                        },
                        {
                                "day": "Wednesday",
                                "hour": 18,
                                "count": 260
                        },
                        {
                                "day": "Wednesday",
                                "hour": 19,
                                "count": 231
                        },
                        {
                                "day": "Wednesday",
                                "hour": 20,
                                "count": 150
                        },
                        {
                                "day": "Wednesday",
                                "hour": 21,
                                "count": 127
                        },
                        {
                                "day": "Wednesday",
                                "hour": 22,
                                "count": 81
                        },
                        {
                                "day": "Wednesday",
                                "hour": 23,
                                "count": 59
                        },
                        {
                                "day": "Thursday",
                                "hour": 0,
                                "count": 38
                        },
                        {
                                "day": "Thursday",
                                "hour": 1,
                                "count": 45
                        },
                        {
                                "day": "Thursday",
                                "hour": 2,
                                "count": 15
                        },
                        {
                                "day": "Thursday",
                                "hour": 3,
                                "count": 3
                        },
                        {
                                "day": "Thursday",
                                "hour": 4,
                                "count": 10
                        },
                        {
                                "day": "Thursday",
                                "hour": 5,
                                "count": 6
                        },
                        {
                                "day": "Thursday",
                                "hour": 6,
                                "count": 21
                        },
                        {
                                "day": "Thursday",
                                "hour": 7,
                                "count": 40
                        },
                        {
                                "day": "Thursday",
                                "hour": 8,
                                "count": 77
                        },
                        {
                                "day": "Thursday",
                                "hour": 9,
                                "count": 82
                        },
                        {
                                "day": "Thursday",
                                "hour": 10,
                                "count": 117
                        },
                        {
                                "day": "Thursday",
                                "hour": 11,
                                "count": 180
                        },
                        {
                                "day": "Thursday",
                                "hour": 12,
                                "count": 156
                        },
                        {
                                "day": "Thursday",
                                "hour": 13,
                                "count": 105
                        },
                        {
                                "day": "Thursday",
                                "hour": 14,
                                "count": 94
                        },
                        {
                                "day": "Thursday",
                                "hour": 15,
                                "count": 142
                        },
                        {
                                "day": "Thursday",
                                "hour": 16,
                                "count": 190
                        },
                        {
                                "day": "Thursday",
                                "hour": 17,
                                "count": 252
                        },
                        {
                                "day": "Thursday",
                                "hour": 18,
                                "count": 278
                        },
                        {
                                "day": "Thursday",
                                "hour": 19,
                                "count": 234
                        },
                        {
                                "day": "Thursday",
                                "hour": 20,
                                "count": 187
                        },
                        {
                                "day": "Thursday",
                                "hour": 21,
                                "count": 130
                        },
                        {
                                "day": "Thursday",
                                "hour": 22,
                                "count": 80
                        },
                        {
                                "day": "Thursday",
                                "hour": 23,
                                "count": 58
                        },
                        {
                                "day": "Friday",
                                "hour": 0,
                                "count": 35
                        },
                        {
                                "day": "Friday",
                                "hour": 1,
                                "count": 35
                        },
                        {
                                "day": "Friday",
                                "hour": 2,
                                "count": 14
                        },
                        {
                                "day": "Friday",
                                "hour": 3,
                                "count": 1
                        },
                        {
                                "day": "Friday",
                                "hour": 4,
                                "count": 13
                        },
                        {
                                "day": "Friday",
                                "hour": 5,
                                "count": 8
                        },
                        {
                                "day": "Friday",
                                "hour": 6,
                                "count": 32
                        },
                        {
                                "day": "Friday",
                                "hour": 7,
                                "count": 47
                        },
                        {
                                "day": "Friday",
                                "hour": 8,
                                "count": 96
                        },
                        {
                                "day": "Friday",
                                "hour": 9,
                                "count": 105
                        },
                        {
                                "day": "Friday",
                                "hour": 10,
                                "count": 141
                        },
                        {
                                "day": "Friday",
                                "hour": 11,
                                "count": 189
                        },
                        {
                                "day": "Friday",
                                "hour": 12,
                                "count": 179
                        },
                        {
                                "day": "Friday",
                                "hour": 13,
                                "count": 139
                        },
                        {
                                "day": "Friday",
                                "hour": 14,
                                "count": 127
                        },
                        {
                                "day": "Friday",
                                "hour": 15,
                                "count": 133
                        },
                        {
                                "day": "Friday",
                                "hour": 16,
                                "count": 187
                        },
                        {
                                "day": "Friday",
                                "hour": 17,
                                "count": 316
                        },
                        {
                                "day": "Friday",
                                "hour": 18,
                                "count": 290
                        },
                        {
                                "day": "Friday",
                                "hour": 19,
                                "count": 274
                        },
                        {
                                "day": "Friday",
                                "hour": 20,
                                "count": 198
                        },
                        {
                                "day": "Friday",
                                "hour": 21,
                                "count": 146
                        },
                        {
                                "day": "Friday",
                                "hour": 22,
                                "count": 117
                        },
                        {
                                "day": "Friday",
                                "hour": 23,
                                "count": 110
                        },
                        {
                                "day": "Saturday",
                                "hour": 0,
                                "count": 52
                        },
                        {
                                "day": "Saturday",
                                "hour": 1,
                                "count": 47
                        },
                        {
                                "day": "Saturday",
                                "hour": 2,
                                "count": 22
                        },
                        {
                                "day": "Saturday",
                                "hour": 3,
                                "count": 2
                        },
                        {
                                "day": "Saturday",
                                "hour": 4,
                                "count": 8
                        },
                        {
                                "day": "Saturday",
                                "hour": 5,
                                "count": 4
                        },
                        {
                                "day": "Saturday",
                                "hour": 6,
                                "count": 18
                        },
                        {
                                "day": "Saturday",
                                "hour": 7,
                                "count": 55
                        },
                        {
                                "day": "Saturday",
                                "hour": 8,
                                "count": 108
                        },
                        {
                                "day": "Saturday",
                                "hour": 9,
                                "count": 131
                        },
                        {
                                "day": "Saturday",
                                "hour": 10,
                                "count": 171
                        },
                        {
                                "day": "Saturday",
                                "hour": 11,
                                "count": 177
                        },
                        {
                                "day": "Saturday",
                                "hour": 12,
                                "count": 179
                        },
                        {
                                "day": "Saturday",
                                "hour": 13,
                                "count": 143
                        },
                        {
                                "day": "Saturday",
                                "hour": 14,
                                "count": 162
                        },
                        {
                                "day": "Saturday",
                                "hour": 15,
                                "count": 163
                        },
                        {
                                "day": "Saturday",
                                "hour": 16,
                                "count": 227
                        },
                        {
                                "day": "Saturday",
                                "hour": 17,
                                "count": 294
                        },
                        {
                                "day": "Saturday",
                                "hour": 18,
                                "count": 283
                        },
                        {
                                "day": "Saturday",
                                "hour": 19,
                                "count": 316
                        },
                        {
                                "day": "Saturday",
                                "hour": 20,
                                "count": 274
                        },
                        {
                                "day": "Saturday",
                                "hour": 21,
                                "count": 196
                        },
                        {
                                "day": "Saturday",
                                "hour": 22,
                                "count": 134
                        },
                        {
                                "day": "Saturday",
                                "hour": 23,
                                "count": 118
                        },
                        {
                                "day": "Sunday",
                                "hour": 0,
                                "count": 79
                        },
                        {
                                "day": "Sunday",
                                "hour": 1,
                                "count": 37
                        },
                        {
                                "day": "Sunday",
                                "hour": 2,
                                "count": 20
                        },
                        {
                                "day": "Sunday",
                                "hour": 3,
                                "count": 7
                        },
                        {
                                "day": "Sunday",
                                "hour": 4,
                                "count": 14
                        },
                        {
                                "day": "Sunday",
                                "hour": 5,
                                "count": 6
                        },
                        {
                                "day": "Sunday",
                                "hour": 6,
                                "count": 23
                        },
                        {
                                "day": "Sunday",
                                "hour": 7,
                                "count": 42
                        },
                        {
                                "day": "Sunday",
                                "hour": 8,
                                "count": 98
                        },
                        {
                                "day": "Sunday",
                                "hour": 9,
                                "count": 150
                        },
                        {
                                "day": "Sunday",
                                "hour": 10,
                                "count": 196
                        },
                        {
                                "day": "Sunday",
                                "hour": 11,
                                "count": 216
                        },
                        {
                                "day": "Sunday",
                                "hour": 12,
                                "count": 216
                        },
                        {
                                "day": "Sunday",
                                "hour": 13,
                                "count": 204
                        },
                        {
                                "day": "Sunday",
                                "hour": 14,
                                "count": 174
                        },
                        {
                                "day": "Sunday",
                                "hour": 15,
                                "count": 187
                        },
                        {
                                "day": "Sunday",
                                "hour": 16,
                                "count": 226
                        },
                        {
                                "day": "Sunday",
                                "hour": 17,
                                "count": 268
                        },
                        {
                                "day": "Sunday",
                                "hour": 18,
                                "count": 297
                        },
                        {
                                "day": "Sunday",
                                "hour": 19,
                                "count": 284
                        },
                        {
                                "day": "Sunday",
                                "hour": 20,
                                "count": 204
                        },
                        {
                                "day": "Sunday",
                                "hour": 21,
                                "count": 143
                        },
                        {
                                "day": "Sunday",
                                "hour": 22,
                                "count": 113
                        },
                        {
                                "day": "Sunday",
                                "hour": 23,
                                "count": 90
                        }
                ]
        },
        "charts": {
                "performance_tiers": [
                        {
                                "tier": "Super",
                                "count": 1009,
                                "percentage": 5.09
                        },
                        {
                                "tier": "Elite",
                                "count": 5708,
                                "percentage": 28.81
                        },
                        {
                                "tier": "Average",
                                "count": 8150,
                                "percentage": 41.13
                        },
                        {
                                "tier": "Poor",
                                "count": 4946,
                                "percentage": 24.96
                        }
                ],
                "fulfillment_by_region": [
                        {
                                "region": "Perth",
                                "avg_time": 18.64
                        },
                        {
                                "region": "Boston",
                                "avg_time": 18.73
                        },
                        {
                                "region": "Lubbock",
                                "avg_time": 19.91
                        },
                        {
                                "region": "Buffalo",
                                "avg_time": 20.21
                        },
                        {
                                "region": "Whistler, BC",
                                "avg_time": 20.9
                        },
                        {
                                "region": "Winnipeg",
                                "avg_time": 21.17
                        },
                        {
                                "region": "Orange County",
                                "avg_time": 22.48
                        },
                        {
                                "region": "Scranton",
                                "avg_time": 23.71
                        },
                        {
                                "region": "Lufkin, TX",
                                "avg_time": 24.55
                        },
                        {
                                "region": "Rapid City, SD",
                                "avg_time": 24.67
                        }
                ],
                "gmv_by_region": [
                        {
                                "region": "San Francisco",
                                "gmv": 112394.18
                        },
                        {
                                "region": "Scranton",
                                "gmv": 91475.11
                        },
                        {
                                "region": "Orange County",
                                "gmv": 48432.71
                        },
                        {
                                "region": "Dallas",
                                "gmv": 37136.17
                        },
                        {
                                "region": "San Antonio",
                                "gmv": 32234.62
                        },
                        {
                                "region": "Traverse City, MI",
                                "gmv": 32196.73
                        },
                        {
                                "region": "Bellevue",
                                "gmv": 29737.83
                        },
                        {
                                "region": "Central Jersey",
                                "gmv": 29672.32
                        },
                        {
                                "region": "Muncie, IN",
                                "gmv": 22551.12
                        },
                        {
                                "region": "Minneapolis",
                                "gmv": 20728.63
                        }
                ]
        }
};
        
        
        // Chart.js configuration
        Chart.defaults.color = '#4a5568';
        Chart.defaults.borderColor = '#e2e8f0';
        Chart.defaults.font.family = "'IBM Plex Sans', system-ui, sans-serif";
        
        let weekdayChart = null;
        let hourlyChart = null;
        
        // Format currency
        function formatCurrency(value) {
            return '$' + Math.round(value).toLocaleString();
        }
        
        // Format percentage
        function formatPercent(value) {
            return value.toFixed(1) + '%';
        }
        
        // Format time
        function formatTime(minutes) {
            return minutes.toFixed(1) + 'min';
        }
        
        // Format number with commas
        function formatNumber(value) {
            return Math.round(value).toLocaleString();
        }
        
        
        
        let orderSizePieChart = null;
        
        // Initialize pie chart for order sizes
        function initializeOrderSizePieChart(data) {
            const ctx = document.getElementById('orderSizePieChart');
            if (!ctx) return;
            
            // Destroy existing chart if it exists
            if (orderSizePieChart) {
                orderSizePieChart.destroy();
            }
            
            orderSizePieChart = new Chart(ctx.getContext('2d'), {
                type: 'doughnut',
                data: {
                    labels: [
                        'Small (<$20)',
                        'Medium ($20-$35)',
                        'Large ($35-$50)',
                        'Extra Large ($50-$100)',
                        'Catering ($100+)'
                    ],
                    datasets: [{
                        data: [
                            data.small || 0,
                            data.medium || 0,
                            data.large || 0,
                            data.xlarge || 0,
                            data.catering || 0
                        ],
                        backgroundColor: [
                            'rgb(0, 155, 213)',      // Blue - Small
                            'rgb(0, 131, 138)',      // Teal - Medium
                            'rgb(248, 106, 52)',     // Orange - Large
                            '#FF3008',               // Red - Extra Large
                            '#8B0000'                // Dark Red - Catering
                        ],
                        borderColor: '#ffffff',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 15,
                                font: {
                                    size: 11
                                },
                                usePointStyle: true,
                                pointStyle: 'circle'
                            }
                        },
                        tooltip: {
                            backgroundColor: '#ffffff',
                            borderColor: '#e2e8f0',
                            titleColor: '#191919',
                            bodyColor: '#4a5568',
                            borderWidth: 1,
                            padding: 12,
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = context.parsed || 0;
                                    return label + ': ' + value.toFixed(1) + '%';
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Initialize driver tier pie chart
        let driverTierPieChart = null;
        function initializeDriverTierPieChart(data) {
            const ctx = document.getElementById('driverTierPieChart');
            if (!ctx) return;
            
            // Destroy existing chart if it exists
            if (driverTierPieChart) {
                driverTierPieChart.destroy();
            }
            
            driverTierPieChart = new Chart(ctx.getContext('2d'), {
                type: 'doughnut',
                data: {
                    labels: [
                        'Full-Time',
                        'Part-Time',
                        'Occasional'
                    ],
                    datasets: [{
                        data: [
                            data.fulltime_count || 0,
                            data.parttime_count || 0,
                            data.occasional_count || 0
                        ],
                        backgroundColor: [
                            '#FF3008',               // Red - Full-Time
                            'rgb(248, 106, 52)',     // Orange - Part-Time
                            'rgb(0, 155, 213)'       // Blue - Occasional
                        ],
                        borderColor: '#ffffff',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 15,
                                font: {
                                    size: 11
                                },
                                usePointStyle: true,
                                pointStyle: 'circle'
                            }
                        },
                        tooltip: {
                            backgroundColor: '#ffffff',
                            borderColor: '#e2e8f0',
                            titleColor: '#191919',
                            bodyColor: '#4a5568',
                            borderWidth: 1,
                            padding: 12,
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = context.parsed || 0;
                                    const total = context.chart.data.datasets[0].data.reduce((a, b) => a + b, 0);
                                    const percentage = total > 0 ? (value / total * 100).toFixed(1) : 0;
                                    return label + ': ' + value + ' drivers (' + percentage + '%)';
                                }
                            }
                        }
                    }
                }
            });
        }
        // Initialize charts
        function initializeCharts() {
            const weekdayData = dashboardData.market_performance.weekday_stats;
            const hourlyData = dashboardData.market_performance.hourly_stats;
            
            // Weekday Chart - Dual Axis (Orders + GMV)
            const weekdayCtx = document.getElementById('weekdayChart').getContext('2d');
            weekdayChart = new Chart(weekdayCtx, {
                type: 'line',
                data: {
                    labels: weekdayData.map(d => d.day),
                    datasets: [
                        {
                            label: 'Orders',
                            data: weekdayData.map(d => d.orders),
                            borderColor: '#FF3008',
                            backgroundColor: 'rgba(255, 48, 8, 0.1)',
                            tension: 0.4,
                            fill: true,
                            pointRadius: 5,
                            pointHoverRadius: 7,
                            pointBackgroundColor: '#FF3008',
                            pointBorderColor: '#ffffff',
                            pointBorderWidth: 2,
                            yAxisID: 'y-orders'
                        },
                        {
                            label: 'GMV',
                            data: weekdayData.map(d => d.gmv),
                            borderColor: 'rgb(0, 155, 213)',
                            backgroundColor: 'rgba(0, 155, 213, 0.1)',
                            tension: 0.4,
                            fill: true,
                            pointRadius: 5,
                            pointHoverRadius: 7,
                            pointBackgroundColor: 'rgb(0, 155, 213)',
                            pointBorderColor: '#ffffff',
                            pointBorderWidth: 2,
                            yAxisID: 'y-gmv'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false
                    },
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top',
                            labels: {
                                usePointStyle: true,
                                padding: 15,
                                font: {
                                    size: 12
                                }
                            }
                        },
                        tooltip: {
                            backgroundColor: '#ffffff',
                            borderColor: '#e2e8f0',
                            borderWidth: 1,
                            padding: 12,
                            displayColors: true,
                            titleColor: '#191919',
                            bodyColor: '#4a5568',
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.dataset.label === 'GMV') {
                                        label += '$' + Math.round(context.parsed.y).toLocaleString();
                                    } else {
                                        label += context.parsed.y.toLocaleString();
                                    }
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        'y-orders': {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Orders',
                                color: '#FF3008',
                                font: {
                                    weight: 'bold',
                                    size: 12
                                }
                            },
                            grid: {
                                color: '#e2e8f0'
                            },
                            ticks: {
                                callback: function(value) {
                                    return value.toLocaleString();
                                }
                            }
                        },
                        'y-gmv': {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'GMV ($)',
                                color: 'rgb(0, 155, 213)',
                                font: {
                                    weight: 'bold',
                                    size: 12
                                }
                            },
                            grid: {
                                drawOnChartArea: false
                            },
                            ticks: {
                                callback: function(value) {
                                    return '$' + (value / 1000).toFixed(0) + 'K';
                                }
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
            
            // Hourly Chart - Dual Axis (Orders + GMV)
            const hourlyCtx = document.getElementById('hourlyChart').getContext('2d');
            hourlyChart = new Chart(hourlyCtx, {
                type: 'line',
                data: {
                    labels: hourlyData.map(d => d.hour + ':00'),
                    datasets: [
                        {
                            label: 'Orders',
                            data: hourlyData.map(d => d.orders),
                            borderColor: '#FF3008',
                            backgroundColor: 'rgba(255, 48, 8, 0.1)',
                            tension: 0.4,
                            fill: true,
                            pointRadius: 3,
                            pointHoverRadius: 6,
                            pointBackgroundColor: '#FF3008',
                            pointBorderColor: '#ffffff',
                            pointBorderWidth: 2,
                            yAxisID: 'y-orders'
                        },
                        {
                            label: 'GMV',
                            data: hourlyData.map(d => d.gmv),
                            borderColor: 'rgb(0, 155, 213)',
                            backgroundColor: 'rgba(0, 155, 213, 0.1)',
                            tension: 0.4,
                            fill: true,
                            pointRadius: 3,
                            pointHoverRadius: 6,
                            pointBackgroundColor: 'rgb(0, 155, 213)',
                            pointBorderColor: '#ffffff',
                            pointBorderWidth: 2,
                            yAxisID: 'y-gmv'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false
                    },
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top',
                            labels: {
                                usePointStyle: true,
                                padding: 15,
                                font: {
                                    size: 12
                                }
                            }
                        },
                        tooltip: {
                            backgroundColor: '#ffffff',
                            borderColor: '#e2e8f0',
                            borderWidth: 1,
                            padding: 12,
                            displayColors: true,
                            titleColor: '#191919',
                            bodyColor: '#4a5568',
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.dataset.label === 'GMV') {
                                        label += '$' + Math.round(context.parsed.y).toLocaleString();
                                    } else {
                                        label += context.parsed.y.toLocaleString();
                                    }
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        'y-orders': {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Orders',
                                color: '#FF3008',
                                font: {
                                    weight: 'bold',
                                    size: 12
                                }
                            },
                            grid: {
                                color: '#e2e8f0'
                            },
                            ticks: {
                                callback: function(value) {
                                    return value.toLocaleString();
                                }
                            }
                        },
                        'y-gmv': {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'GMV ($)',
                                color: 'rgb(0, 155, 213)',
                                font: {
                                    weight: 'bold',
                                    size: 12
                                }
                            },
                            grid: {
                                drawOnChartArea: false
                            },
                            ticks: {
                                callback: function(value) {
                                    return '$' + (value / 1000).toFixed(0) + 'K';
                                }
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                maxRotation: 45,
                                minRotation: 45
                            }
                        }
                    }
                }
            });
        }
        
        function initializeDashboard() {
            // Populate header metrics
            document.getElementById('header-gmv').textContent = formatCurrency(dashboardData.market_performance.total_gmv);
            document.getElementById('header-orders').textContent = formatNumber(dashboardData.market_performance.total_orders);
            document.getElementById('header-aov').textContent = formatCurrency(dashboardData.market_performance.total_aov);
            
            // Initialize charts
            initializeCharts();
            
            // Populate region filter
            const regionFilter = document.getElementById('region-filter');
            const regions = Object.keys(dashboardData.regions).sort();
            
            regions.forEach(region => {
                const option = document.createElement('option');
                option.value = region;
                option.textContent = region;
                regionFilter.appendChild(option);
            });
            
            // Populate top 10 regions table
            populateTopRegionsTable();
            
            // Show total market by default
            showMarketData('all');
            
            // Add event listener for filter
            regionFilter.addEventListener('change', (e) => {
                showMarketData(e.target.value);
            });
            
            // Initialize sortable headers
            initializeSortableHeaders();
        }
        
        // Global variable for all regions data
        let allRegionsData = [];
        let currentSortColumn = 'gmv';
        let currentSortDirection = 'desc';
        
        // Populate all regions table
        function populateTopRegionsTable() {
            // Build all regions data from dashboardData.market_performance.all_regions
            allRegionsData = [];
            const totalGMV = dashboardData.market_performance.total_gmv;
            
            dashboardData.market_performance.all_regions.forEach(region => {
                allRegionsData.push({
                    region: region.region,
                    gmv: region.gmv,
                    gmv_pct: (region.gmv / totalGMV * 100),
                    orders: region.orders,
                    avg_delivery_time: region.avg_delivery_time,
                    retention: region.retention,
                    performance_tier: region.performance_tier
                });
            });
            
            // Sort by current column
            sortRegionsTable(currentSortColumn, false);
        }
        
        // Sort regions table
        function sortRegionsTable(column, toggleDirection = true) {
            if (toggleDirection && column === currentSortColumn) {
                currentSortDirection = currentSortDirection === 'asc' ? 'desc' : 'asc';
            } else if (column !== currentSortColumn) {
                currentSortColumn = column;
                currentSortDirection = 'desc'; // Default to descending for new column
            }
            
            // Sort the data
            allRegionsData.sort((a, b) => {
                let aVal, bVal;
                
                switch(column) {
                    case 'region':
                        aVal = a.region.toLowerCase();
                        bVal = b.region.toLowerCase();
                        break;
                    case 'gmv':
                        aVal = a.gmv;
                        bVal = b.gmv;
                        break;
                    case 'orders':
                        aVal = a.orders;
                        bVal = b.orders;
                        break;
                    case 'delivery':
                        aVal = a.avg_delivery_time;
                        bVal = b.avg_delivery_time;
                        break;
                    case 'tier':
                        // Sort tiers in order: Super, Elite, Average, Poor
                        const tierOrder = { 'Super': 1, 'Elite': 2, 'Average': 3, 'Poor': 4, 'N/A': 5 };
                        aVal = tierOrder[a.performance_tier] || 5;
                        bVal = tierOrder[b.performance_tier] || 5;
                        break;
                    case 'retention':
                        aVal = a.retention;
                        bVal = b.retention;
                        break;
                    default:
                        return 0;
                }
                
                if (currentSortDirection === 'asc') {
                    return aVal > bVal ? 1 : -1;
                } else {
                    return aVal < bVal ? 1 : -1;
                }
            });
            
            // Update table
            renderRegionsTable();
            updateSortIndicators();
        }
        
        // Render regions table
        function renderRegionsTable() {
            const tbody = document.querySelector('#top-regions-table tbody');
            tbody.innerHTML = '';
            
            allRegionsData.forEach((region, index) => {
                const row = document.createElement('tr');
                const isTop10 = index < 10;
                
                if (isTop10) {
                    row.style.backgroundColor = 'rgba(0, 155, 213, 0.08)';
                    row.style.borderLeft = '3px solid var(--primary-red)';
                }
                
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td style="font-weight: ${isTop10 ? '600' : '400'}">
                        <a href="#" class="region-link" data-region="${region.region}" style="color: var(--primary-red); text-decoration: none; font-weight: ${isTop10 ? '600' : '500'};">
                            ${region.region}
                        </a>
                    </td>
                    <td>${formatCurrency(region.gmv)}</td>
                    <td>${region.orders.toLocaleString()}</td>
                    <td>${formatTime(region.avg_delivery_time)}</td>
                    <td><span class="tier-badge tier-${region.performance_tier.toLowerCase()}">${region.performance_tier}</span></td>
                    <td>${formatPercent(region.retention)}</td>
                `;
                
                // Add click handler to region link
                const regionLink = row.querySelector('.region-link');
                if (regionLink) {
                    regionLink.addEventListener('click', function(e) {
                        e.preventDefault();
                        const regionName = this.dataset.region;
                        
                        // Update filter dropdown
                        document.getElementById('region-filter').value = regionName;
                        
                        // Apply filter
                        showMarketData(regionName);
                        
                        // Scroll to Market Performance section
                        const marketSection = document.querySelector('section:has(#region-filter)');
                        if (marketSection) {
                            marketSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        }
                    });
                }
                tbody.appendChild(row);
            });
        }
        
        // Update sort indicators
        function updateSortIndicators() {
            document.querySelectorAll('th.sortable').forEach(th => {
                th.classList.remove('asc', 'desc');
                if (th.dataset.column === currentSortColumn) {
                    th.classList.add(currentSortDirection);
                }
            });
        }
        
        // Add click handlers to sortable headers
        function initializeSortableHeaders() {
            document.querySelectorAll('th.sortable').forEach(th => {
                th.addEventListener('click', () => {
                    sortRegionsTable(th.dataset.column);
                });
            });
        }
        
        // Show market data based on filter
        function showMarketData(regionName) {
            if (regionName === 'all') {
                showTotalMarketMetrics();
                document.getElementById('filter-status').textContent = 'Showing: Total Market';
            } else {
                showRegionalMetrics(regionName);
                document.getElementById('filter-status').textContent = `Showing: ${regionName}`;
            }
        }
        
        // Calculate and show total market metrics
        function showTotalMarketMetrics() {
            const regions = Object.values(dashboardData.regions);
            
            // Aggregate metrics
            let totalOrders = 0;
            let totalFulfillmentSum = 0;
            let totalPrepSum = 0;
            let totalDeliverySum = 0;
            let fastCount = 0;
            let normalCount = 0;
            let slowCount = 0;
            let incompleteCount = 0;
            let lunchFailCount = 0;
            let dinnerFailCount = 0;
            let driverSum = 0;
            
            let totalGMV = 0;
            let netOrderSum = 0;
            let aovSum = 0;
            let tipSum = 0;
            let smallSum = 0;
            let regularSum = 0;
            let largeSum = 0;
            
            let refundSum = 0;
            let veryLongSum = 0;
            let veryShortSum = 0;
            
            regions.forEach(region => {
                const op = region.operational;
                const rev = region.revenue;
                const sat = region.satisfaction;
                const flags = region.flags;
                
                totalOrders++;
                totalFulfillmentSum += op.total_fulfillment_time;
                totalPrepSum += op.prep_time;
                totalDeliverySum += op.delivery_time;
                fastCount += op.fast_pct;
                normalCount += op.normal_pct;
                slowCount += op.slow_pct;
                incompleteCount += op.incomplete_rate;
                lunchFailCount += op.lunch_rush_failure_rate;
                dinnerFailCount += op.dinner_rush_failure_rate;
                driverSum += op.driver_to_order_ratio;
                
                totalGMV += rev.total_gmv;
                netOrderSum += rev.avg_net_order;
                aovSum += rev.aov;
                tipSum += rev.avg_tip_pct;
                smallSum += rev.small_pct;
                regularSum += rev.regular_pct;
                largeSum += rev.large_pct;
                
                refundSum += sat.refund_rate;
                
                veryLongSum += flags.very_long_count_removed;
                veryShortSum += flags.very_short_count_removed;
            });
            
            // Calculate averages
            const avgFulfillment = totalFulfillmentSum / totalOrders;
            const avgPrep = totalPrepSum / totalOrders;
            const avgDelivery = totalDeliverySum / totalOrders;
            const avgFast = fastCount / totalOrders;
            const avgNormal = normalCount / totalOrders;
            const avgSlow = slowCount / totalOrders;
            const avgIncomplete = incompleteCount / totalOrders;
            const avgLunchFail = lunchFailCount / totalOrders;
            const avgDinnerFail = dinnerFailCount / totalOrders;
            const avgDriver = driverSum / totalOrders;
            
            const avgNetOrder = netOrderSum / totalOrders;
            const avgAOV = totalGMV / dashboardData.market_performance.total_orders; // Use actual market AOV
            const avgTip = tipSum / totalOrders;
            const avgSmall = smallSum / totalOrders;
            const avgRegular = regularSum / totalOrders;
            const avgLarge = largeSum / totalOrders;
            
            const avgRefund = refundSum / totalOrders;
            
            // Update operational metrics
            document.getElementById('total-fulfillment').textContent = formatTime(avgFulfillment);
            document.getElementById('total-fulfillment-diff').textContent = '';
            document.getElementById('prep-time').textContent = formatTime(avgPrep);
            document.getElementById('delivery-time').textContent = formatTime(avgDelivery);
            
            document.getElementById('fast-pct').textContent = formatPercent(avgFast);
            document.getElementById('fast-bar').style.width = avgFast + '%';
            document.getElementById('normal-pct').textContent = formatPercent(avgNormal);
            document.getElementById('normal-bar').style.width = avgNormal + '%';
            document.getElementById('slow-pct').textContent = formatPercent(avgSlow);
            document.getElementById('slow-bar').style.width = avgSlow + '%';
            
            // document.getElementById('incomplete-rate').textContent = formatPercent(avgIncomplete);
            // document.getElementById('lunch-failure').textContent = formatPercent(avgLunchFail);
            // document.getElementById('dinner-failure').textContent = formatPercent(avgDinnerFail);
            // document.getElementById('driver-ratio').textContent = avgDriver.toFixed(3); // Moved to Driver Performance card
            
            // Update revenue metrics
            document.getElementById('revenue-gmv').textContent = formatCurrency(totalGMV);
            // Removed avg-net-order metric
            document.getElementById('aov').textContent = formatCurrency(avgAOV);
            document.getElementById('avg-tip').textContent = formatPercent(avgTip);
            
            // Calculate X-Large percentage for total market
            const totalMarketOrderSizes = dashboardData.market_performance.order_sizes;
            
            // Update pie chart with order size distribution
            initializeOrderSizePieChart({
                small: totalMarketOrderSizes.small_pct,
                medium: totalMarketOrderSizes.medium_pct,
                large: totalMarketOrderSizes.large_pct,
                xlarge: totalMarketOrderSizes.xlarge_pct,
                catering: totalMarketOrderSizes.catering_pct
            });
            
            // Update driver tier pie chart
            initializeDriverTierPieChart(dashboardData.market_performance.driver_tiers);
            
            // Update Total Orders
            document.getElementById('total-orders').textContent = formatNumber(dashboardData.market_performance.total_orders);
            
            // Update driver performance metrics
            const totalDrivers = dashboardData.market_performance.driver_tiers.fulltime_count + 
                                dashboardData.market_performance.driver_tiers.parttime_count + 
                                dashboardData.market_performance.driver_tiers.occasional_count;
            document.getElementById('total-drivers').textContent = formatNumber(totalDrivers);
            document.getElementById('driver-order-ratio').textContent = avgDriver.toFixed(3);
            
            // Update problem spots (flags) - show all market-level outliers with their regions
            const flagsContainer = document.getElementById('flags-container');
            const marketOutliers = dashboardData.market_performance.outliers;
            let flagsHTML = '';
            
            // Driver outliers
            if (marketOutliers.driver_outliers && marketOutliers.driver_outliers.length > 0) {
                marketOutliers.driver_outliers.forEach(driver => {
                    const regionList = driver.regions.join(', ');
                    flagsHTML += `
                        <div class="flag-item error">
                            <div class="flag-title">Driver Outlier Detected</div>
                            <div class="flag-value">Driver ID ${driver.id} - Refund Rate: ${driver.rate}% (${driver.refund_count}/${driver.total_orders} orders) - Region: ${regionList}</div>
                            <div class="flag-value" style="font-size: 0.75rem; margin-top: 0.5rem; opacity: 0.8;">This driver's refund rate is more than 3 standard deviations above the mean, indicating statistically unusual performance.</div>
                        </div>
                    `;
                });
            }
            
            // Restaurant outliers
            if (marketOutliers.restaurant_outliers && marketOutliers.restaurant_outliers.length > 0) {
                marketOutliers.restaurant_outliers.forEach(restaurant => {
                    const regionList = restaurant.regions.join(', ');
                    flagsHTML += `
                        <div class="flag-item error">
                            <div class="flag-title">Restaurant Outlier Detected</div>
                            <div class="flag-value">Restaurant ID ${restaurant.id} - Refund Rate: ${restaurant.rate}% (${restaurant.refund_count}/${restaurant.total_orders} orders) - Region: ${regionList}</div>
                            <div class="flag-value" style="font-size: 0.75rem; margin-top: 0.5rem; opacity: 0.8;">This restaurant's refund rate is more than 3 standard deviations above the mean, indicating statistically unusual performance.</div>
                        </div>
                    `;
                });
            }
            
            if (!flagsHTML) {
                flagsHTML = '<div class="flag-item info"><div class="flag-title">No Issues Detected</div><div class="flag-value">All metrics within normal ranges across all markets</div></div>';
            }
            
            flagsContainer.innerHTML = flagsHTML;
        }
        
        // Show regional metrics
        function showRegionalMetrics(regionName) {
            const regionData = dashboardData.regions[regionName];
            if (!regionData) return;
            
            const op = regionData.operational;
            const rev = regionData.revenue;
            const sat = regionData.satisfaction;
            const flags = regionData.flags;
            
            // Calculate total market baseline for comparison
            const regions = Object.values(dashboardData.regions);
            const totalMarketFulfillment = regions.reduce((sum, r) => sum + r.operational.total_fulfillment_time, 0) / regions.length;
            
            // Update operational metrics
            const fulfillmentDiff = ((op.total_fulfillment_time - totalMarketFulfillment) / totalMarketFulfillment * 100);
            document.getElementById('total-fulfillment').textContent = formatTime(op.total_fulfillment_time);
            const diffEl = document.getElementById('total-fulfillment-diff');
            diffEl.textContent = (fulfillmentDiff > 0 ? '+' : '') + fulfillmentDiff.toFixed(1) + '% vs market';
            diffEl.className = 'metric-diff ' + (fulfillmentDiff > 0 ? 'negative' : 'positive');
            
            document.getElementById('prep-time').textContent = formatTime(op.prep_time);
            document.getElementById('delivery-time').textContent = formatTime(op.delivery_time);
            
            document.getElementById('fast-pct').textContent = formatPercent(op.fast_pct);
            document.getElementById('fast-bar').style.width = op.fast_pct + '%';
            document.getElementById('normal-pct').textContent = formatPercent(op.normal_pct);
            document.getElementById('normal-bar').style.width = op.normal_pct + '%';
            document.getElementById('slow-pct').textContent = formatPercent(op.slow_pct);
            document.getElementById('slow-bar').style.width = op.slow_pct + '%';
            
            // document.getElementById('incomplete-rate').textContent = formatPercent(op.incomplete_rate);
            // document.getElementById('lunch-failure').textContent = formatPercent(op.lunch_rush_failure_rate);
            // document.getElementById('dinner-failure').textContent = formatPercent(op.dinner_rush_failure_rate);
            
            // Update revenue metrics
            document.getElementById('revenue-gmv').textContent = formatCurrency(rev.total_gmv);
            // Removed avg-net-order metric
            document.getElementById('aov').textContent = formatCurrency(rev.aov);
            document.getElementById('avg-tip').textContent = formatPercent(rev.avg_tip_pct);
            
            // Calculate and update Total Orders for this region
            const regionOrders = Math.round(rev.total_gmv / rev.aov);
            document.getElementById('total-orders').textContent = formatNumber(regionOrders);
            
            // Update pie chart with order size distribution
            initializeOrderSizePieChart({
                small: rev.small_pct,
                medium: rev.medium_pct,
                large: rev.large_pct,
                xlarge: rev.xlarge_pct,
                catering: rev.catering_pct
            });
            
            // Update driver tier pie chart
            initializeDriverTierPieChart(regionData.driver_tiers);
            
            // Update driver performance metrics
            const regionTotalDrivers = regionData.driver_tiers.fulltime_count + 
                                      regionData.driver_tiers.parttime_count + 
                                      regionData.driver_tiers.occasional_count;
            document.getElementById('total-drivers').textContent = formatNumber(regionTotalDrivers);
            document.getElementById('driver-order-ratio').textContent = op.driver_to_order_ratio.toFixed(3);
            
            // Update problem spots (flags) - now includes driver outliers
            const flagsContainer = document.getElementById('flags-container');
            let flagsHTML = '';
            
            // Driver outliers (ALL of them)
            if (flags.driver_outliers && flags.driver_outliers.length > 0) {
                flags.driver_outliers.forEach(driver => {
                    flagsHTML += `
                        <div class="flag-item error">
                            <div class="flag-title">Driver Outlier Detected</div>
                            <div class="flag-value">Driver ID ${driver.id} - Refund Rate: ${driver.rate}% (${driver.refund_count}/${driver.total_orders} orders)</div>
                            <div class="flag-value" style="font-size: 0.75rem; margin-top: 0.5rem; opacity: 0.8;">This driver's refund rate is more than 3 standard deviations above the mean, indicating statistically unusual performance.</div>
                        </div>
                    `;
                });
            }
            
            // Restaurant outliers (ALL of them)
            if (flags.restaurant_outliers && flags.restaurant_outliers.length > 0) {
                flags.restaurant_outliers.forEach(restaurant => {
                    flagsHTML += `
                        <div class="flag-item error">
                            <div class="flag-title">Restaurant Outlier Detected</div>
                            <div class="flag-value">Restaurant ID ${restaurant.id} - Refund Rate: ${restaurant.rate}% (${restaurant.refund_count}/${restaurant.total_orders} orders)</div>
                            <div class="flag-value" style="font-size: 0.75rem; margin-top: 0.5rem; opacity: 0.8;">This restaurant's refund rate is more than 3 standard deviations above the mean, indicating statistically unusual performance.</div>
                        </div>
                    `;
                });
            }
            
            if (!flagsHTML) {
                flagsHTML = '<div class="flag-item info"><div class="flag-title">No Issues Detected</div><div class="flag-value">All metrics within normal ranges</div></div>';
            }
            
            flagsContainer.innerHTML = flagsHTML;
        }
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', initializeDashboard);

    </script>
</body>
</html>
